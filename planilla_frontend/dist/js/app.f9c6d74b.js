(function(){"use strict";var e={2357:function(e,t,a){a(8111),a(531),a(1701),a(3579),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698),a(323);var o=a(5130),l=a(2261),s=a(1387);const n="onigiri_user";function i(e){localStorage.setItem(n,JSON.stringify(e))}function r(){try{const e=localStorage.getItem(n);if(!e)return null;const t=JSON.parse(e);return t&&"object"===typeof t&&(t.userId||t.email||t.fullName)?t:null}catch{return null}}function c(){localStorage.removeItem(n)}function d(){const e=r();return!(!e||!e.userId)}var u=a(144);const p=(0,u.Kh)({user:r(),set(e){this.user=e,i(e)},clear(){this.user=null,c()}});function m(){return p}window.addEventListener("storage",e=>{e.key===n&&(p.user=r())});var y=a(6768),h=a(4232);const v=(0,l.nY)("globalAlert",{state:()=>({message:null,type:null}),actions:{show(e,t="success"){this.message=e,this.type=t},clear(){this.message=null,this.type=null}}});var b={__name:"App",setup(e){const t=v();return(e,a)=>{const o=(0,y.g2)("router-view");return(0,y.uX)(),(0,y.CE)(y.FK,null,[(0,y.bF)(o),(0,u.R1)(t).message?((0,y.uX)(),(0,y.CE)("div",{key:0,class:(0,h.C4)(["alert",`alert-${(0,u.R1)(t).type}`,"alert-dismissible","fade","show"]),role:"alert",style:{position:"fixed",top:"20px",right:"20px","min-width":"250px"}},[(0,y.eW)((0,h.v_)((0,u.R1)(t).message)+" ",1),(0,y.Lk)("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=e=>(0,u.R1)(t).clear())})],2)):(0,y.Q3)("",!0)],64)}}};const f=b;var k=f,g=a(1805);const L={class:"d-flex flex-column min-vh-100",id:"authLayout"},C={class:"flex-fill"};function E(e,t,a,o,l,s){const n=(0,y.g2)("HeaderOnigiri"),i=(0,y.g2)("router-view"),r=(0,y.g2)("FooterComp");return(0,y.uX)(),(0,y.CE)("div",L,[(0,y.bF)(n),(0,y.Lk)("main",C,[(0,y.bF)(i)]),(0,y.bF)(r)])}var x=a.p+"img/logo.a10da437.png";const D={class:"d-flex justify-content-between align-items-center py-3 mb-4 px-4"};function w(e,t){return(0,y.uX)(),(0,y.CE)("header",D,[...t[0]||(t[0]=[(0,y.Lk)("a",{class:"d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none"},[(0,y.Lk)("img",{src:x,alt:"Logo",width:"60",height:"60",class:"me-2"}),(0,y.Lk)("span",{class:"fs-5 fw-medium"},"Onigiri Intelligent Solutions")],-1)])])}var I=a(1241);const P={},F=(0,I.A)(P,[["render",w]]);var T=F;const _={class:"py-3 my-4"};function S(e,t){return(0,y.uX)(),(0,y.CE)("footer",_,[...t[0]||(t[0]=[(0,y.Lk)("p",{class:"text-center text-white fs-5"}," © 2025 Todos los derechos reservados - Onigiri Intelligent Solutions ",-1)])])}const U={},A=(0,I.A)(U,[["render",S]]);var N=A,X={components:{HeaderOnigiri:T,FooterComp:N}};const V=(0,I.A)(X,[["render",E],["__scopeId","data-v-3c43f56a"]]);var q=V;const R={class:"d-flex flex-column",id:"container"},B={class:"d-flex justify-content-center align-items-center"},$={key:0,class:"text-danger"},M={key:1,class:"text-danger"},K={key:2,class:"text-danger"},Q={key:3,class:"text-danger"},O={key:4,class:"text-danger"},J={class:"form-group mt-3"},z=["value"],j={key:5,class:"text-danger"},W={class:"form-group mt-3"},H=["disabled"],G=["value"],Y={key:6,class:"text-danger"},Z={class:"form-group mt-3"},ee=["disabled"],te=["value"],ae={key:7,class:"text-danger"},oe={class:"form-group mt-3"},le={key:8,class:"text-danger"},se={key:9,class:"text-danger"},ne={key:10,class:"text-danger"},ie={key:11,class:"text-danger"},re={key:12,class:"text-danger"},ce={class:"d-flex flex-column justify-content-center align-items-center mt-4 mb-4 text-center",id:"termsandlogin"},de={class:"form-group text-center"};function ue(e,t,a,l,s,n){const i=(0,y.g2)("InputType"),r=(0,y.g2)("router-link"),c=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)("div",R,[(0,y.Lk)("div",B,[(0,y.Lk)("form",{class:"form-signig p-5 h-100 d-inline-block",style:{"max-width":"550px",width:"100%"},onSubmit:t[17]||(t[17]=(0,o.D$)((...e)=>n.saveRegisterData&&n.saveRegisterData(...e),["prevent"]))},[t[28]||(t[28]=(0,y.Lk)("h2",{class:"font-weigth-normal text-center mb-4"},"Registrarse como Empleador",-1)),(0,y.bF)(i,{label:"Primer nombre",id:"firstName",modelValue:s.Persona.Name1,"onUpdate:modelValue":t[0]||(t[0]=e=>s.Persona.Name1=e)},null,8,["modelValue"]),s.errors.Name1?((0,y.uX)(),(0,y.CE)("span",$,(0,h.v_)(s.errors.Name1),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Segundo nombre",id:"SecondName",modelValue:s.Persona.Name2,"onUpdate:modelValue":t[1]||(t[1]=e=>s.Persona.Name2=e),required:!1},null,8,["modelValue"]),(0,y.bF)(i,{label:"Primer apellido",id:"firstSurname",modelValue:s.Persona.Surname1,"onUpdate:modelValue":t[2]||(t[2]=e=>s.Persona.Surname1=e)},null,8,["modelValue"]),s.errors.Surname1?((0,y.uX)(),(0,y.CE)("span",M,(0,h.v_)(s.errors.Surname1),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Segundo apellido",id:"secondSurname",modelValue:s.Persona.Surname2,"onUpdate:modelValue":t[3]||(t[3]=e=>s.Persona.Surname2=e)},null,8,["modelValue"]),s.errors.Surname2?((0,y.uX)(),(0,y.CE)("span",K,(0,h.v_)(s.errors.Surname2),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Cédula de indentidad",id:"IDCard",placeHolder:"0-0000-0000",max_length:11,modelValue:s.Persona.IdCard,"onUpdate:modelValue":t[4]||(t[4]=e=>s.Persona.IdCard=e)},null,8,["modelValue"]),s.errors.IdCard?((0,y.uX)(),(0,y.CE)("span",Q,(0,h.v_)(s.errors.IdCard),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Número de teléfono",id:"cellphone",type:"tel",placeHolder:"0000-0000",max_length:9,modelValue:s.Persona.Number,"onUpdate:modelValue":t[5]||(t[5]=e=>s.Persona.Number=e)},null,8,["modelValue"]),s.errors.Number?((0,y.uX)(),(0,y.CE)("span",O,(0,h.v_)(s.errors.Number),1)):(0,y.Q3)("",!0),(0,y.Lk)("div",J,[t[19]||(t[19]=(0,y.Lk)("label",{for:"province"},[(0,y.eW)("Provincia"),(0,y.Lk)("span",{style:{color:"red"}}," *")],-1)),(0,y.bo)((0,y.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>s.Direccion.selectedProvince=e),class:"form-control",id:"province",required:"",onChange:t[7]||(t[7]=(...e)=>n.getCounties&&n.getCounties(...e))},[t[18]||(t[18]=(0,y.Lk)("option",{value:"",disabled:"",selected:""},"Seleccione una provincia",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.provincias,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,z))),128))],544),[[o.u1,s.Direccion.selectedProvince]])]),s.errors.Provincia?((0,y.uX)(),(0,y.CE)("span",j,(0,h.v_)(s.errors.Provincia),1)):(0,y.Q3)("",!0),(0,y.Lk)("div",W,[t[21]||(t[21]=(0,y.Lk)("label",{for:"canton"},[(0,y.eW)("Cantón"),(0,y.Lk)("span",{style:{color:"red"}}," *")],-1)),(0,y.bo)((0,y.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>s.Direccion.selectedCanton=e),class:"form-control",id:"canton",disabled:!s.Direccion.selectedProvince,required:"",onChange:t[9]||(t[9]=(...e)=>n.getDistricts&&n.getDistricts(...e))},[t[20]||(t[20]=(0,y.Lk)("option",{value:"",disabled:"",selected:""},"Seleccione un cantón",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.cantones,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,G))),128))],40,H),[[o.u1,s.Direccion.selectedCanton]])]),s.errors.Canton?((0,y.uX)(),(0,y.CE)("span",Y,(0,h.v_)(s.errors.Canton),1)):(0,y.Q3)("",!0),(0,y.Lk)("div",Z,[t[23]||(t[23]=(0,y.Lk)("label",{for:"distrit"},[(0,y.eW)("Distrito"),(0,y.Lk)("span",{style:{color:"red"}}," *")],-1)),(0,y.bo)((0,y.Lk)("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>s.Direccion.selectedDistrit=e),class:"form-control",id:"distrit",disabled:!s.Direccion.selectedCanton,required:"",onChange:t[11]||(t[11]=(...e)=>n.getZipCode&&n.getZipCode(...e))},[t[22]||(t[22]=(0,y.Lk)("option",{value:"",disabled:"",selected:""},"Seleccione un distrito",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.distritos,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,te))),128))],40,ee),[[o.u1,s.Direccion.selectedDistrit]])]),s.errors.Distrito?((0,y.uX)(),(0,y.CE)("span",ae,(0,h.v_)(s.errors.Distrito),1)):(0,y.Q3)("",!0),(0,y.Lk)("div",oe,[t[24]||(t[24]=(0,y.Lk)("label",{for:"otherSigns"},[(0,y.eW)("Otras señas"),(0,y.Lk)("span",{style:{color:"red"}}," *")],-1)),(0,y.bo)((0,y.Lk)("textarea",{class:"form-control",style:{"max-height":"200px"},id:"otherSigns",rows:"3",maxlength:"200","onUpdate:modelValue":t[12]||(t[12]=e=>s.Direccion.otherSigns=e),required:""},null,512),[[o.Jo,s.Direccion.otherSigns]])]),s.errors.otherSigns?((0,y.uX)(),(0,y.CE)("span",le,(0,h.v_)(s.errors.otherSigns),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Fecha de nacimiento",id:"birthday",type:"date",modelValue:s.Persona.BirthdayDate,"onUpdate:modelValue":t[13]||(t[13]=e=>s.Persona.BirthdayDate=e)},null,8,["modelValue"]),s.errors.BirthdayDate?((0,y.uX)(),(0,y.CE)("span",se,(0,h.v_)(s.errors.BirthdayDate),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Correo electrónico",id:"email",type:"email",placeHolder:"name@example.com",modelValue:s.Persona.Email,"onUpdate:modelValue":t[14]||(t[14]=e=>s.Persona.Email=e)},null,8,["modelValue"]),s.errors.Email?((0,y.uX)(),(0,y.CE)("span",ne,(0,h.v_)(s.errors.Email),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Contraseña",id:"pwd",type:"password",min_length:8,max_length:16,modelValue:s.password,"onUpdate:modelValue":t[15]||(t[15]=e=>s.password=e)},null,8,["modelValue"]),s.errors.Password?((0,y.uX)(),(0,y.CE)("span",ie,(0,h.v_)(s.errors.Password),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Confirmar contraseña",id:"confPwd",type:"password",min_length:8,max_length:16,modelValue:s.confPassword,"onUpdate:modelValue":t[16]||(t[16]=e=>s.confPassword=e)},null,8,["modelValue"]),s.errors.ConfPassword?((0,y.uX)(),(0,y.CE)("span",re,(0,h.v_)(s.errors.ConfPassword),1)):(0,y.Q3)("",!0),(0,y.Lk)("div",ce,[t[27]||(t[27]=(0,y.Lk)("p",{class:"mb-4",style:{"font-size":"small"}},[(0,y.eW)(" Al continuar, aceptas nuestros "),(0,y.Lk)("a",{href:"#",style:{color:"blue"}},"Términos de servicio"),(0,y.eW)(" y "),(0,y.Lk)("a",{href:"#"},"Política de privacidad")],-1)),(0,y.Lk)("div",null,[t[26]||(t[26]=(0,y.Lk)("span",{class:"me-2"},"¿Ya tienes una cuenta?",-1)),(0,y.bF)(r,{to:"/auth/Login",class:"text-decoration-none"},{default:(0,y.k6)(()=>[...t[25]||(t[25]=[(0,y.eW)(" Inicie Sesión ",-1)])]),_:1})])]),(0,y.Lk)("div",de,[(0,y.bF)(c,{onClick:n.saveRegisterData,text:"Registrarse"},null,8,["onClick"])])],32)])])}a(4114);var pe=a(4373);const me=pe.A.create({baseURL:"https://planillabackend20251121185053-dyhtgeh6hxdtg9hw.canadacentral-01.azurewebsites.net/",headers:{"Content-Type":"application/json"}});var ye=me;const he=["type"];function ve(e,t,a,o,l,s){return(0,y.uX)(),(0,y.CE)("button",{class:"btn btn-lg btn-block w-100",type:a.type},(0,h.v_)(a.text),9,he)}var be={name:"ButtonLink",props:{text:{type:String,required:!0},type:{type:String,default:"button"}}};const fe=(0,I.A)(be,[["render",ve],["__scopeId","data-v-3f4be7aa"]]);var ke=fe;const ge={class:"form-group mt-3"},Le=["for"],Ce={key:0,style:{color:"red"}},Ee=["type","id","placeholder","minlength","maxlength","required","value"];function xe(e,t,a,o,l,s){return(0,y.uX)(),(0,y.CE)("div",ge,[(0,y.Lk)("label",{for:a.id},[(0,y.eW)((0,h.v_)(a.label),1),a.required?((0,y.uX)(),(0,y.CE)("span",Ce," *")):(0,y.Q3)("",!0)],8,Le),(0,y.Lk)("input",{class:"form-control",type:a.type,id:a.id,placeholder:a.placeHolder,minlength:a.min_length,maxlength:a.max_length,required:a.required,value:a.modelValue,onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value))},null,40,Ee)])}var De={name:"InputType",props:{label:{type:String,required:!0},id:{type:String,required:!0},type:{type:String,default:"text"},placeHolder:{type:String,default:""},min_length:{type:Number,default:0},max_length:{type:Number,default:40},required:{type:Boolean,default:!0},modelValue:{type:String,default:""}}};const we=(0,I.A)(De,[["render",xe]]);var Ie=we,Pe={components:{InputType:Ie,LinkButton:ke},data(){return{errors:{},password:"",confPassword:"",zipCode:"",Persona:{Email:"",IdCard:"",Name1:"",Name2:"",Surname1:"",Surname2:"",Number:"",BirthdayDate:"",TypePerson:"Empleador",Status:"Inactivo"},Direccion:{selectedProvince:"",selectedCanton:"",selectedDistrit:"",otherSigns:""},provincias:[],cantones:[],distritos:[]}},methods:{GetProvince(){ye.get("/api/CountryDivision/Provinces").then(e=>{this.provincias=e.data})},getCounties(){this.Direccion.selectedCanton="",this.Direccion.selectedDistrit="",this.cantones=[],this.distritos=[],ye.get("/api/CountryDivision/Counties",{params:{province:this.Direccion.selectedProvince}}).then(e=>{this.cantones=e.data}).catch(console.error)},getDistricts(){ye.get("/api/CountryDivision/Districts",{params:{province:this.Direccion.selectedProvince,county:this.Direccion.selectedCanton}}).then(e=>{this.distritos=e.data}).catch(console.error)},getZipCode(){ye.get("/api/CountryDivision/ZipCode",{params:{province:this.Direccion.selectedProvince,county:this.Direccion.selectedCanton,district:this.Direccion.selectedDistrit}}).then(e=>{this.zipCode=e.data}).catch(console.error)},async validateForm(){if(this.errors={},this.Persona.Name1||(this.errors.Name1="El primer nombre es obligatorio"),this.Persona.Surname1||(this.errors.Surname1="El primer apellido es obligatorio"),this.Persona.Surname2||(this.errors.Surname2="El segundo apellido es obligatorio"),this.Persona.IdCard?/^\d{1}-\d{4}-\d{4}$/.test(this.Persona.IdCard)||(this.errors.IdCard="El formato debe ser #-####-####, solo valores numéricos"):this.errors.IdCard="La cedula es obligatorio",this.Persona.Number?this.Persona.Number.length<8?this.errors.Number="El teléfono debe tener al menos 8 caracteres":/^\d{4}-\d{4}$/.test(this.Persona.Number)||(this.errors.Number="El formato debe ser ####-####, solo valores numéricos"):this.errors.Number="El teléfono es obligatorio",this.Persona.BirthdayDate){const t=new Date,a=new Date(this.Persona.BirthdayDate);var e=t.getFullYear()-a.getFullYear();e<18&&(this.errors.BirthdayDate="Debe ser mayor de edad para registrarse")}else this.errors.BirthdayDate="La fecha de nacimiento es obligatoria";if(this.Direccion.selectedProvince||(this.errors.Provincia="Debe seleccionar una provincia"),this.Direccion.selectedCanton||(this.errors.Canton="Debe seleccionar un cantón"),this.Direccion.selectedDistrit||(this.errors.Distrito="Debe seleccionar un distrito"),this.Direccion.otherSigns||(this.errors.otherSigns="Debe ingresar otras señas"),this.Persona.Email)if(/\S+@\S+\.\S+/.test(this.Persona.Email))try{const e=await ye.get("/api/PersonUser/emailCheck",{params:{email:this.Persona.Email}});e.data>0&&(this.errors.Email="El correo ya está en uso")}catch(t){console.error(t)}else this.errors.Email="Correo inválido";else this.errors.Email="El correo es obligatorio";return this.password?this.password.length<8?this.errors.Password="La contraseña debe tener al menos 8 caracteres":(/[A-Z]/.test(this.password)||(this.errors.Password="La contraseña debe tener al menos una letra mayúscula"),/[a-z]/.test(this.password)||(this.errors.Password="La contraseña debe tener al menos una letra minúscula"),/[0-9]/.test(this.password)||(this.errors.Password="La contraseña debe tener al menos un número"),/[!@#$%^&*(),.?":{}|<>]/.test(this.password)||(this.errors.Password="La contraseña debe tener al menos un carácter especial")):this.errors.Password="La contraseña es obligatoria",this.password!==this.confPassword&&(this.errors.ConfPassword="Las contraseñas no coinciden"),0===Object.keys(this.errors).length},async saveRegisterData(){if(!await this.validateForm())return;const e={personData:(0,u.ux)(this.Persona),password:this.password,otherSigns:this.Direccion.otherSigns,zipCode:this.zipCode.value};console.log(e),ye.post("/api/PersonUser/register",e).then(e=>{console.log("OK:",e.data);const t=v();t.show("Registro exitoso. Por favor, active su cuenta mediante el correo de activación enviado a "+this.Persona.Email+" para poder iniciar sesión","success"),this.$router.push("/auth/Login")}).catch(e=>{e.response?console.log("Error del backend:",e.response.data):console.log("Error de red:",e.message)})}},mounted(){this.GetProvince()}};const Fe=(0,I.A)(Pe,[["render",ue],["__scopeId","data-v-0b1a6540"]]);var Te=Fe;const _e={class:"page d-flex flex-column"},Se={class:"flex-fill d-flex justify-content-center align-items-center"},Ue={style:{"max-width":"400px",width:"100%"}},Ae={class:"mb-3"},Ne={class:"mb-3"},Xe={class:"input-group"},Ve=["type"],qe={class:"d-flex flex-column text-center mb-3"},Re={"aria-live":"polite","aria-atomic":"true",class:"mb-3"},Be={key:0,class:"alert alert-danger py-2 mb-2"},$e={key:1,class:"alert alert-success py-2 mb-0"};function Me(e,t,a,l,s,n){const i=(0,y.g2)("router-link");return(0,y.uX)(),(0,y.CE)("div",_e,[(0,y.Lk)("div",Se,[(0,y.Lk)("div",Ue,[t[12]||(t[12]=(0,y.Lk)("div",{class:"text-center mb-3"},[(0,y.Lk)("h3",{class:"mb-3"},"Iniciar sesión")],-1)),(0,y.Lk)("form",{onSubmit:t[3]||(t[3]=(0,o.D$)((...e)=>n.onSubmit&&n.onSubmit(...e),["prevent"])),class:"needs-validation",novalidate:""},[(0,y.Lk)("div",Ae,[t[4]||(t[4]=(0,y.Lk)("label",{for:"email",class:"form-label required"},"Correo electrónico",-1)),(0,y.bo)((0,y.Lk)("input",{id:"email",type:"email",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>s.email=e),required:"",placeholder:"tu@correo.com"},null,512),[[o.Jo,s.email]]),t[5]||(t[5]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese un correo válido",-1))]),(0,y.Lk)("div",Ne,[t[6]||(t[6]=(0,y.Lk)("label",{for:"password",class:"form-label required"},"Contraseña",-1)),(0,y.Lk)("div",Xe,[(0,y.bo)((0,y.Lk)("input",{id:"password",type:s.showPassword?"text":"password",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),required:"",placeholder:"••••••••"},null,8,Ve),[[o.hp,s.password]]),(0,y.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[2]||(t[2]=e=>s.showPassword=!s.showPassword)},[(0,y.Lk)("i",{class:(0,h.C4)(s.showPassword?"bi bi-eye-slash":"bi bi-eye")},null,2)])]),t[7]||(t[7]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese su contraseña",-1))]),(0,y.Lk)("div",qe,[(0,y.Lk)("small",null,[t[9]||(t[9]=(0,y.eW)(" ¿No tienes una cuenta aún? ",-1)),(0,y.bF)(i,{to:"/auth/Register",class:"text-decoration-none"},{default:(0,y.k6)(()=>[...t[8]||(t[8]=[(0,y.eW)(" Regístrate como empleador ",-1)])]),_:1})]),t[10]||(t[10]=(0,y.Lk)("small",null,[(0,y.Lk)("a",{href:"#",class:"text-decoration-none"},"¿Has olvidado tu contraseña?")],-1))]),(0,y.Lk)("div",Re,[s.errorMsg?((0,y.uX)(),(0,y.CE)("div",Be,(0,h.v_)(s.errorMsg),1)):(0,y.Q3)("",!0),s.successMsg?((0,y.uX)(),(0,y.CE)("div",$e,(0,h.v_)(s.successMsg),1)):(0,y.Q3)("",!0)]),t[11]||(t[11]=(0,y.Lk)("div",{class:"d-grid"},[(0,y.Lk)("button",{type:"submit",class:"btn btn-custom"},"Ingresar")],-1))],32)])])])}var Ke={name:"LoginForm",data(){return{email:"",password:"",showPassword:!1,loading:!1,errorMsg:"",successMsg:""}},methods:{async onSubmit(){if(this.errorMsg="",this.successMsg="",this.email&&this.password){this.loading=!0;try{const{data:e}=await ye.post("/api/Auth/login",{email:this.email.trim(),password:this.password});console.log("[Login] Respuesta:",e),e?.success?(this.$session.set({userId:e.userId,personId:e.personID,fullName:e.fullName,typeUser:e.personType,email:e.email,companyUniqueId:e.companyUniqueId,companyName:e.companyName}),this.successMsg="Login exitoso. Redirigiendo…",this.$router.push({name:"Home Page"})):this.errorMsg=e?.message||"No se pudo iniciar sesión."}catch(e){e?.response?.data?.message?this.errorMsg=e.response.data.message:e?.message?.includes("Network Error")?this.errorMsg="No hay conexión con el servidor. Verifique la URL/puerto.":this.errorMsg="Error al intentar iniciar sesión."}finally{this.loading=!1}}else this.errorMsg="Ingrese correo y contraseña."}}};const Qe=(0,I.A)(Ke,[["render",Me],["__scopeId","data-v-5c18bfd3"]]);var Oe=Qe;const Je={class:"d-flex flex-column min-vh-100",id:"webpageLayout"},ze={class:"flex-fill"};function je(e,t,a,o,l,s){const n=(0,y.g2)("HeaderComp"),i=(0,y.g2)("SidebarComp"),r=(0,y.g2)("router-view"),c=(0,y.g2)("FooterComp");return(0,y.uX)(),(0,y.CE)("div",Je,[(0,y.bF)(n),(0,y.bF)(i),(0,y.Lk)("main",ze,[(0,y.bF)(r)]),(0,y.bF)(c)])}const We={class:"d-flex justify-content-between align-items-center py-3 mb-4 px-4",id:"headerComp"},He={class:"nav nav-underline d-flex align-items-center gap-3"},Ge={key:0,class:"nav-item"},Ye={class:"dropdown text-end"},Ze={class:"btn btn-link dropdown-toggle text-dark text-decoration-none shadow-none",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},et={class:"fs-5 fw-medium"},tt={class:"dropdown-menu dropdown-menu-end",style:{"min-width":"260px"}},at={key:0},ot={key:1},lt=["onClick"],st={key:0,class:"badge bg-secondary"},nt={key:3},it={class:"dropdown-item text-danger"};function rt(e,t,a,l,s,n){return(0,y.uX)(),(0,y.CE)("header",We,[t[4]||(t[4]=(0,y.Lk)("a",{class:"d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none"},[(0,y.Lk)("img",{src:x,alt:"Logo",width:"60",height:"60",class:"me-2"}),(0,y.Lk)("span",{class:"fs-5 fw-medium"},"Onigiri Intelligent Solutions")],-1)),(0,y.Lk)("ul",He,[n.isLoggedIn&&"Empleador"===l.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",Ge,[(0,y.Lk)("div",Ye,[(0,y.Lk)("button",Ze,[(0,y.Lk)("span",et,(0,h.v_)(n.headerCompanyTitle),1)]),(0,y.Lk)("ul",tt,[s.loadingCompanies?((0,y.uX)(),(0,y.CE)("li",at,[...t[0]||(t[0]=[(0,y.Lk)("span",{class:"dropdown-item disabled"},"Cargando…",-1)])])):0===s.companies.length?((0,y.uX)(),(0,y.CE)("li",ot,[...t[1]||(t[1]=[(0,y.Lk)("span",{class:"dropdown-item disabled"},"No tienes empresas",-1)])])):((0,y.uX)(!0),(0,y.CE)(y.FK,{key:2},(0,y.pI)(s.companies,e=>((0,y.uX)(),(0,y.CE)("li",{key:e.companyUniqueId},[(0,y.Lk)("a",{class:"dropdown-item d-flex justify-content-between align-items-center",href:"#",onClick:(0,o.D$)(t=>n.selectCompany(e),["prevent"])},[(0,y.Lk)("span",null,(0,h.v_)(e.companyName),1),e.companyUniqueId===l.session.user?.companyUniqueId?((0,y.uX)(),(0,y.CE)("span",st,"Activa")):(0,y.Q3)("",!0)],8,lt)]))),128)),s.errorMsg?((0,y.uX)(),(0,y.CE)("li",nt,[t[2]||(t[2]=(0,y.Lk)("hr",{class:"dropdown-divider"},null,-1)),(0,y.Lk)("span",it,(0,h.v_)(s.errorMsg),1)])):(0,y.Q3)("",!0)])])])):(0,y.Q3)("",!0),t[3]||(t[3]=(0,y.Lk)("li",{class:"nav-item"},[(0,y.Lk)("button",{class:"btn p-0 border-0 bg-transparent d-flex align-items-center shadow-none",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#appSidebar","aria-controls":"appSidebar"},[(0,y.Lk)("i",{class:"bi bi-list fs-2"})])],-1))])])}a(116);var ct={name:"HeaderComp",setup(){const e=m();return{session:e}},data(){return{companies:[],loadingCompanies:!1,errorMsg:""}},computed:{isLoggedIn(){return!!this.session.user?.userId},sessionUserId(){return this.session.user?.userId||null},headerCompanyTitle(){const e=this.session.user?.companyName;if(e&&e.trim())return e;const t=this.session.user?.companyUniqueId;if(!t)return"Seleccionar empresa";const a=this.companies?.find?.(e=>e.companyUniqueId===t);return a?.companyName||"Seleccionar empresa"}},mounted(){this.isLoggedIn&&"Empleador"===this.session.user?.typeUser&&this.fetchCompanies()},methods:{async fetchCompanies(){if(this.errorMsg="",this.sessionUserId){this.loadingCompanies=!0;try{const{data:e}=await ye.get("/api/Company/by-user/"+this.sessionUserId+"?onlyActive=true"),t=Array.isArray(e)?e.slice():[];if(this.companies=t,this.ensureValidSelectedCompany(),!this.session.user?.companyUniqueId&&this.companies.length>0){const e=this.companies[0],t=this.session.user||{};this.session.set({...t,companyUniqueId:e.companyUniqueId,companyName:e.companyName})}else if(this.session.user?.companyUniqueId&&!this.session.user?.companyName){const e=this.companies.find(e=>e.companyUniqueId===this.session.user.companyUniqueId);if(e){const t=this.session.user||{};this.session.set({...t,companyName:e.companyName})}}}catch(e){this.errorMsg=404===e?.response?.status?"Endpoint no encontrado (404).":"ERR_NETWORK"===e?.code||e?.message?.includes("Network")?"No hay conexión con el API.":e?.response?.data?.message||"Error al cargar empresas."}finally{this.loadingCompanies=!1}}},selectCompany(e){if(!e)return;const t=this.session.user||{};this.session.set({...t,companyUniqueId:e.companyUniqueId,companyName:e.companyName}),window.location.reload()},ensureValidSelectedCompany(){const e=this.session.user?.companyUniqueId;if(!this.companies||0===this.companies.length){const e=this.session.user||{};return void this.session.set({...e,companyUniqueId:null,companyName:null})}const t=this.companies.some(t=>t.companyUniqueId===e);if(!t){const e=this.companies[0],t=this.session.user||{};this.session.set({...t,companyUniqueId:e.companyUniqueId,companyName:e.companyName})}}}};const dt=(0,I.A)(ct,[["render",rt],["__scopeId","data-v-3a1e8be5"]]);var ut=dt;const pt={class:"offcanvas offcanvas-end",tabindex:"-1",id:"appSidebar","aria-labelledby":"sidebarLabel","data-bs-backdrop":"false","data-bs-scroll":"true"},mt={class:"offcanvas-header py-4 my-3"},yt={id:"sidebarLabel"},ht={class:"offcanvas-body"},vt={key:0},bt={class:"list-unstyled ps-0",id:"sidebar-accordion"},ft={class:"my-3"},kt={key:0,class:"my-3"},gt={class:"collapse",id:"company-collapse","data-bs-parent":"#sidebar-accordion"},Lt={class:"list-unstyled ms-4 ps-2 small"},Ct={key:0},Et={key:1},xt={key:1,class:"my-3"},Dt={class:"collapse",id:"employee-collapse","data-bs-parent":"#sidebar-accordion"},wt={class:"list-unstyled ms-4 ps-2 small"},It={key:0},Pt={key:1},Ft={key:2,class:"my-3"},Tt={class:"collapse",id:"timesheet-collapse","data-bs-parent":"#sidebar-accordion"},_t={class:"list-unstyled ms-4 ps-2 small"},St={class:"my-3"},Ut={class:"collapse",id:"payroll-collapse","data-bs-parent":"#sidebar-accordion"},At={class:"list-unstyled ms-4 ps-2 small"},Nt={key:0},Xt={key:1},Vt={key:2},qt={key:3},Rt={class:"my-3"},Bt={class:"collapse",id:"report-collapse","data-bs-parent":"#sidebar-accordion"},$t={class:"list-unstyled ms-4 ps-2 small"},Mt={class:"my-3"};function Kt(e,t,a,o,l,s){const n=(0,y.g2)("RouterLink");return(0,y.uX)(),(0,y.CE)("div",pt,[(0,y.Lk)("div",mt,[(0,y.Lk)("h5",yt,(0,h.v_)(s.activeCompanyName),1),t[1]||(t[1]=(0,y.Lk)("button",{type:"button",class:"btn-close shadow-none","data-bs-dismiss":"offcanvas","aria-label":"Cerrar"},null,-1))]),(0,y.Lk)("div",ht,[(0,y.Lk)("div",null,[t[2]||(t[2]=(0,y.Lk)("i",{class:"bi bi-person-circle fs-2 me-3"},null,-1)),o.session.user?((0,y.uX)(),(0,y.CE)("span",vt,(0,h.v_)(o.session.user.fullName),1)):(0,y.Q3)("",!0)]),(0,y.Lk)("ul",bt,[t[23]||(t[23]=(0,y.Lk)("li",{class:"border-top my-3"},null,-1)),(0,y.Lk)("li",ft,[(0,y.bF)(n,{class:"link-body-emphasis text-decoration-none",to:"/app/Home"},{default:(0,y.k6)(()=>[...t[3]||(t[3]=[(0,y.Lk)("div",{class:"gap-2 px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},[(0,y.Lk)("i",{class:"bi bi-house me-3"}),(0,y.Lk)("span",null,"Página principal")],-1)])]),_:1})]),"Empleador"===o.session.user?.typeUser||"Administrador"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",kt,[t[7]||(t[7]=(0,y.Lk)("button",{class:"nav-link d-flex w-100 gap-2 px-2 py-2 sidebar-item collapsed","data-bs-toggle":"collapse","data-bs-target":"#company-collapse","aria-expanded":"false","aria-controls":"company-collapse"},[(0,y.Lk)("i",{class:"bi bi-buildings me-3"}),(0,y.Lk)("span",{class:"flex-grow-1 text-start"},"Empresas"),(0,y.Lk)("i",{class:"bi bi-chevron-right caret"})],-1)),(0,y.Lk)("div",gt,[(0,y.Lk)("ul",Lt,[(0,y.Lk)("li",null,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Empresas/VerEmpresas"},{default:(0,y.k6)(()=>[...t[4]||(t[4]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Ver Empresas",-1)])]),_:1})]),"Empleador"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",Ct,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Empresas/CrearEmpresa"},{default:(0,y.k6)(()=>[...t[5]||(t[5]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Crear Empresa",-1)])]),_:1})])):(0,y.Q3)("",!0),"Empleador"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",Et,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Empresas/ModificarEmpresa"},{default:(0,y.k6)(()=>[...t[6]||(t[6]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Modificar Empresa",-1)])]),_:1})])):(0,y.Q3)("",!0)])])])):(0,y.Q3)("",!0),"Administrador"!==o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",xt,[t[11]||(t[11]=(0,y.Lk)("button",{class:"nav-link d-flex w-100 gap-2 px-2 py-2 sidebar-item collapsed","data-bs-toggle":"collapse","data-bs-target":"#employee-collapse","aria-expanded":"false","aria-controls":"employee-collapse"},[(0,y.Lk)("i",{class:"bi bi-people me-3"}),(0,y.Lk)("span",{class:"flex-grow-1 text-start"},"Empleados"),(0,y.Lk)("i",{class:"bi bi-chevron-right caret"})],-1)),(0,y.Lk)("div",Dt,[(0,y.Lk)("ul",wt,["Empleado"!==o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",It,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Empleados/VerEmpleados"},{default:(0,y.k6)(()=>[...t[8]||(t[8]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Ver Empleados",-1)])]),_:1})])):(0,y.Q3)("",!0),"Empleador"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",Pt,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Empleados/CrearEmpleado"},{default:(0,y.k6)(()=>[...t[9]||(t[9]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Crear Empleados",-1)])]),_:1})])):(0,y.Q3)("",!0),(0,y.Lk)("li",null,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Empleados/ModificarPerfil"},{default:(0,y.k6)(()=>[...t[10]||(t[10]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Modificar Mi Perfil",-1)])]),_:1})])])])])):(0,y.Q3)("",!0),"Empleado"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",Ft,[t[13]||(t[13]=(0,y.Lk)("button",{class:"nav-link d-flex w-100 gap-2 px-2 py-2 sidebar-item collapsed","data-bs-toggle":"collapse","data-bs-target":"#timesheet-collapse","aria-expanded":"false","aria-controls":"timesheet-collapse"},[(0,y.Lk)("i",{class:"bi bi-calendar-week me-3"}),(0,y.Lk)("span",{class:"flex-grow-1 text-start"},"Timesheets"),(0,y.Lk)("i",{class:"bi bi-chevron-right caret"})],-1)),(0,y.Lk)("div",Tt,[(0,y.Lk)("ul",_t,[(0,y.Lk)("li",null,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Timesheets/CrearTimesheets"},{default:(0,y.k6)(()=>[...t[12]||(t[12]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Crear Timesheet",-1)])]),_:1})])])])])):(0,y.Q3)("",!0),(0,y.Lk)("li",St,[t[19]||(t[19]=(0,y.Lk)("button",{class:"nav-link d-flex w-100 gap-2 px-2 py-2 sidebar-item collapsed","data-bs-toggle":"collapse","data-bs-target":"#payroll-collapse","aria-expanded":"false","aria-controls":"payroll-collapse"},[(0,y.Lk)("i",{class:"bi bi-calculator me-3"}),(0,y.Lk)("span",{class:"flex-grow-1 text-start"},"Planilla"),(0,y.Lk)("i",{class:"bi bi-chevron-right caret"})],-1)),(0,y.Lk)("div",Ut,[(0,y.Lk)("ul",At,["Empleador"===o.session.user?.typeUser||"Aprobador"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",Nt,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Planilla/CrearPlanilla"},{default:(0,y.k6)(()=>[...t[14]||(t[14]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Crear planilla",-1)])]),_:1})])):(0,y.Q3)("",!0),(0,y.Lk)("li",null,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Planilla/VerBeneficiosDeducciones"},{default:(0,y.k6)(()=>[...t[15]||(t[15]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Ver beneficios y deducciones",-1)])]),_:1})]),"Empleador"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",Xt,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Planilla/CrearBeneficiosDeducciones"},{default:(0,y.k6)(()=>[...t[16]||(t[16]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Crear beneficios y deducciones",-1)])]),_:1})])):(0,y.Q3)("",!0),"Empleador"===o.session.user?.typeUser||"Aprobador"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",Vt,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Planilla/AsignarDeducciones"},{default:(0,y.k6)(()=>[...t[17]||(t[17]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Asignar deducciones",-1)])]),_:1})])):(0,y.Q3)("",!0),"Empleado"===o.session.user?.typeUser||"Aprobador"===o.session.user?.typeUser?((0,y.uX)(),(0,y.CE)("li",qt,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Planilla/SeleccionarBeneficios"},{default:(0,y.k6)(()=>[...t[18]||(t[18]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Seleccionar beneficios",-1)])]),_:1})])):(0,y.Q3)("",!0)])])]),(0,y.Lk)("li",Rt,[t[21]||(t[21]=(0,y.Lk)("button",{class:"nav-link d-flex w-100 gap-2 px-2 py-2 sidebar-item collapsed","data-bs-toggle":"collapse","data-bs-target":"#report-collapse","aria-expanded":"false","aria-controls":"report-collapse"},[(0,y.Lk)("i",{class:"bi bi-bar-chart me-3"}),(0,y.Lk)("span",{class:"flex-grow-1 text-start"},"Reportes"),(0,y.Lk)("i",{class:"bi bi-chevron-right caret"})],-1)),(0,y.Lk)("div",Bt,[(0,y.Lk)("ul",$t,[(0,y.Lk)("li",null,[(0,y.bF)(n,{class:"nav-link my-3",to:"/app/Reportes/VerReportes"},{default:(0,y.k6)(()=>[...t[20]||(t[20]=[(0,y.Lk)("span",{class:"px-2 py-2 sidebar-item","data-bs-dismiss":"offcanvas"},"Ver Reportes",-1)])]),_:1})])])])]),t[24]||(t[24]=(0,y.Lk)("li",{class:"border-top my-3"},null,-1)),(0,y.Lk)("li",Mt,[(0,y.Lk)("button",{class:"nav-link link-danger",onClick:t[0]||(t[0]=(...e)=>s.logout&&s.logout(...e)),"data-bs-dismiss":"offcanvas"},[...t[22]||(t[22]=[(0,y.Lk)("div",{class:"gap-2 px-2 py-2"},[(0,y.Lk)("i",{class:"bi bi-box-arrow-right me-3"}),(0,y.Lk)("span",null,"Cerrar sesión")],-1)])])])])])])}var Qt={name:"SidebarComp",setup(){const e=m();return{session:e}},computed:{activeCompanyName(){const e=this.session.user?.companyName;return e&&e.trim()?e:"Seleccionar empresa"}},methods:{logout(){this.session.clear(),this.$router.push({name:"Login"})}}};const Ot=(0,I.A)(Qt,[["render",Kt],["__scopeId","data-v-677412c8"]]);var Jt=Ot,zt={components:{HeaderComp:ut,SidebarComp:Jt,FooterComp:N}};const jt=(0,I.A)(zt,[["render",je],["__scopeId","data-v-7333dd98"]]);var Wt=jt;const Ht={class:"container p-4"},Gt={class:"mb-4 pb-4 px-5"},Yt={key:0},Zt={key:2,class:"row g-5 px-5"},ea={key:0,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},ta={key:1,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},aa={key:2,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},oa={key:3,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},la={key:4,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},sa={key:5,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"},na={key:6,class:"col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"};function ia(e,t,a,o,l,s){const n=(0,y.g2)("EmployerDashboard"),i=(0,y.g2)("EmployeeDashboard"),r=(0,y.g2)("home-page-card");return(0,y.uX)(),(0,y.CE)("div",Ht,[(0,y.Lk)("div",Gt,[e.$session.user?((0,y.uX)(),(0,y.CE)("h4",Yt,"Hola, "+(0,h.v_)(e.$session.user.fullName),1)):(0,y.Q3)("",!0)]),"Empleador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.Wv)(n,{key:0})):"Empleado"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.Wv)(i,{key:1})):((0,y.uX)(),(0,y.CE)("div",Zt,["Empleador"===e.$session.user?.typeUser||"Administrador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",ea,[(0,y.bF)(r,{title:"Empresas",icon:"bi bi-buildings-fill",to:"/app/Empresas/VerEmpresas"})])):(0,y.Q3)("",!0),"Empleador"===e.$session.user?.typeUser||"Aprobador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",ta,[(0,y.bF)(r,{title:"Empleados",icon:"bi bi-people-fill",to:"/app/Empleados/VerEmpleados"})])):(0,y.Q3)("",!0),"Empleado"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",aa,[(0,y.bF)(r,{title:"Empleados",icon:"bi bi-people-fill",to:"/app/Empleados/ModificarPerfil"})])):(0,y.Q3)("",!0),"Empleado"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",oa,[(0,y.bF)(r,{title:"Timesheets",icon:"bi bi-calendar-week-fill",to:"/app/Timesheets/CrearTimesheets"})])):(0,y.Q3)("",!0),"Empleador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",la,[(0,y.bF)(r,{title:"Planilla",icon:"bi bi-calculator-fill",to:"/app/Planilla/CrearPlanilla"})])):(0,y.Q3)("",!0),"Empleado"===e.$session.user?.typeUser||"Administrador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",sa,[(0,y.bF)(r,{title:"Planilla",icon:"bi bi-calculator-fill",to:"/app/Planilla/VerBeneficiosDeducciones"})])):(0,y.Q3)("",!0),"Administrador"!==e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",na,[(0,y.bF)(r,{title:"Reportes",icon:"bi bi-bar-chart-fill",to:"/app/Reportes/VerReportes"})])):(0,y.Q3)("",!0)]))])}const ra={class:"text-center"},ca={class:"ratio ratio-1x1 mx-auto",style:{width:"8rem"}},da={class:"mt-2 fw-semibold"};function ua(e,t,a,o,l,s){const n=(0,y.g2)("RouterLink");return(0,y.uX)(),(0,y.CE)("div",ra,[(0,y.Lk)("div",ca,[(0,y.bF)(n,{class:"p-2 align-items-center justify-content-center border rounded bg-light d-flex flex-column text-dark text-decoration-none",to:a.to},{default:(0,y.k6)(()=>[(0,y.Lk)("i",{class:(0,h.C4)([a.icon,"fs-1"])},null,2)]),_:1},8,["to"])]),(0,y.Lk)("div",da,(0,h.v_)(a.title),1)])}var pa={name:"HomePageCard",props:{title:{type:String,required:!0},icon:{type:String,required:!0},to:{type:String,required:!0}}};const ma=(0,I.A)(pa,[["render",ua]]);var ya=ma;const ha={class:"container py-4"},va={class:"row mb-4"},ba={class:"col-12 col-lg-6"},fa={class:"card"},ka={class:"card-body"},ga={key:1,class:"text-muted mb-0"},La={class:"col-12 col-lg-6 mt-4 mt-lg-0"},Ca={class:"card"},Ea={class:"card-body"},xa={key:1,class:"text-muted mb-0"},Da={class:"row"},wa={class:"col-12 col-lg-6"},Ia={class:"card"},Pa={class:"card-body"},Fa={key:1,class:"text-muted mb-0"};function Ta(e,t,a,o,l,s){const n=(0,y.g2)("apexchart");return(0,y.uX)(),(0,y.CE)("div",ha,[t[3]||(t[3]=(0,y.Lk)("h3",{class:"mb-4"},"Dashboard de Costos y Empleados",-1)),(0,y.Lk)("div",va,[(0,y.Lk)("div",ba,[(0,y.Lk)("div",fa,[t[0]||(t[0]=(0,y.Lk)("div",{class:"card-header fw-bold"}," Costos por tipo ",-1)),(0,y.Lk)("div",ka,[o.pieSeries.length>0?((0,y.uX)(),(0,y.Wv)(n,{key:0,type:"pie",height:"300",options:o.pieOptions,series:o.pieSeries},null,8,["options","series"])):((0,y.uX)(),(0,y.CE)("p",ga,"No hay datos de costos por tipo."))])])]),(0,y.Lk)("div",La,[(0,y.Lk)("div",Ca,[t[1]||(t[1]=(0,y.Lk)("div",{class:"card-header fw-bold"}," Tendencia de costos por mes ",-1)),(0,y.Lk)("div",Ea,[o.lineSeries[0].data.length>0?((0,y.uX)(),(0,y.Wv)(n,{key:0,type:"line",height:"300",options:o.lineOptions,series:o.lineSeries},null,8,["options","series"])):((0,y.uX)(),(0,y.CE)("p",xa,"No hay datos de costos por mes."))])])])]),(0,y.Lk)("div",Da,[(0,y.Lk)("div",wa,[(0,y.Lk)("div",Ia,[t[2]||(t[2]=(0,y.Lk)("div",{class:"card-header fw-bold"}," Empleados por tipo ",-1)),(0,y.Lk)("div",Pa,[o.barSeries[0].data.length>0?((0,y.uX)(),(0,y.Wv)(n,{key:0,type:"bar",height:"300",options:o.barOptions,series:o.barSeries},null,8,["options","series"])):((0,y.uX)(),(0,y.CE)("p",Fa,"No hay datos de empleados por tipo."))])])])])])}var _a={name:"EmployerDashboard",setup(){const e=m(),t=e.user?.companyUniqueId??0,a=v(),o=(0,u.KR)([]),l=(0,u.KR)([]),s=(0,u.KR)([]),n=(0,u.KR)([]),i=(0,u.KR)({chart:{background:"#ffffff"},labels:[],legend:{position:"bottom"}}),r=(0,u.KR)([{name:"Costo total",data:[]}]),c=(0,u.KR)({chart:{background:"#ffffff"},xaxis:{categories:[]},stroke:{curve:"smooth"}}),d=(0,u.KR)([{name:"Empleados",data:[]}]),p=(0,u.KR)({chart:{background:"#ffffff"},xaxis:{categories:[]},plotOptions:{bar:{borderRadius:4,columnWidth:"50%"}}});return(0,y.sV)(async()=>{try{if(!t)return void a.show("No se encontró compañia en la sesión","warning");const{data:e}=await ye.get(`/api/Dashboard/employer/${t}`);o.value=e.costByTypes||[],l.value=e.costByMonth||[],s.value=e.employeeCountByType||[],i.value={...i.value,labels:o.value.map(e=>e.costType)},n.value=o.value.map(e=>e.totalCost),c.value={...c.value,xaxis:{categories:l.value.map(e=>e.month)}},r.value=[{name:"Costo total",data:l.value.map(e=>e.totalCost)}],p.value={...p.value,xaxis:{categories:s.value.map(e=>e.employeeType)}},d.value=[{name:"Empleados",data:s.value.map(e=>e.employeeCount)}]}catch(e){a.show("Error cargando dashboard: "+e,"warning")}}),{costByTypes:o,costByMonth:l,employeeCountByType:s,pieSeries:n,pieOptions:i,lineSeries:r,lineOptions:c,barSeries:d,barOptions:p}}};const Sa=(0,I.A)(_a,[["render",Ta]]);var Ua=Sa;const Aa={class:"container py-4"},Na={class:"row"},Xa={class:"col-12 col-lg-6"},Va={class:"card"},qa={class:"card-body"},Ra={key:1,class:"text-muted mb-0"};function Ba(e,t,a,o,l,s){const n=(0,y.g2)("apexchart");return(0,y.uX)(),(0,y.CE)("div",Aa,[t[1]||(t[1]=(0,y.Lk)("h3",{class:"mb-4"},"Dashboard de empleado",-1)),(0,y.Lk)("div",Na,[(0,y.Lk)("div",Xa,[(0,y.Lk)("div",Va,[t[0]||(t[0]=(0,y.Lk)("div",{class:"card-header fw-bold"}," Gráfico comparativo entre salario bruto y neto ",-1)),(0,y.Lk)("div",qa,[o.barSeries[0].data.length>0?((0,y.uX)(),(0,y.Wv)(n,{key:0,type:"bar",height:"300",options:o.barOptions,series:o.barSeries},null,8,["options","series"])):((0,y.uX)(),(0,y.CE)("p",Ra,"No hay datos de empleados por tipo."))])])])])])}var $a={name:"EmployeeDashboard",setup(){const e=m(),t=e.user?.personId??0,a=v(),o=(0,u.KR)([]),l=(0,u.KR)([{name:"Empleados",data:[]}]),s=(0,u.KR)({chart:{background:"#ffffff"},xaxis:{categories:[]},plotOptions:{bar:{borderRadius:4,columnWidth:"50%"}}});return(0,y.sV)(async()=>{try{if(!t)return void a.show("No se encontró el usuario en la sesión","warning");const{data:e}=await ye.get(`/api/Dashboard/employee/${t}`);o.value=e.employeeFiguresPerMonth||[],s.value={...s.value,xaxis:{categories:["Último mes de pago"]}},l.value=[{name:"Salario Bruto",data:o.value.map(e=>e.grossSalary)},{name:"Salario Neto",data:o.value.map(e=>e.netSalary)}]}catch(e){a.show("Error cargando el dashboard de empleado: "+e,"warning")}}),{employeeFiguresPerMonth:o,barSeries:l,barOptions:s}}};const Ma=(0,I.A)($a,[["render",Ba]]);var Ka=Ma,Qa={components:{HomePageCard:ya,EmployerDashboard:Ua,EmployeeDashboard:Ka}};const Oa=(0,I.A)(Qa,[["render",ia]]);var Ja=Oa;const za={class:"d-flex flex-column"},ja={class:"container mt-5"},Wa={class:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},Ha={key:0},Ga={key:0},Ya=["onClick"],Za={key:0,class:"container mt-5"},eo={class:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},to={key:0},ao={key:0};function oo(e,t,a,l,s,n){const i=(0,y.g2)("PopUp");return(0,y.uX)(),(0,y.CE)("div",za,[(0,y.Lk)("div",ja,[t[9]||(t[9]=(0,y.Lk)("h1",{class:"display-4 text-center"},"Empresas activas",-1)),(0,y.bF)(o.eB,{name:"fade"},{default:(0,y.k6)(()=>[s.popup?((0,y.uX)(),(0,y.Wv)(i,{key:0,mainText:s.popUpData.mainText,bodyText:s.popUpData.bodyText,fistButtontext:s.popUpData.fistButtontext,secondButtontext:s.popUpData.secondButtontext,onClosePopUp:n.togglePopUp,onResolved:s.popUpData.resolve},null,8,["mainText","bodyText","fistButtontext","secondButtontext","onClosePopUp","onResolved"])):(0,y.Q3)("",!0)]),_:1}),(0,y.Lk)("table",Wa,[(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[t[0]||(t[0]=(0,y.Lk)("th",null,"Cédula Jurídica",-1)),t[1]||(t[1]=(0,y.Lk)("th",null,"Nombre",-1)),t[2]||(t[2]=(0,y.Lk)("th",null,"Teléfono",-1)),t[3]||(t[3]=(0,y.Lk)("th",null,"Cantidad de Beneficios",-1)),t[4]||(t[4]=(0,y.Lk)("th",null,"Frecuencia de Pago",-1)),t[5]||(t[5]=(0,y.Lk)("th",null,"Día de Pago #1",-1)),t[6]||(t[6]=(0,y.Lk)("th",null,"Día de Pago #2",-1)),t[7]||(t[7]=(0,y.Lk)("th",null,"Total Empleados",-1)),"Administrador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("th",Ha,"Employer")):(0,y.Q3)("",!0),t[8]||(t[8]=(0,y.Lk)("th",null,"Acciones",-1))])]),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.activeCompanies,(t,a)=>((0,y.uX)(),(0,y.CE)("tr",{key:a},[(0,y.Lk)("td",null,(0,h.v_)(t.companyId),1),(0,y.Lk)("td",null,(0,h.v_)(t.companyName),1),(0,y.Lk)("td",null,(0,h.v_)(t.telephone),1),(0,y.Lk)("td",null,(0,h.v_)(t.maxBenefits),1),(0,y.Lk)("td",null,(0,h.v_)(t.paymentFrequency),1),(0,y.Lk)("td",null,(0,h.v_)(t.payDay1),1),(0,y.Lk)("td",null,(0,h.v_)(t.payDay2),1),(0,y.Lk)("td",null,(0,h.v_)(t.employeeCount),1),"Administrador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("td",Ga,(0,h.v_)(t.employerName),1)):(0,y.Q3)("",!0),(0,y.Lk)("td",null,[(0,y.Lk)("button",{class:"btn btn-sm btn-danger",onClick:e=>n.deleteCompany(t)},"Eliminar",8,Ya)])]))),128))])])]),s.inactiveCompanies.length>0?((0,y.uX)(),(0,y.CE)("div",Za,[t[18]||(t[18]=(0,y.Lk)("h1",{class:"display-4 text-center"},"Empresas inactivas",-1)),(0,y.Lk)("table",eo,[(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[t[10]||(t[10]=(0,y.Lk)("th",null,"Cédula Jurídica",-1)),t[11]||(t[11]=(0,y.Lk)("th",null,"Nombre",-1)),t[12]||(t[12]=(0,y.Lk)("th",null,"Teléfono",-1)),t[13]||(t[13]=(0,y.Lk)("th",null,"Cantidad de Beneficios",-1)),t[14]||(t[14]=(0,y.Lk)("th",null,"Frecuencia de Pago",-1)),t[15]||(t[15]=(0,y.Lk)("th",null,"Día de Pago #1",-1)),t[16]||(t[16]=(0,y.Lk)("th",null,"Día de Pago #2",-1)),t[17]||(t[17]=(0,y.Lk)("th",null,"Total Empleados",-1)),"Administrador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("th",to,"Employer")):(0,y.Q3)("",!0)])]),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.inactiveCompanies,(t,a)=>((0,y.uX)(),(0,y.CE)("tr",{key:a},[(0,y.Lk)("td",null,(0,h.v_)(t.companyId),1),(0,y.Lk)("td",null,(0,h.v_)(t.companyName),1),(0,y.Lk)("td",null,(0,h.v_)(t.telephone),1),(0,y.Lk)("td",null,(0,h.v_)(t.maxBenefits),1),(0,y.Lk)("td",null,(0,h.v_)(t.paymentFrequency),1),(0,y.Lk)("td",null,(0,h.v_)(t.payDay1),1),(0,y.Lk)("td",null,(0,h.v_)(t.payDay2),1),(0,y.Lk)("td",null,(0,h.v_)(t.employeeCount),1),"Administrador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("td",ao,(0,h.v_)(t.employerName),1)):(0,y.Q3)("",!0)]))),128))])])])):(0,y.Q3)("",!0)])}a(2489);const lo={class:"pop-up"},so={class:"pop-up-inner"},no={class:"pop-up-content"},io={class:"pair-btn"};function ro(e,t,a,o,l,s){const n=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)("div",lo,[(0,y.Lk)("div",so,[(0,y.Lk)("div",{class:"pop-up-close",onClick:t[0]||(t[0]=(...e)=>s.closePopUp&&s.closePopUp(...e))}," × "),(0,y.Lk)("div",no,[(0,y.Lk)("h1",null,(0,h.v_)(a.mainText),1),(0,y.Lk)("p",null,(0,h.v_)(a.bodyText),1),(0,y.Lk)("div",io,[(0,y.bF)(n,{text:a.fistButtontext,onClick:s.accept},null,8,["text","onClick"]),(0,y.bF)(n,{text:a.secondButtontext,onClick:s.cancel},null,8,["text","onClick"])])])])])}var co={name:"PopUp",components:{LinkButton:ke},props:{mainText:{type:String,default:"Acá va el texto principal"},bodyText:{type:String,default:"Acá va el texto secundario"},fistButtontext:{type:String,default:"Botón 1"},secondButtontext:{type:String,default:"Botón 2"}},methods:{closePopUp(){this.$emit("closePopUp")},accept(){this.$emit("closePopUp"),this.$emit("resolved",!0)},cancel(){this.$emit("closePopUp"),this.$emit("resolved",!1)}}};const uo=(0,I.A)(co,[["render",ro]]);var po=uo,mo={name:"CompaniesList",components:{PopUp:po},data(){return{activeCompanies:[],inactiveCompanies:[],popup:!1,popUpData:{mainText:"",bodyText:"",fistButtontext:"",secondButtontext:""}}},methods:{fetchCompanies(){const e=this.$session.user?.userId;e&&ye.get("/api/Company/getCompaniesWithStats",{params:{employerId:e,viewerUserId:e}}).then(e=>{this.updateCompaniesLists(e.data)}).catch(e=>{console.error("Error fetching companies:",e)})},async deleteCompany(e){const t=await this.showPopUp(e);if(t)try{await ye.delete("/api/Company/company",{params:{companyId:e.companyUniqueId,employeerPersonId:this.$session.user?.personId}});const t=v();t.show("Empresa eliminada exitosamente","success"),this.fetchCompanies()}catch(a){const e=v(),t=a.response?.data?.message||"Error desconocido";e.show("Error al eliminar la empresa: "+t,"warning")}},updateCompaniesLists(e){this.activeCompanies=e.filter(e=>"Activo"===e.state),this.inactiveCompanies=e.filter(e=>"Inactivo"===e.state)},showPopUp(e){return new Promise(t=>{this.popUpData={mainText:"Eliminar Empresa",bodyText:`¿Está seguro de que desea eliminar esta empresa?\n            Empresa: ${e.companyName} (Cédula Jurídica: ${e.companyId})`,fistButtontext:"Sí, eliminar",secondButtontext:"No, cancelar",resolve:t},this.togglePopUp()})},togglePopUp(){this.popup=!this.popup}},created(){this.fetchCompanies()}};const yo=(0,I.A)(mo,[["render",oo],["__scopeId","data-v-247c3725"]]);var ho=yo;const vo={class:"d-flex flex-column"},bo={class:"container py-4 flex-fill d-flex justify-content-center"},fo={class:"mb-3 col-xl-3 col-sm-12"},ko={class:"mb-3 col-xl-9 col-sm-12"},go={class:"mb-3 col-xl-6 col-sm-12"},Lo=["value"],Co={class:"mb-3 col-xl-6 col-sm-12"},Eo=["disabled"],xo=["value"],Do={class:"mb-3 col-xl-6 col-sm-12"},wo=["disabled"],Io=["value"],Po={class:"mb-3 col-xl-6 col-sm-12"},Fo={class:"mb-3"},To={class:"mb-3"},_o={class:"mb-3"},So={class:"mb-3"},Uo={class:"mb-3"},Ao=["disabled"],No={key:0},Xo=["value"],Vo={key:1},qo=["value"],Ro={key:0,class:"mb-3"},Bo=["disabled"],$o=["value"],Mo={class:"toast-container position-fixed top-0 end-0 p-3"},Ko={class:"d-flex"},Qo={class:"toast-body"};function Oo(e,t,a,l,s,n){return(0,y.uX)(),(0,y.CE)("div",vo,[t[47]||(t[47]=(0,y.Lk)("h1",{class:"text-center"},"Crear nueva empresa",-1)),(0,y.Lk)("div",bo,[(0,y.Lk)("form",{ref:"companyForm",onSubmit:t[15]||(t[15]=(0,o.D$)((...e)=>n.saveCompany&&n.saveCompany(...e),["prevent"])),class:"row g-3 needs-validation",novalidate:"",style:{width:"800px"}},[(0,y.Lk)("div",fo,[t[17]||(t[17]=(0,y.Lk)("label",{for:"companyId",class:"form-label required"},"Cédula Jurídica",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"companyId",placeholder:"3-000-000000",required:"",pattern:"[0-9]{1}-[0-9]{3}-[0-9]{6}","onUpdate:modelValue":t[0]||(t[0]=e=>s.companyId=e)},null,512),[[o.Jo,s.companyId]]),t[18]||(t[18]=(0,y.Lk)("div",{class:"invalid-feedback"}," Ingrese la cédula jurídica con el formato requerido #-###-###### ",-1))]),(0,y.Lk)("div",ko,[t[19]||(t[19]=(0,y.Lk)("label",{for:"companyName",class:"form-label required"},"Nombre Empresa",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"companyName",required:"",maxlength:"150","onUpdate:modelValue":t[1]||(t[1]=e=>s.companyName=e)},null,512),[[o.Jo,s.companyName]]),t[20]||(t[20]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el nombre de la empresa",-1))]),(0,y.Lk)("div",go,[t[22]||(t[22]=(0,y.Lk)("label",{for:"province",class:"form-label required"},"Provincia",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"province",required:"","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedProvince=e),onChange:t[3]||(t[3]=(...e)=>n.getCounties&&n.getCounties(...e))},[t[21]||(t[21]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione una Provincia",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.provinces,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,Lo))),128))],544),[[o.u1,s.selectedProvince]]),t[23]||(t[23]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione una provincia",-1))]),(0,y.Lk)("div",Co,[t[25]||(t[25]=(0,y.Lk)("label",{for:"county",class:"form-label required"},"Cantón",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"county",required:"","onUpdate:modelValue":t[4]||(t[4]=e=>s.selectedCounty=e),onChange:t[5]||(t[5]=(...e)=>n.getDistricts&&n.getDistricts(...e)),disabled:!s.selectedProvince||0===s.counties.length},[t[24]||(t[24]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un cantón",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.counties,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,xo))),128))],40,Eo),[[o.u1,s.selectedCounty]]),t[26]||(t[26]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione un cantón",-1))]),(0,y.Lk)("div",Do,[t[28]||(t[28]=(0,y.Lk)("label",{for:"district",class:"form-label required"},"Distrito",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"district",required:"","onUpdate:modelValue":t[6]||(t[6]=e=>s.selectedDistrict=e),onChange:t[7]||(t[7]=(...e)=>n.getZipCode&&n.getZipCode(...e)),disabled:!s.selectedCounty||0===s.districts.length},[t[27]||(t[27]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un distrito",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.districts,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,Io))),128))],40,wo),[[o.u1,s.selectedDistrict]]),t[29]||(t[29]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione un distrito",-1))]),(0,y.Lk)("div",Po,[t[30]||(t[30]=(0,y.Lk)("label",{for:"zipCode",class:"form-label"},"Código Postal",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"zipCode",disabled:"",readonly:"","onUpdate:modelValue":t[8]||(t[8]=e=>s.zipCode=e)},null,512),[[o.Jo,s.zipCode]])]),(0,y.Lk)("div",Fo,[t[31]||(t[31]=(0,y.Lk)("label",{for:"addressDetails",class:"form-label required"},"Otras señas",-1)),(0,y.bo)((0,y.Lk)("textarea",{class:"form-control",id:"addressDetails",rows:"3",placeholder:"Otras señas",required:"",maxlength:"250","onUpdate:modelValue":t[9]||(t[9]=e=>s.addressDetails=e)},null,512),[[o.Jo,s.addressDetails]]),t[32]||(t[32]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese las otras señas",-1))]),(0,y.Lk)("div",To,[t[33]||(t[33]=(0,y.Lk)("label",{for:"telephone",class:"form-label"},"Teléfono",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"telephone",placeholder:"2222-2222",pattern:"[0-9]{4}-[0-9]{4}","onUpdate:modelValue":t[10]||(t[10]=e=>s.telephone=e)},null,512),[[o.Jo,s.telephone]]),t[34]||(t[34]=(0,y.Lk)("div",{class:"invalid-feedback"}," Ingrese el número de teléfono con el formato requerido ####-#### ",-1))]),(0,y.Lk)("div",_o,[t[35]||(t[35]=(0,y.Lk)("label",{for:"maxBenefits",class:"form-label required"},"Cantidad máxima de beneficios",-1)),(0,y.bo)((0,y.Lk)("input",{type:"number",class:"form-control",id:"maxBenefits",placeholder:"0",min:"0",required:"","onUpdate:modelValue":t[11]||(t[11]=e=>s.maxBenefits=e)},null,512),[[o.Jo,s.maxBenefits,void 0,{number:!0}]]),t[36]||(t[36]=(0,y.Lk)("div",{class:"invalid-feedback"}," Ingrese la cantidad máxima de beneficios que puede seleccionar un empleado ",-1))]),(0,y.Lk)("div",So,[t[38]||(t[38]=(0,y.Lk)("label",{for:"paymentFrequency",class:"form-label required"},"Frecuencia de pago",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"paymentFrequency",required:"","onUpdate:modelValue":t[12]||(t[12]=e=>s.paymentFrequency=e)},[...t[37]||(t[37]=[(0,y.Lk)("option",{selected:"",disabled:"",value:""}," Selecciona la frecuencia de pago de la planilla ",-1),(0,y.Lk)("option",null,"Mensual",-1),(0,y.Lk)("option",null,"Quincenal",-1)])],512),[[o.u1,s.paymentFrequency]]),t[39]||(t[39]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione la frecuencia de pago de planilla",-1))]),(0,y.Lk)("div",Uo,[t[41]||(t[41]=(0,y.Lk)("label",{for:"payDay1",class:"form-label required"},"Día de pago",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"payDay1",required:"","onUpdate:modelValue":t[13]||(t[13]=e=>s.payDay1=e),disabled:!s.paymentFrequency},[t[40]||(t[40]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Día de pago",-1)),"Quincenal"===s.paymentFrequency?((0,y.uX)(),(0,y.CE)("div",No,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.middleMonthDay,e=>((0,y.uX)(),(0,y.CE)("option",{key:e,value:e},(0,h.v_)(e),9,Xo))),128))])):((0,y.uX)(),(0,y.CE)("div",Vo,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.lastMonthDay,e=>((0,y.uX)(),(0,y.CE)("option",{key:e,value:e},(0,h.v_)(e),9,qo))),128))]))],8,Ao),[[o.u1,s.payDay1]]),t[42]||(t[42]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione el día de pago de la planilla",-1))]),"Quincenal"===s.paymentFrequency?((0,y.uX)(),(0,y.CE)("div",Ro,[t[44]||(t[44]=(0,y.Lk)("label",{for:"payDay2",class:"form-label required"},"Segundo día de pago",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"payDay2",required:"","onUpdate:modelValue":t[14]||(t[14]=e=>s.payDay2=e),disabled:!s.payDay1},[t[43]||(t[43]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Segundo día de pago",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(n.daysAfterFirst,e=>((0,y.uX)(),(0,y.CE)("option",{key:e,value:e},(0,h.v_)(e),9,$o))),128))],8,Bo),[[o.u1,s.payDay2]]),t[45]||(t[45]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione el segundo día de pago de la planilla",-1))])):(0,y.Q3)("",!0),t[46]||(t[46]=(0,y.Lk)("div",{class:"mb-3"},[(0,y.Lk)("button",{class:"btn btn-custom w-100 mt-2",type:"submit"},"Crear Empresa")],-1))],544)]),(0,y.Lk)("div",Mo,[s.showToast?((0,y.uX)(),(0,y.CE)("div",{key:0,class:(0,h.C4)(["toast show align-items-center text-white border-0",s.toastType]),role:"alert","aria-live":"assertive","aria-atomic":"true"},[(0,y.Lk)("div",Ko,[(0,y.Lk)("div",Qo,(0,h.v_)(s.toastMessage),1),(0,y.Lk)("button",{type:"button",class:"btn-close btn-close-white me-2 m-auto",onClick:t[16]||(t[16]=e=>s.showToast=!1)})])],2)):(0,y.Q3)("",!0)])])}var Jo={data(){return{provinces:[],selectedProvince:"",counties:[],selectedCounty:"",districts:[],selectedDistrict:"",zipCode:"",paymentFrequency:"",payDay1:"",payDay2:"",companyId:"",companyName:"",addressDetails:"",telephone:"",maxBenefits:"",showToast:!1,toastMessage:"",toastType:"bg-success",toastTimeout:3e3,middleMonthDay:15,lastMonthDay:30}},computed:{daysAfterFirst(){return this.payDay1?Array.from({length:this.lastMonthDay-this.middleMonthDay},(e,t)=>this.middleMonthDay+t+1):[]}},watch:{paymentFrequency(e){"Mensual"===e&&(this.payDay2="")},payDay1(){this.payDay2&&Number(this.payDay2)<=Number(this.payDay1)&&(this.payDay2="")}},methods:{initBootstrapValidation(){const e=this.$refs.companyForm;e&&e.addEventListener("submit",t=>{e.checkValidity()?t.preventDefault():(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")})},getProvince(){ye.get("/api/CountryDivision/Provinces").then(e=>{this.provinces=e.data})},getCounties(){this.selectedCounty="",this.counties=[],this.selectedDistrict="",this.districts=[],this.zipCode="",ye.get("/api/CountryDivision/Counties",{params:{province:this.selectedProvince}}).then(e=>{this.counties=e.data}).catch(console.error)},getDistricts(){this.selectedDistrict="",this.districts=[],this.zipCode="",ye.get("/api/CountryDivision/Districts",{params:{province:this.selectedProvince,county:this.selectedCounty}}).then(e=>{this.districts=e.data}).catch(console.error)},getZipCode(){this.zipCode="",ye.get("/api/CountryDivision/ZipCode",{params:{province:this.selectedProvince,county:this.selectedCounty,district:this.selectedDistrict}}).then(e=>{this.zipCode=e.data.value}).catch(console.error)},saveCompany(){var e=this,t=this.$refs.companyForm;t.checkValidity()&&ye.post("/api/Company",{CompanyId:this.companyId,CompanyName:this.companyName.trim(),AddressDetails:this.addressDetails.trim(),ZipCode:this.zipCode,Telephone:""!==this.telephone?this.telephone:null,MaxBenefits:Number(this.maxBenefits||0),PaymentFrequency:this.paymentFrequency,PayDay1:this.payDay1,PayDay2:"Quincenal"===this.paymentFrequency?Number(this.payDay2||0):null,CreatedBy:Number(this.$session.user?.userId)}).then(function(t){const a=Number(t.data);e.$session?.user&&null==e.$session.user.companyUniqueId&&e.$session.set({...e.$session.user,companyUniqueId:a}),e.toastMessage="Empresa creada correctamente",e.toastType="bg-success",e.showToast=!0,setTimeout(function(){e.showToast=!1,window.location.href="/app/Home"},e.toastTimeout)}).catch(function(t){var a=t&&t.response&&t.response.data?t.response.data:"Error inesperado al crear la empresa";e.toastMessage=a,e.toastType="bg-danger",e.showToast=!0,setTimeout(function(){e.showToast=!1},e.toastTimeout)})}},mounted(){"Empleador"===this.$session.user?.typeUser&&(this.initBootstrapValidation(),this.getProvince())}};const zo=(0,I.A)(Jo,[["render",Oo],["__scopeId","data-v-f550581a"]]);var jo=zo;const Wo={class:"d-flex flex-column"},Ho={class:"text-center"},Go={class:"container py-4 flex-fill d-flex justify-content-center"},Yo={class:"mb-3 col-xl-3 col-sm-12"},Zo={class:"mb-3 col-xl-9 col-sm-12"},el={class:"mb-3 col-xl-6 col-sm-12"},tl=["value"],al={class:"mb-3 col-xl-6 col-sm-12"},ol=["disabled"],ll=["value"],sl={class:"mb-3 col-xl-6 col-sm-12"},nl=["disabled"],il=["value"],rl={class:"mb-3 col-xl-6 col-sm-12"},cl={class:"mb-3"},dl={class:"mb-3"},ul={class:"mb-3"},pl=["min"],ml={class:"mb-3"},yl={class:"mb-3"},hl={key:0,class:"mb-3"},vl={class:"mb-3 pair-btn"};function bl(e,t,a,l,s,n){const i=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)("div",Wo,[(0,y.Lk)("h1",Ho,"Editar Empresa - "+(0,h.v_)(s.companyNameTitle),1),(0,y.Lk)("div",Go,[(0,y.Lk)("form",{ref:"companyForm",onSubmit:t[15]||(t[15]=(0,o.D$)((...e)=>n.UpdateCompanyData&&n.UpdateCompanyData(...e),["prevent"])),class:"row g-3 needs-validation",novalidate:"",style:{width:"800px"}},[(0,y.Lk)("div",Yo,[t[16]||(t[16]=(0,y.Lk)("label",{for:"companyId",class:"form-label"},"Cédula Jurídica",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled",id:"companyId",pattern:"[0-9]{1}-[0-9]{3}-[0-9]{6}","onUpdate:modelValue":t[0]||(t[0]=e=>s.companyId=e),disabled:""},null,512),[[o.Jo,s.companyId]])]),(0,y.Lk)("div",Zo,[t[17]||(t[17]=(0,y.Lk)("label",{for:"companyName",class:"form-label required"},"Nombre Empresa",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"companyName",required:"",maxlength:"150","onUpdate:modelValue":t[1]||(t[1]=e=>s.companyName=e)},null,512),[[o.Jo,s.companyName]]),t[18]||(t[18]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el nombre de la empresa",-1))]),(0,y.Lk)("div",el,[t[20]||(t[20]=(0,y.Lk)("label",{for:"province",class:"form-label required"},"Provincia",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"province",required:"","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedProvince=e),onChange:t[3]||(t[3]=(...e)=>n.getCounties&&n.getCounties(...e))},[t[19]||(t[19]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione una Provincia",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.provinces,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,tl))),128))],544),[[o.u1,s.selectedProvince]]),t[21]||(t[21]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione una provincia",-1))]),(0,y.Lk)("div",al,[t[23]||(t[23]=(0,y.Lk)("label",{for:"county",class:"form-label required"},"Cantón",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"county",required:"","onUpdate:modelValue":t[4]||(t[4]=e=>s.selectedCounty=e),onChange:t[5]||(t[5]=(...e)=>n.getDistricts&&n.getDistricts(...e)),disabled:!s.selectedProvince||0===s.counties.length},[t[22]||(t[22]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un cantón",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.counties,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,ll))),128))],40,ol),[[o.u1,s.selectedCounty]]),t[24]||(t[24]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione un cantón",-1))]),(0,y.Lk)("div",sl,[t[26]||(t[26]=(0,y.Lk)("label",{for:"district",class:"form-label required"},"Distrito",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"district",required:"","onUpdate:modelValue":t[6]||(t[6]=e=>s.selectedDistrict=e),onChange:t[7]||(t[7]=(...e)=>n.getZipCode&&n.getZipCode(...e)),disabled:!s.selectedCounty||0===s.districts.length},[t[25]||(t[25]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un distrito",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.districts,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,il))),128))],40,nl),[[o.u1,s.selectedDistrict]]),t[27]||(t[27]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione un distrito",-1))]),(0,y.Lk)("div",rl,[t[28]||(t[28]=(0,y.Lk)("label",{for:"zipCode",class:"form-label"},"Código Postal",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"zipCode",disabled:"",readonly:"","onUpdate:modelValue":t[8]||(t[8]=e=>s.zipCode=e)},null,512),[[o.Jo,s.zipCode]])]),(0,y.Lk)("div",cl,[t[29]||(t[29]=(0,y.Lk)("label",{for:"addressDetails",class:"form-label required"},"Otras señas",-1)),(0,y.bo)((0,y.Lk)("textarea",{class:"form-control",id:"addressDetails",rows:"3",placeholder:"Otras señas",required:"",maxlength:"250","onUpdate:modelValue":t[9]||(t[9]=e=>s.addressDetails=e)},null,512),[[o.Jo,s.addressDetails]]),t[30]||(t[30]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese las otras señas",-1))]),(0,y.Lk)("div",dl,[t[31]||(t[31]=(0,y.Lk)("label",{for:"telephone",class:"form-label"},"Teléfono",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"telephone",placeholder:"2222-2222",pattern:"[0-9]{4}-[0-9]{4}","onUpdate:modelValue":t[10]||(t[10]=e=>s.telephone=e)},null,512),[[o.Jo,s.telephone]]),t[32]||(t[32]=(0,y.Lk)("div",{class:"invalid-feedback"}," Ingrese el número de teléfono con el formato requerido ####-#### ",-1))]),(0,y.Lk)("div",ul,[t[33]||(t[33]=(0,y.Lk)("label",{for:"maxBenefits",class:"form-label required"},"Cantidad máxima de beneficios",-1)),(0,y.bo)((0,y.Lk)("input",{type:"number",class:"form-control",id:"maxBenefits",placeholder:"0",min:s.minBenefits,required:"","onUpdate:modelValue":t[11]||(t[11]=e=>s.maxBenefits=e)},null,8,pl),[[o.Jo,s.maxBenefits,void 0,{number:!0}]]),t[34]||(t[34]=(0,y.Lk)("div",{class:"invalid-feedback"}," Ingrese la cantidad máxima de beneficios que puede seleccionar un empleado ",-1))]),(0,y.Lk)("div",ml,[t[35]||(t[35]=(0,y.Lk)("label",{for:"paymentFrequency",class:"form-label"},"Frecuencia de pago",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled",id:"paymentFrequency","onUpdate:modelValue":t[12]||(t[12]=e=>s.paymentFrequency=e),disabled:""},null,512),[[o.Jo,s.paymentFrequency]])]),(0,y.Lk)("div",yl,[t[36]||(t[36]=(0,y.Lk)("label",{for:"payDay1",class:"form-label"},"Día de pago",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled",id:"payDay1","onUpdate:modelValue":t[13]||(t[13]=e=>s.payDay1=e),disabled:""},null,512),[[o.Jo,s.payDay1]])]),"Quincenal"===s.paymentFrequency?((0,y.uX)(),(0,y.CE)("div",hl,[t[37]||(t[37]=(0,y.Lk)("label",{for:"payDay2",class:"form-label"},"Segundo día de pago",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled",id:"payDay2","onUpdate:modelValue":t[14]||(t[14]=e=>s.payDay2=e),disabled:""},null,512),[[o.Jo,s.payDay2]])])):(0,y.Q3)("",!0),(0,y.Lk)("div",vl,[(0,y.bF)(i,{onClick:n.goBack,text:"Cancelar"},null,8,["onClick"]),(0,y.bF)(i,{text:"Guardar",type:"submit"})])],544)])])}var fl={components:{LinkButton:ke},data(){return{companyUniqueId:0,user:null,provinces:[],selectedProvince:"",counties:[],selectedCounty:"",districts:[],selectedDistrict:"",zipCode:"",paymentFrequency:"",payDay1:"",payDay2:"",companyId:"",companyName:"",companyNameTitle:"",addressDetails:"",telephone:"",maxBenefits:"",minBenefits:0}},methods:{initBootstrapValidation(){const e=this.$refs.companyForm;e&&e.addEventListener("submit",t=>{e.checkValidity()?t.preventDefault():(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")})},async InitFormData(e){try{const t=await ye.get("/api/Company/GCBCUI",{params:{companyUniqueId:e}}),a=t.data;this.companyId=a.companyId,this.companyName=a.companyName,this.companyNameTitle=this.companyName,this.telephone=a.telephone||"",this.maxBenefits=a.maxBenefits,this.paymentFrequency=a.paymentFrequency,this.payDay1=a.payDay1,this.payDay2=a.payDay2||"",this.selectedProvince=a.directions.province,await this.getCounties(),this.selectedCounty=a.directions.canton,await this.getDistricts(),this.selectedDistrict=a.directions.district,this.zipCode=a.directions.zipCode,this.addressDetails=a.directions.otherSigns||""}catch(t){console.error("Error al cargar los datos de la empresa:",t)}},async setMinBenefits(e){try{const t=await ye.get("/api/Company/MaxBenTak",{params:{companyUniqueId:e}});this.minBenefits=t.data,console.log(this.minBenefits+" y "+t.data)}catch(t){console.error("Error al cargar los datos de la empresa:",t)}},getProvince(){ye.get("/api/CountryDivision/Provinces").then(e=>{this.provinces=e.data})},getCounties(){return this.counties=[],this.districts=[],this.zipCode="",ye.get("/api/CountryDivision/Counties",{params:{province:this.selectedProvince}}).then(e=>{this.counties=e.data}).catch(console.error)},getDistricts(){return this.districts=[],this.zipCode="",ye.get("/api/CountryDivision/Districts",{params:{province:this.selectedProvince,county:this.selectedCounty}}).then(e=>{this.districts=e.data}).catch(console.error)},getZipCode(){this.zipCode="",ye.get("/api/CountryDivision/ZipCode",{params:{province:this.selectedProvince,county:this.selectedCounty,district:this.selectedDistrict}}).then(e=>{this.zipCode=e.data.value}).catch(console.error)},UpdateCompanyData(){const e=v();let t={companyUniqueId:this.companyUniqueId,companyId:this.companyId,companyName:this.companyName,Telephone:this.telephone,MaxBenefits:this.maxBenefits,paymentFrequency:this.paymentFrequency,directions:{province:this.selectedProvince,canton:this.selectedCounty,district:this.selectedDistrict,zipCode:this.zipCode,otherSigns:this.addressDetails}};ye.post("/api/Company/UpdComp",t).then(t=>{t.data>0?(e.show("¡Datos de la empresa actualizados correctamente!","success"),window.location.reload()):e.show("No se pudo actualizar los datos de la empresa, intente más tarde. \nSi el problema persiste, comuníquese con soporte","warning")})},goBack(){window.history.back()}},async mounted(){const{user:e}=m();this.user=e,this.user&&"Empleador"===this.user.typeUser&&(this.companyUniqueId=e.companyUniqueId,await this.InitFormData(this.companyUniqueId),await this.setMinBenefits(this.companyUniqueId),this.initBootstrapValidation(),this.getProvince())}};const kl=(0,I.A)(fl,[["render",bl],["__scopeId","data-v-204513f0"]]);var gl=kl;const Ll={class:"d-flex flex-column"},Cl={class:"container mt-5"},El={class:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},xl=["onClick"],Dl=["onClick"];var wl={__name:"ViewEmployees",setup(e){const t=(0,s.rd)(),a=(0,u.KR)([]),o=(0,u.KR)(null);function l(e){return new Date(e).toLocaleDateString()}async function n(){const e=r();if(e){o.value=e;try{const{data:t}=await ye.get("/api/PersonUser/getEmployeesByCompanyId",{params:{companyId:e.companyUniqueId}});a.value=t}catch(t){console.error("Error al cargar empleados:",t),a.value=[]}}}function i(e){const a=e.idPerson;a||0===a?t.push({name:"ModifyEmployees",query:{personId:a}}):console.warn("No se encontró personId",e)}async function c(e){if(confirm("¿Seguro que desea eliminar al empleado "+e.name1+" "+e.surname1+"?"))try{await ye.delete(`/api/Employee/${e.idUser}`),alert("¡Empleado eliminada exitosamente!"),setTimeout(()=>window.location.reload(),500)}catch(t){console.error("Error: ",t)}}return(0,y.sV)(n),(e,t)=>((0,y.uX)(),(0,y.CE)("div",Ll,[(0,y.Lk)("div",Cl,[t[1]||(t[1]=(0,y.Lk)("h1",{class:"display-4 text-center"},"Lista de Empleados",-1)),(0,y.Lk)("table",El,[t[0]||(t[0]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Cédula"),(0,y.Lk)("th",null,"Primer Nombre"),(0,y.Lk)("th",null,"Segundo Nombre"),(0,y.Lk)("th",null,"Primer Apellido"),(0,y.Lk)("th",null,"Segundo Apellido"),(0,y.Lk)("th",null,"Fecha Nacimiento"),(0,y.Lk)("th",null,"Email"),(0,y.Lk)("th",null,"Tipo Contrato"),(0,y.Lk)("th",null,"Puesto"),(0,y.Lk)("th",null,"Departamento"),(0,y.Lk)("th",null,"Acciones"),(0,y.Lk)("th")])],-1)),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(a.value,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t},[(0,y.Lk)("td",null,(0,h.v_)(e.idCard),1),(0,y.Lk)("td",null,(0,h.v_)(e.name1),1),(0,y.Lk)("td",null,(0,h.v_)(e.name2),1),(0,y.Lk)("td",null,(0,h.v_)(e.surname1),1),(0,y.Lk)("td",null,(0,h.v_)(e.surname2),1),(0,y.Lk)("td",null,(0,h.v_)(l(e.birthdayDate)),1),(0,y.Lk)("td",null,(0,h.v_)(e.email),1),(0,y.Lk)("td",null,(0,h.v_)(e.contractType),1),(0,y.Lk)("td",null,(0,h.v_)(e.jobPosition),1),(0,y.Lk)("td",null,(0,h.v_)(e.department),1),(0,y.Lk)("td",null,[(0,y.Lk)("button",{class:"btn btn-sm btn-primary",onClick:t=>i(e)}," Editar ",8,xl)]),(0,y.Lk)("td",null,[(0,y.Lk)("button",{class:"btn btn-sm btn-danger",onClick:t=>c(e)}," Eliminar ",8,Dl)])]))),128))])])])]))}};const Il=wl;var Pl=Il;const Fl={class:"d-flex flex-column",id:"container"},Tl={class:"d-flex justify-content-center align-items-center"},_l={key:0,class:"text-danger"},Sl={key:1,class:"text-danger"},Ul={key:2,class:"text-danger"},Al={key:3,class:"text-danger"},Nl={key:4,class:"text-danger"},Xl={key:5,class:"text-danger"},Vl={key:6,class:"text-danger"},ql={key:7,class:"text-danger"},Rl={key:8,class:"text-danger"},Bl={key:9,class:"text-danger"},$l={key:10,class:"text-danger"},Ml={key:11,class:"text-danger"},Kl={class:"form-group text-center"};function Ql(e,t,a,l,s,n){const i=(0,y.g2)("InputType"),r=(0,y.g2)("SelectType"),c=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)("div",Fl,[(0,y.Lk)("div",Tl,[(0,y.Lk)("form",{class:"form-signig p-5 h-100 d-inline-block",style:{"max-width":"550px",width:"100%"},onSubmit:t[13]||(t[13]=(0,o.D$)((...e)=>n.saveEmployee&&n.saveEmployee(...e),["prevent"]))},[t[14]||(t[14]=(0,y.Lk)("h2",{class:"font-weigth-normal text-center mb-4"},"Registrar un empleado",-1)),(0,y.bF)(i,{label:"Primer nombre",id:"firstName",modelValue:s.Employee.name1,"onUpdate:modelValue":t[0]||(t[0]=e=>s.Employee.name1=e)},null,8,["modelValue"]),s.errors.name1?((0,y.uX)(),(0,y.CE)("span",_l,(0,h.v_)(s.errors.name1),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Segundo nombre",id:"SecondName",modelValue:s.Employee.name2,"onUpdate:modelValue":t[1]||(t[1]=e=>s.Employee.name2=e),required:!1},null,8,["modelValue"]),(0,y.bF)(i,{label:"Primer apellido",id:"firstSurname",modelValue:s.Employee.surname1,"onUpdate:modelValue":t[2]||(t[2]=e=>s.Employee.surname1=e)},null,8,["modelValue"]),s.errors.surname1?((0,y.uX)(),(0,y.CE)("span",Sl,(0,h.v_)(s.errors.surname1),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Segundo apellido",id:"secondSurname",modelValue:s.Employee.surname2,"onUpdate:modelValue":t[3]||(t[3]=e=>s.Employee.surname2=e)},null,8,["modelValue"]),s.errors.surname2?((0,y.uX)(),(0,y.CE)("span",Ul,(0,h.v_)(s.errors.surname2),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Cédula de indentidad",id:"IDCard",placeHolder:"0-0000-0000",max_length:11,modelValue:s.Employee.idCard,"onUpdate:modelValue":t[4]||(t[4]=e=>s.Employee.idCard=e)},null,8,["modelValue"]),s.errors.idCard?((0,y.uX)(),(0,y.CE)("span",Al,(0,h.v_)(s.errors.idCard),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Fecha de nacimiento",id:"birthday",type:"date",modelValue:s.Employee.birthDate,"onUpdate:modelValue":t[5]||(t[5]=e=>s.Employee.birthDate=e)},null,8,["modelValue"]),s.errors.birthDate?((0,y.uX)(),(0,y.CE)("span",Nl,(0,h.v_)(s.errors.birthDate),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Correo electrónico",id:"email",type:"email",placeHolder:"name@example.com",modelValue:s.Employee.email,"onUpdate:modelValue":t[6]||(t[6]=e=>s.Employee.email=e)},null,8,["modelValue"]),s.errors.email?((0,y.uX)(),(0,y.CE)("span",Xl,(0,h.v_)(s.errors.email),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Puesto",id:"position",modelValue:s.Contract.position,"onUpdate:modelValue":t[7]||(t[7]=e=>s.Contract.position=e)},null,8,["modelValue"]),s.errors.position?((0,y.uX)(),(0,y.CE)("span",Vl,(0,h.v_)(s.errors.position),1)):(0,y.Q3)("",!0),(0,y.bF)(r,{label:"Departamento",id:"department",modelValue:s.Contract.department,"onUpdate:modelValue":t[8]||(t[8]=e=>s.Contract.department=e),options:[{value:"Administracion",text:"Administración"},{value:"Contabilidad",text:"Contabilidad"},{value:"Mercadeo",text:"Mercadeo"},{value:"Operaciones",text:"Operaciones"},{value:"Produccion",text:"Producción"},{value:"Recursos Humanos",text:"Recursos Humanos"},{value:"Ventas",text:"Ventas"}]},null,8,["modelValue"]),s.errors.department?((0,y.uX)(),(0,y.CE)("span",ql,(0,h.v_)(s.errors.department),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Salario",id:"salary",type:"number",modelValue:s.Contract.salary,"onUpdate:modelValue":t[9]||(t[9]=e=>s.Contract.salary=e)},null,8,["modelValue"]),s.errors.salary?((0,y.uX)(),(0,y.CE)("span",Rl,(0,h.v_)(s.errors.salary),1)):(0,y.Q3)("",!0),(0,y.bF)(r,{label:"Tipo de empleado",id:"employeeType",modelValue:s.Contract.employeeType,"onUpdate:modelValue":t[10]||(t[10]=e=>s.Contract.employeeType=e),options:[{value:"Tiempo Completo",text:"Tiempo Completo"},{value:"Medio Tiempo",text:"Medio Tiempo"},{value:"Servicios Profesionales",text:"Servicios Profesionales"}]},null,8,["modelValue"]),s.errors.employeeType?((0,y.uX)(),(0,y.CE)("span",Bl,(0,h.v_)(s.errors.employeeType),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Fecha de inicio",id:"startDate",type:"date",modelValue:s.Contract.startDate,"onUpdate:modelValue":t[11]||(t[11]=e=>s.Contract.startDate=e)},null,8,["modelValue"]),s.errors.startDate?((0,y.uX)(),(0,y.CE)("span",$l,(0,h.v_)(s.errors.startDate),1)):(0,y.Q3)("",!0),(0,y.bF)(i,{label:"Cuenta bancaria IBAN",id:"iban",modelValue:s.Contract.bankAccount,"onUpdate:modelValue":t[12]||(t[12]=e=>s.Contract.bankAccount=e)},null,8,["modelValue"]),s.errors.bankAccount?((0,y.uX)(),(0,y.CE)("span",Ml,(0,h.v_)(s.errors.bankAccount),1)):(0,y.Q3)("",!0),(0,y.Lk)("div",Kl,[(0,y.bF)(c,{type:"button",onClick:n.saveEmployee,text:"Guardar Empleado"},null,8,["onClick"])])],32)])])}const Ol={class:"form-group mt-3"},Jl=["for"],zl={key:0,style:{color:"red"}},jl=["id","required","value"],Wl=["value"];function Hl(e,t,a,o,l,s){return(0,y.uX)(),(0,y.CE)("div",Ol,[(0,y.Lk)("label",{for:a.id},[(0,y.eW)((0,h.v_)(a.label)+" ",1),a.required?((0,y.uX)(),(0,y.CE)("span",zl," *")):(0,y.Q3)("",!0)],8,Jl),(0,y.Lk)("select",{class:"form-select",id:a.id,required:a.required,value:a.modelValue,onChange:t[0]||(t[0]=t=>e.$emit("update:modelValue",t.target.value))},[t[1]||(t[1]=(0,y.Lk)("option",{value:"",disabled:""},"Seleccione...",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(a.options,(e,t)=>((0,y.uX)(),(0,y.CE)("option",{key:t,value:e.value},(0,h.v_)(e.text),9,Wl))),128))],40,jl)])}var Gl={name:"SelectType",props:{label:{type:String,required:!0},id:{type:String,required:!0},required:{type:Boolean,default:!0},modelValue:{type:String,default:""},options:{type:Array,required:!0}}};const Yl=(0,I.A)(Gl,[["render",Hl]]);var Zl=Yl,es={components:{InputType:Ie,LinkButton:ke,SelectType:Zl},data(){return{errors:{},Employee:{idCard:"",name1:"",name2:"",surname1:"",surname2:"",phone:"9999-9999",birthDate:"",personType:"Empleado",email:"",password:"Temporary01!",status:"Inactivo",companyUniqueId:""},Contract:{position:"",department:"",salary:"",employeeType:"",startDate:"",bankAccount:""}}},methods:{async validateForm(){if(this.errors={},this.Employee.name1||(this.errors.name1="El primer nombre es obligatorio"),this.Employee.surname1||(this.errors.surname1="El primer apellido es obligatorio"),this.Employee.surname2||(this.errors.surname2="El segundo apellido es obligatorio"),this.Employee.idCard?/^\d{1}-\d{4}-\d{4}$/.test(this.Employee.idCard)||(this.errors.idCard="El formato debe ser #-####-####, solo valores numéricos"):this.errors.idCard="La cedula es obligatorio",this.Employee.birthDate){const t=new Date,a=new Date(this.Employee.birthDate);var e=t.getFullYear()-a.getFullYear();e<18&&(this.errors.birthDate="Debe ser mayor de edad para registrarse")}else this.errors.birthDate="La fecha de nacimiento es obligatoria";if(this.Employee.email)if(/\S+@\S+\.\S+/.test(this.Employee.email))try{const e=await ye.get("/api/PersonUser/emailCheck",{params:{email:this.Employee.email}});e.data>0&&(this.errors.email="El correo ya está en uso")}catch(t){console.error(t)}else this.errors.email="Correo inválido";else this.errors.email="El correo es obligatorio";return this.Contract.salary?this.Contract.salary<"0"&&(this.errors.salary="El salario debe ser mayor a 0"):this.errors.salary="El salario es obligatorio",this.Contract.startDate||(this.errors.startDate="La fecha de inicio es obligatorio"),this.Contract.bankAccount?22!==this.Contract.bankAccount.length?this.errors.bankAccount="Tamaño de cuenta incorrecto":/^CR\d{20}$/.test(this.Contract.bankAccount)||(this.errors.bankAccount="Formato IBAN de Costa Rica inválido (CR + 20 dígitos)"):this.errors.bankAccount="La cuenta bancaria es obligatorio",0===Object.keys(this.errors).length},async saveEmployee(){if(!await this.validateForm())return;const e={personData:{cedula:this.Employee.idCard,name1:this.Employee.name1,name2:this.Employee.name2||null,surname1:this.Employee.surname1,surname2:this.Employee.surname2||"",phone:this.Employee.phone,birthDate:this.Employee.birthDate,personType:this.Employee.personType},userData:{email:this.Employee.email,password:this.Employee.password,status:this.Employee.status},contractData:{position:this.Contract.position,department:this.Contract.department,salary:Number(this.Contract.salary),employeeType:this.Contract.employeeType,startDate:this.Contract.startDate,bankAccount:this.Contract.bankAccount},companyUniqueId:Number(this.$session.user?.companyUniqueId)},t=v();ye.post("/api/Employee",e).then(e=>{console.log("OK:",e.data),t.show("Registro exitoso.","success"),this.$router.push("/home")}).catch(e=>{e.response?(t.show("Error al registrar empleado:"+e.response.data,"warning"),console.log("Error del backend:",e.response.data)):(t.show("Error de red:"+e.message,"warning"),console.log("Error de red:",e.message))})}},mounted(){}};const ts=(0,I.A)(es,[["render",Ql],["__scopeId","data-v-3d54dabe"]]);var as=ts;const os={class:"d-flex flex-column"},ls={class:"container py-4 flex-fill d-flex justify-content-center"},ss={class:"mb-3 col-xl-6 col-sm-12"},ns={class:"mb-3 col-xl-6 col-sm-12"},is={class:"mb-3 col-xl-6 col-sm-12"},rs={class:"mb-3 col-xl-6 col-sm-12"},cs={class:"mb-3 col-xl-4 col-sm-12"},ds={class:"mb-3 col-xl-6 col-sm-12"},us=["value"],ps={class:"mb-3 col-xl-6 col-sm-12"},ms=["disabled"],ys=["value"],hs={class:"mb-3 col-xl-6 col-sm-12"},vs=["disabled"],bs=["value"],fs={class:"mb-3 col-xl-6 col-sm-12"},ks={class:"mb-3"},gs={class:"mb-3 col-xl-6 col-sm-12"},Ls={class:"mb-3 col-xl-6 col-sm-12"},Cs={class:"mb-3 col-xl-6 col-sm-12"},Es={class:"mb-3 col-xl-6 col-sm-12"},xs=["pattern"],Ds={class:"mb-3 pair-btn"};var ws={__name:"ModifyEmployees",setup(e){const t=(0,s.lq)(),a=(0,u.KR)(null),l=(0,u.KR)(""),n=(0,u.KR)([]),i=(0,u.KR)([]),r=(0,u.KR)([]),c=(0,u.Kh)({selectedProvince:"",selectedCanton:"",selectedDistrit:"",otherSigns:""}),d=(0,u.Kh)({personData:{personID:0,cedula:"",name1:"",name2:null,surname1:"",surname2:"",phone:"",birthDate:null,personType:"Empleado",company:null},userData:null,contractData:{idContract:0,position:"",department:"",salary:0,employeeType:null,startDate:null,endDate:null,bankAccount:"",personID:0},companyUniqueId:null,direction:{idDirection:0,idDivision:0,province:"",canton:"",district:"",zipCode:"",otherSigns:null,idCompany:null,intPerson:null}}),p=(0,u.KR)(null),b=(0,y.EW)(()=>"CR\\d{20}"),f=(0,y.EW)(()=>d?.direction?.zipCode??"");function k(){const e=p.value;e&&e.addEventListener("submit",t=>{e.checkValidity()?t.preventDefault():(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")})}function g(){const{user:e}=m();if(!e)throw new Error("Sesión inválida");a.value=e.personId??null}const L=(e,t=[])=>(Array.isArray(e)?e:[]).map(e=>{if("string"===typeof e)return{value:e};for(const a of t)if(e?.[a])return{value:e[a]};return{value:String(e??"")}}).filter(e=>e.value);async function C(){const{data:e}=await ye.get("/api/CountryDivision/Provinces");n.value=L(e,["value","provincia","Province"])}async function E(){i.value=[],r.value=[],d.direction.zipCode="";const{data:e}=await ye.get("/api/CountryDivision/Counties",{params:{province:c.selectedProvince}});i.value=L(e,["value","canton","County"])}async function x(){r.value=[],d.direction.zipCode="";const{data:e}=await ye.get("/api/CountryDivision/Districts",{params:{province:c.selectedProvince,county:c.selectedCanton}});r.value=L(e,["value","district","Distrito"])}async function D(){const{data:e}=await ye.get("/api/CountryDivision/ZipCode",{params:{province:c.selectedProvince,county:c.selectedCanton,district:c.selectedDistrit}});d.direction.zipCode=e?.value??e}async function w(e){if(await C(),!e)return c.selectedProvince="",c.selectedCanton="",c.selectedDistrit="",void(c.otherSigns="");c.selectedProvince=e.province||"",await E(),c.selectedCanton=e.canton||"",await x(),c.selectedDistrit=e.district||"",c.otherSigns=e.otherSigns||""}async function I(){if(l.value)try{const{data:e}=await ye.get(`/api/Employee/${l.value}`);Object.assign(d.personData,e?.personData??{}),Object.assign(d.contractData,e?.contractData??{}),Object.assign(d.direction,e?.direction??{}),d.companyUniqueId=e?.companyUniqueId??d.companyUniqueId,await w(d.direction)}catch(e){console.error(e),v().show("No se encontró el empleado.","warning")}}function P(){const e=c.selectedProvince||c.selectedCanton||c.selectedDistrit||c.otherSigns;let t=d.direction;return e&&(t={...d.direction,province:c.selectedProvince||null,canton:c.selectedCanton||null,district:c.selectedDistrit||null,otherSigns:c.otherSigns||null}),{personData:{...d.personData},userData:null,contractData:{...d.contractData},direction:t}}async function F(){const e=p.value;if(!e?.checkValidity())return void e?.classList.add("was-validated");if(!l.value)return void v().show("Indique IdPersona y presione Cargar","warning");const t=P();try{await ye.put(`/api/Employee/emp/${a.value}/employee/${l.value}`,t),v().show("Empleado actualizado.","success")}catch(o){console.error(o),v().show("No se pudo actualizar el empleado.","danger")}}function T(){window.history.back()}return(0,y.sV)(async()=>{const e=t.query?.personId;void 0!==e&&(l.value=Number(e),await I()),g(),k(),await C()}),(e,t)=>((0,y.uX)(),(0,y.CE)("div",os,[t[40]||(t[40]=(0,y.Lk)("h1",{class:"text-center"},"Modificar empleado",-1)),(0,y.Lk)("div",ls,[(0,y.Lk)("form",{ref_key:"employeeForm",ref:p,onSubmit:(0,o.D$)(F,["prevent"]),class:"row g-3 needs-validation",novalidate:"",style:{width:"900px"}},[t[37]||(t[37]=(0,y.Lk)("h5",{class:"mt-2"},"Datos personales",-1)),(0,y.Lk)("div",ss,[t[14]||(t[14]=(0,y.Lk)("label",{for:"firstNameE",class:"form-label required"},"Primer nombre",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"firstNameE",required:"",maxlength:"60","onUpdate:modelValue":t[0]||(t[0]=e=>d.personData.name1=e)},null,512),[[o.Jo,d.personData.name1]]),t[15]||(t[15]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el primer nombre",-1))]),(0,y.Lk)("div",ns,[t[16]||(t[16]=(0,y.Lk)("label",{for:"secondNameE",class:"form-label"},"Segundo nombre",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"secondNameE",maxlength:"60","onUpdate:modelValue":t[1]||(t[1]=e=>d.personData.name2=e)},null,512),[[o.Jo,d.personData.name2]])]),(0,y.Lk)("div",is,[t[17]||(t[17]=(0,y.Lk)("label",{for:"surname1E",class:"form-label required"},"Primer apellido",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"surname1E",required:"",maxlength:"60","onUpdate:modelValue":t[2]||(t[2]=e=>d.personData.surname1=e)},null,512),[[o.Jo,d.personData.surname1]]),t[18]||(t[18]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el primer apellido",-1))]),(0,y.Lk)("div",rs,[t[19]||(t[19]=(0,y.Lk)("label",{for:"surname2E",class:"form-label required"},"Segundo apellido",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"surname2E",required:"",maxlength:"60","onUpdate:modelValue":t[3]||(t[3]=e=>d.personData.surname2=e)},null,512),[[o.Jo,d.personData.surname2]]),t[20]||(t[20]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el segundo apellido",-1))]),(0,y.Lk)("div",cs,[t[21]||(t[21]=(0,y.Lk)("label",{for:"phoneE",class:"form-label"},"Teléfono",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"phoneE",placeholder:"0000-0000",pattern:"[0-9]{4}-[0-9]{4}","onUpdate:modelValue":t[4]||(t[4]=e=>d.personData.phone=e)},null,512),[[o.Jo,d.personData.phone]]),t[22]||(t[22]=(0,y.Lk)("div",{class:"invalid-feedback"},"Use el formato ####-####",-1))]),t[38]||(t[38]=(0,y.Lk)("h5",{class:"mt-2"},"Dirección",-1)),(0,y.Lk)("div",ds,[t[24]||(t[24]=(0,y.Lk)("label",{for:"provinceE",class:"form-label"},"Provincia",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"provinceE","onUpdate:modelValue":t[5]||(t[5]=e=>c.selectedProvince=e),onChange:E},[t[23]||(t[23]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione una Provincia",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(n.value,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,us))),128))],544),[[o.u1,c.selectedProvince]])]),(0,y.Lk)("div",ps,[t[26]||(t[26]=(0,y.Lk)("label",{for:"countyE",class:"form-label"},"Cantón",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"countyE","onUpdate:modelValue":t[6]||(t[6]=e=>c.selectedCanton=e),onChange:x,disabled:!c.selectedProvince||0===i.value.length},[t[25]||(t[25]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un cantón",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(i.value,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,ys))),128))],40,ms),[[o.u1,c.selectedCanton]])]),(0,y.Lk)("div",hs,[t[28]||(t[28]=(0,y.Lk)("label",{for:"districtE",class:"form-label"},"Distrito",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"districtE","onUpdate:modelValue":t[7]||(t[7]=e=>c.selectedDistrit=e),onChange:D,disabled:!c.selectedCanton||0===r.value.length},[t[27]||(t[27]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un distrito",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(r.value,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,bs))),128))],40,vs),[[o.u1,c.selectedDistrit]])]),(0,y.Lk)("div",fs,[t[29]||(t[29]=(0,y.Lk)("label",{for:"zipCodeE",class:"form-label"},"Código Postal",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"zipCodeE",disabled:"",readonly:"","onUpdate:modelValue":t[8]||(t[8]=e=>f.value=e)},null,512),[[o.Jo,f.value]])]),(0,y.Lk)("div",ks,[t[30]||(t[30]=(0,y.Lk)("label",{for:"otherSignsE",class:"form-label"},"Otras señas",-1)),(0,y.bo)((0,y.Lk)("textarea",{class:"form-control",id:"otherSignsE",rows:"3",maxlength:"250","onUpdate:modelValue":t[9]||(t[9]=e=>c.otherSigns=e)},null,512),[[o.Jo,c.otherSigns]])]),t[39]||(t[39]=(0,y.Lk)("h5",{class:"mt-2"},"Contrato",-1)),(0,y.Lk)("div",gs,[t[31]||(t[31]=(0,y.Lk)("label",{for:"position",class:"form-label"},"Puesto",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"position",maxlength:"80","onUpdate:modelValue":t[10]||(t[10]=e=>d.contractData.position=e)},null,512),[[o.Jo,d.contractData.position]])]),(0,y.Lk)("div",Ls,[t[32]||(t[32]=(0,y.Lk)("label",{for:"department",class:"form-label"},"Departamento",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"department",maxlength:"80","onUpdate:modelValue":t[11]||(t[11]=e=>d.contractData.department=e)},null,512),[[o.Jo,d.contractData.department]])]),(0,y.Lk)("div",Cs,[t[33]||(t[33]=(0,y.Lk)("label",{for:"salary",class:"form-label"},"Salario",-1)),(0,y.bo)((0,y.Lk)("input",{type:"number",class:"form-control",id:"salary",min:0,step:"0.01","onUpdate:modelValue":t[12]||(t[12]=e=>d.contractData.salary=e)},null,512),[[o.Jo,d.contractData.salary,void 0,{number:!0}]]),t[34]||(t[34]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese un salario válido (≥ 0)",-1))]),(0,y.Lk)("div",Es,[t[35]||(t[35]=(0,y.Lk)("label",{for:"iban2",class:"form-label"},"Cuenta bancaria (IBAN CR)",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"iban2",pattern:b.value,"onUpdate:modelValue":t[13]||(t[13]=e=>d.contractData.bankAccount=e)},null,8,xs),[[o.Jo,d.contractData.bankAccount,void 0,{trim:!0}]]),t[36]||(t[36]=(0,y.Lk)("div",{class:"invalid-feedback"},"Formato IBAN inválido (CR + 20 dígitos)",-1))]),(0,y.Lk)("div",Ds,[(0,y.bF)(ke,{onClick:T,text:"Cancelar"}),(0,y.bF)(ke,{text:"Guardar",type:"submit"})])],544)])]))}};const Is=(0,I.A)(ws,[["__scopeId","data-v-2e6ef050"]]);var Ps=Is;const Fs={class:"d-flex flex-column"},Ts={class:"container mt-5"},_s={class:"d-flex align-items-center gap-2"},Ss={class:"card-body"},Us={class:"rounded-3 p-4 bg-light"},As={class:"row text-center align-items-center"},Ns=["onUpdate:modelValue","onInput","disabled"],Xs={class:"form-text mt-1 small text-muted"},Vs={class:"mt-4"},qs=["disabled"],Rs={key:0,class:"text-danger ms-3"},Bs={key:1,class:"text-success ms-3"};var $s={__name:"CreateTimesheets",setup(e){const t=m(),a=(0,y.EW)(()=>t.user?.personId??null),l=(0,u.KR)(k()),s=(0,u.KR)(null),n=(0,u.KR)(null),i=(0,u.KR)(!1),r=(0,u.KR)(""),c=(0,u.KR)(!1),d=(0,u.Kh)({}),p=(0,u.Kh)({}),v=(0,u.Kh)({}),b=(0,y.EW)(()=>{if(!s.value)return[];const e=[];for(let t=0;t<7;t++){const a=L(s.value,t);e.push({date:a,key:g(a)})}return e}),f=(0,y.EW)(()=>b.value.slice(0,5));function k(){const e=new Date;return e.setHours(0,0,0,0),e.toISOString().slice(0,10)}function g(e){const t=new Date(e);return t.setHours(0,0,0,0),t.toISOString().slice(0,10)}function L(e,t){const a=new Date(e);return a.setDate(a.getDate()+t),a.setHours(0,0,0,0),a}function C(e){return e.toLocaleDateString("es-CR",{day:"2-digit",month:"2-digit"})}async function E(e){r.value="",c.value=!1,i.value=!0;try{const{data:t}=await ye.get(`/api/Timesheet/week/${a.value}`,{params:{day:e}});s.value=new Date(t.weekStart),n.value=new Date(t.weekEnd);for(const e of b.value)d[e.key]=0,v[e.key]=!1;if(Array.isArray(t.entries))for(const e of t.entries){const t=e.date?.slice(0,10);t&&(d[t]=Number.isFinite(e.hours)?e.hours:0,v[t]=!0)}}catch(t){r.value="No se pudieron cargar las horas de la semana."}finally{i.value=!1}}function x(){l.value&&E(l.value)}function D(e){let t=Number(d[e]??0);isNaN(t)&&(t=0),t<0&&(t=0),t>9&&(t=9),d[e]=t}function w(e){const t=new Date;if(t.setHours(0,0,0,0),e>t)return!0;const a=g(e);return!0===v[a]}async function I(){if(s.value){r.value="",c.value=!1,i.value=!0;try{const e=g(s.value),t=new Date;t.setHours(0,0,0,0);const o=f.value.filter(e=>e.date<=t).filter(e=>!w(e.date)).map(e=>{const t=Number(d[e.key]??0),a=(p[e.key]??"").trim();return{date:e.key,hours:t,description:a||null}}).filter(e=>Number.isFinite(e.hours)&&e.hours>0||e.description&&e.description.length>0);if(0===o.length)return r.value="No hay días válidos para guardar (no puede registrar días futuros).",void(i.value=!1);await ye.post(`/api/Timesheet/week/${a.value}`,{weekStart:e,entries:o}),c.value=!0;for(const a of o)v[a.date]=!0}catch(e){r.value="No se pudieron guardar las horas."}finally{i.value=!1,setTimeout(()=>c.value=!1,2500)}}}return(0,y.sV)(()=>{a.value?E(l.value):r.value="No se encontro el ID del Empleado"}),(e,t)=>((0,y.uX)(),(0,y.CE)("div",Fs,[(0,y.Lk)("div",Ts,[t[3]||(t[3]=(0,y.Lk)("h3",{class:"display-5 text-center mb-4"},"Horas Semanales",-1)),(0,y.Lk)("div",_s,[t[1]||(t[1]=(0,y.Lk)("label",{class:"form-label mb-0"},"Semana",-1)),(0,y.bo)((0,y.Lk)("input",{type:"date",class:"form-control",style:{"max-width":"180px"},"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),onChange:x},null,544),[[o.Jo,l.value]])]),(0,y.Lk)("div",Ss,[t[2]||(t[2]=(0,y.Fv)('<div class="row text-center fw-semibold mb-3"><div class="col">Lunes</div><div class="col">Martes</div><div class="col">Miércoles</div><div class="col">Jueves</div><div class="col">Viernes</div></div>',1)),(0,y.Lk)("div",Us,[(0,y.Lk)("div",As,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(f.value,e=>((0,y.uX)(),(0,y.CE)("div",{class:"col",key:e.key},[(0,y.bo)((0,y.Lk)("input",{type:"number",class:"form-control text-center fw-semibold",min:0,max:9,step:"1","onUpdate:modelValue":t=>d[e.key]=t,onInput:t=>D(e.key),disabled:w(e.date)},null,40,Ns),[[o.Jo,d[e.key],void 0,{number:!0}]]),(0,y.Lk)("div",Xs,(0,h.v_)(C(e.date)),1)]))),128))])]),(0,y.Lk)("div",Vs,[(0,y.Lk)("button",{class:"btn btn-success px-4 py-2 rounded-pill fw-semibold",onClick:I,disabled:i.value||!s.value},(0,h.v_)(i.value?"Guardando...":"Confirmar"),9,qs),r.value?((0,y.uX)(),(0,y.CE)("span",Rs,(0,h.v_)(r.value),1)):(0,y.Q3)("",!0),c.value?((0,y.uX)(),(0,y.CE)("span",Bs,"Guardado")):(0,y.Q3)("",!0)])])])]))}};const Ms=$s;var Ks=Ms;const Qs={class:"d-flex flex-column"},Os={class:"container mt-5"},Js={key:0,class:"row align-items-end my-4"},zs={class:"col-auto d-flex align-items-end gap-4"},js={key:0},Ws={class:"btn-group",role:"group"},Hs={class:"col ms-auto text-end"},Gs=["disabled"],Ys={key:1,class:"row align-items-center justify-content-between my-4"},Zs={class:"col-auto"},en={class:"fs-5 mb-1"},tn={class:"fs-5"},an={class:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},on={key:0},ln={class:"toast-container position-fixed top-0 end-0 p-3"},sn={class:"d-flex"},nn={class:"toast-body"};function rn(e,t,a,l,s,n){return(0,y.uX)(),(0,y.CE)("div",Qs,[(0,y.Lk)("div",Os,[t[8]||(t[8]=(0,y.Lk)("h1",{class:"display-4 text-center"},"Creación de planilla",-1)),s.payroll?((0,y.uX)(),(0,y.CE)("div",Ys,[(0,y.Lk)("div",Zs,[(0,y.Lk)("div",en,"Fecha inicial: "+(0,h.v_)(n.formatDate(s.payroll.dateFrom)),1),(0,y.Lk)("div",tn,"Fecha final: "+(0,h.v_)(n.formatDate(s.payroll.dateTo)),1)])])):((0,y.uX)(),(0,y.CE)("div",Js,[(0,y.Lk)("div",zs,[(0,y.Lk)("div",null,[t[5]||(t[5]=(0,y.Lk)("label",{class:"form-label mb-1"},"Mes a pagar",-1)),(0,y.bo)((0,y.Lk)("input",{type:"month",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedMonth=e)},null,512),[[o.Jo,s.selectedMonth]])]),"Quincenal"===s.paymentFrequency?((0,y.uX)(),(0,y.CE)("div",js,[t[6]||(t[6]=(0,y.Lk)("label",{class:"form-label mb-1 d-block"},"Periodo",-1)),(0,y.Lk)("div",Ws,[(0,y.Lk)("button",{type:"button",class:(0,h.C4)(["btn","01"===s.half?"btn-secondary":"btn-outline-secondary"]),onClick:t[1]||(t[1]=e=>s.half="01")}," 1 al 15 ",2),(0,y.Lk)("button",{type:"button",class:(0,h.C4)(["btn","16"===s.half?"btn-secondary":"btn-outline-secondary"]),onClick:t[2]||(t[2]=e=>s.half="16")}," 16 al 30 ",2)])])):(0,y.Q3)("",!0)]),(0,y.Lk)("div",Hs,[(0,y.Lk)("button",{type:"button",class:"btn btn-secondary btn-lg",disabled:!s.selectedMonth,onClick:t[3]||(t[3]=(...e)=>n.createPayroll&&n.createPayroll(...e))}," Crear y pagar planilla ",8,Gs)])])),(0,y.Lk)("table",an,[t[7]||(t[7]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Fecha de pago"),(0,y.Lk)("th",null,"Total salarios brutos"),(0,y.Lk)("th",null,"Total deducciones empleador"),(0,y.Lk)("th",null,"Total deducciones empleado"),(0,y.Lk)("th",null,"Total beneficios"),(0,y.Lk)("th",null,"Total salarios netos"),(0,y.Lk)("th",null,"Total costo planilla")])],-1)),(0,y.Lk)("tbody",null,[s.payroll?((0,y.uX)(),(0,y.CE)("tr",on,[(0,y.Lk)("td",null,(0,h.v_)(n.formatDate(s.payroll.payDate)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(s.payroll.totalGrossSalaries)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(s.payroll.totalEmployerDeductions)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(s.payroll.totalEmployeeDeductions)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(s.payroll.totalBenefits)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(s.payroll.totalNetEmployee)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(s.payroll.totalEmployerCost)),1)])):(0,y.Q3)("",!0)])])]),(0,y.Lk)("div",ln,[s.showToast?((0,y.uX)(),(0,y.CE)("div",{key:0,class:(0,h.C4)(["toast show align-items-center text-white border-0",s.toastType]),role:"alert","aria-live":"assertive","aria-atomic":"true"},[(0,y.Lk)("div",sn,[(0,y.Lk)("div",nn,(0,h.v_)(s.toastMessage),1),(0,y.Lk)("button",{type:"button",class:"btn-close btn-close-white me-2 m-auto",onClick:t[4]||(t[4]=e=>s.showToast=!1)})])],2)):(0,y.Q3)("",!0)])])}var cn={name:"PayrollList",data(){return{payroll:null,paymentFrequency:null,selectedMonth:"",half:"01",dateFrom:null,dateTo:null,showToast:!1,toastMessage:"",toastType:"bg-success",toastTimeout:3e3}},methods:{getCurrentMonth(){const e=new Date,t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0");return`${t}-${a}`},getDateFrom(){return this.selectedMonth?"Mensual"===this.paymentFrequency?`${this.selectedMonth}-01`:`${this.selectedMonth}-${this.half}`:""},getDateTo(){if(!this.selectedMonth)return"";const[e,t]=this.selectedMonth.split("-").map(Number),a=new Date(e,t,0).getDate();return"Mensual"===this.paymentFrequency?`${this.selectedMonth}-${String(a).padStart(2,"0")}`:"01"===this.half?`${this.selectedMonth}-15`:`${this.selectedMonth}-${String(a).padStart(2,"0")}`},fmtCRC(e){return new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",currencyDisplay:"symbol",minimumFractionDigits:2,maximumFractionDigits:2}).format(Number(e??0))},createPayroll(){this.dateFrom=this.getDateFrom(),this.dateTo=this.getDateTo();var e=this;const t={companyId:this.$session.user?.companyUniqueId,personId:Number(this.$session.user?.personId),dateFrom:this.dateFrom,dateTo:this.dateTo};ye.post("/api/Payroll",null,{params:t}).then(t=>{this.payroll=t.data,e.toastMessage="Planilla creada y pagada correctamente",e.toastType="bg-success",e.showToast=!0,setTimeout(function(){e.showToast=!1},e.toastTimeout)}).catch(function(t){const a=t&&t.response&&t.response.data?t.response.data:null,o="string"===typeof a?a:a&&(a.message||a.detail)||"Error inesperado al crear la planilla";e.toastMessage=o,e.toastType="bg-danger",e.showToast=!0,setTimeout(function(){e.showToast=!1},e.toastTimeout)})},getCompanyInfo(){const e=this.$session.user?.companyUniqueId;ye.get("/api/Company/getCompanyByID",{params:{companyId:e}}).then(e=>{this.paymentFrequency=e.data?.paymentFrequency||null})},formatDate(e){if(!e)return"";const t=new Date(e);return isNaN(t)?"":new Intl.DateTimeFormat("es-CR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)}},mounted(){"Empleador"===this.$session.user?.typeUser&&(this.selectedMonth||(this.selectedMonth=this.getCurrentMonth()),this.getCompanyInfo())}};const dn=(0,I.A)(cn,[["render",rn]]);var un=dn;const pn={class:"table-responsive pt-3 pb-3 ps-4 pe-4",style:{"background-color":"white","border-radius":"10px"}},mn={class:"table"},yn=["innerHTML"],hn={key:1},vn={key:0,class:"spacer"},bn=["colspan"];function fn(e,t,a,o,l,s){return(0,y.uX)(),(0,y.CE)("div",pn,[(0,y.Lk)("table",mn,[(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[t[1]||(t[1]=(0,y.Lk)("th",{scope:"col"},"#",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(a.tableHeader,(e,t)=>((0,y.uX)(),(0,y.CE)("th",{key:t,scope:"col"},(0,h.v_)(e.label),1))),128))])]),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(a.tableElements,(e,o)=>((0,y.uX)(),(0,y.CE)(y.FK,{key:o},[(0,y.Lk)("tr",null,[(0,y.Lk)("td",null,(0,h.v_)(o+1),1),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(a.tableHeader,(a,o)=>((0,y.uX)(),(0,y.CE)("td",{key:o},["action"===a.key?((0,y.uX)(),(0,y.CE)("span",{key:0,innerHTML:e[a.key],onClick:t[0]||(t[0]=(...e)=>s.handleActionClick&&s.handleActionClick(...e))},null,8,yn)):((0,y.uX)(),(0,y.CE)("span",hn,(0,h.v_)(e[a.key]),1))]))),128))]),o<a.tableElements.length-1?((0,y.uX)(),(0,y.CE)("tr",vn,[(0,y.Lk)("td",{colspan:a.tableHeader.length+1},null,8,bn)])):(0,y.Q3)("",!0)],64))),128))])])])}var kn={name:"ReactiveObjectTable",props:{tableHeader:{type:Array,required:!0},tableElements:{type:Array,required:!0}},emits:["action"],methods:{handleActionClick(e){const t=e.target.closest("button[data-id]");if(!t)return;const a=t.dataset.id,o=t.dataset.action||null;a&&o&&this.$emit("action",{id:a,action:o})}}};const gn=(0,I.A)(kn,[["render",fn],["__scopeId","data-v-0287e26f"]]);var Ln=gn;const Cn={class:"d-flex justify-content-center p-5 ms-5 me-5"},En={class:"w-100 ps-5 pe-5 ms-4 me-4"},xn={class:"d-flex mb-4 gap-3"},Dn={key:0,class:"form-group"},wn=["value"],In={class:"form-group"};var Pn={__name:"ViewPayrollElement",setup(e){const t=(0,s.rd)(),a=v(),{user:l}=m();var n=(0,u.KR)(!1),i=(0,u.KR)([]),r=(0,u.KR)(""),c=(0,u.KR)("Todos");const d=(0,y.EW)(()=>"Todos"===c.value?b.value:b.value.filter(e=>e.type===c.value)),p=[{label:"Elemento",key:"elementName"},{label:"Monto/Porcentaje",key:"calculationType"},{label:"Valor",key:"calculationValue"},{label:"Tipo",key:"type"},{label:"Pagado por",key:"paidBy"},{label:"Estado",key:"status"}];var b=(0,u.KR)([]);function f(e){if("Administrador"===e)k();else{const t=l.companyUniqueId;g(t,e)}}async function k(){n.value=!0,await ye.get("/api/Company/GetAllCompaniesSummary").then(e=>{i.value=e.data}).catch()}async function g(e,t){b.value=[],await ye.get("/api/PayrollElement/GetPayRollElements",{params:{idCompany:e}}).then(e=>{b.value=e.data.map(e=>({...e,paidBy:"API"===e.calculationType?"Empleador":e.paidBy,type:"Empleador"===e.paidBy?"Beneficio":"Deducción",..."Empleador"===t&&{action:`<button class="btn btn-sm btn-success me-1" data-id="${e.idElement}" data-action="edit">Editar</button>\n                       <button class="btn btn-sm btn-danger" data-id="${e.idElement}" data-action="delete">Eliminar</button>`}})),"Empleador"===t&&p.push({label:"Acción",key:"action"})}).catch(e=>{e.response?a.show("Error: "+e.response.data,"warning"):a.show("Error de red "+e,"warning")})}function L(e){t.push({name:"EditarBeneficioODeduccion",params:{PEId:e}})}async function C(e){try{await ye.delete(`/api/PayrollElement/${e}`),a.show("Elemento eliminado","success"),b.value=b.value.filter(t=>t.idElement!=e)}catch(t){a.show("Error al eliminar elemento"+t,"warning")}}function E({id:e,action:t}){"edit"===t?L(e):"delete"===t&&C(e)}return(0,y.sV)(()=>{const e=l.typeUser;f(e)}),(e,t)=>((0,y.uX)(),(0,y.CE)("div",Cn,[(0,y.Lk)("div",En,[t[7]||(t[7]=(0,y.Lk)("h3",{class:"display-5 text-center mb-4"},"Elementos de planilla",-1)),(0,y.Lk)("div",xn,[(0,u.R1)(n)?((0,y.uX)(),(0,y.CE)("div",Dn,[t[4]||(t[4]=(0,y.Lk)("label",{for:"companyFilter"},"Empresa:",-1)),(0,y.bo)((0,y.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>(0,u.i9)(r)?r.value=e:r=e),class:"form-select",id:"companyFilter",onChange:t[1]||(t[1]=e=>g((0,u.R1)(r)))},[t[3]||(t[3]=(0,y.Lk)("option",{value:"",disabled:""},"Seleccione una empresa",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)((0,u.R1)(i),e=>((0,y.uX)(),(0,y.CE)("option",{key:e.companyUniqueId,value:e.companyUniqueId},(0,h.v_)(e.companyName),9,wn))),128))],544),[[o.u1,(0,u.R1)(r)]])])):(0,y.Q3)("",!0),(0,y.Lk)("div",In,[t[6]||(t[6]=(0,y.Lk)("label",{for:"typeElementFilter"},"Tipo de elemento:",-1)),(0,y.bo)((0,y.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>(0,u.i9)(c)?c.value=e:c=e),class:"form-select",id:"typeElementFilter"},[...t[5]||(t[5]=[(0,y.Lk)("option",{value:"",disabled:""},"Seleccione un elemento",-1),(0,y.Lk)("option",{value:"Todos"},"Todos",-1),(0,y.Lk)("option",{value:"Beneficio"},"Beneficio",-1),(0,y.Lk)("option",{value:"Deducción"},"Deducción",-1)])],512),[[o.u1,(0,u.R1)(c)]])])]),(0,y.bF)(Ln,{tableHeader:p,tableElements:d.value,onAction:E},null,8,["tableElements"])])]))}};const Fn=Pn;var Tn=Fn;const _n={class:"d-flex flex-column"},Sn={class:"text-center"},Un={class:"container py-4 flex-fill d-flex justify-content-center"},An={class:"mb-3"},Nn=["maxlength"],Xn={class:"invalid-feedback"},Vn={class:"mb-3 col-xl-6 col-sm-12"},qn={key:0,class:"mb-3 col-xl-6 col-sm-12"},Rn={key:1,class:"mb-3 col-xl-6 col-sm-12"},Bn={class:"input-group"},$n={key:2,class:"mb-3 col-xl-6 col-sm-12"},Mn={class:"input-group"},Kn={key:3,class:"mb-3 col-xl-6 col-sm-12"},Qn={key:4,class:"mb-3 col-xl-6 col-sm-12"},On={class:"mb-3 pair-btn"};function Jn(e,t,a,l,s,n){const i=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)("div",_n,[(0,y.Lk)("h1",Sn,"Editar - "+(0,h.v_)(s.payrollElement.elementType),1),(0,y.Lk)("div",Un,[(0,y.Lk)("form",{ref:"elementForm",onSubmit:t[7]||(t[7]=(0,o.D$)((...e)=>n.updatePayrrollElement&&n.updatePayrrollElement(...e),["prevent"])),class:"row g-3 needs-validation",novalidate:"",style:{width:"800px"}},[(0,y.Lk)("div",An,[t[8]||(t[8]=(0,y.Lk)("label",{for:"elementName",class:"form-label required"},"Nombre",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"elementName",required:"",maxlength:s.maxNameLength,"onUpdate:modelValue":t[0]||(t[0]=e=>s.payrollElement.elementName=e)},null,8,Nn),[[o.Jo,s.payrollElement.elementName]]),(0,y.Lk)("div",Xn," Ingrese el nombre, máximo "+(0,h.v_)(s.maxNameLength)+" caracteres. ",1)]),(0,y.Lk)("div",Vn,[t[9]||(t[9]=(0,y.Lk)("label",{for:"calculationType",class:"form-label"},"Tipo de cálculo",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled",id:"calculationType","onUpdate:modelValue":t[1]||(t[1]=e=>s.payrollElement.calculationType=e),disabled:""},null,512),[[o.Jo,s.payrollElement.calculationType]])]),"API"===s.payrollElement.calculationType?((0,y.uX)(),(0,y.CE)("div",qn,[t[10]||(t[10]=(0,y.Lk)("label",{class:"form-label"},"API",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled","onUpdate:modelValue":t[2]||(t[2]=e=>s.payrollElement.calculationValue=e),disabled:""},null,512),[[o.Jo,s.payrollElement.calculationValue]])])):"Porcentaje"===s.payrollElement.calculationType?((0,y.uX)(),(0,y.CE)("div",Rn,[t[12]||(t[12]=(0,y.Lk)("label",{class:"form-label"},"Valor",-1)),(0,y.Lk)("div",Bn,[(0,y.bo)((0,y.Lk)("input",{type:"number",class:"form-control disabled","onUpdate:modelValue":t[3]||(t[3]=e=>s.payrollElement.calculationValue=e),disabled:""},null,512),[[o.Jo,s.payrollElement.calculationValue]]),t[11]||(t[11]=(0,y.Lk)("span",{class:"input-group-text"},"%",-1))])])):((0,y.uX)(),(0,y.CE)("div",$n,[t[14]||(t[14]=(0,y.Lk)("label",{class:"form-label"},"Valor",-1)),(0,y.Lk)("div",Mn,[t[13]||(t[13]=(0,y.Lk)("span",{class:"input-group-text"},"₡",-1)),(0,y.bo)((0,y.Lk)("input",{type:"number",class:"form-control disabled","onUpdate:modelValue":t[4]||(t[4]=e=>s.payrollElement.calculationValue=e),disabled:""},null,512),[[o.Jo,s.payrollElement.calculationValue]])])])),"Monto"===s.payrollElement.calculationType||"Porcentaje"===s.payrollElement.calculationType?((0,y.uX)(),(0,y.CE)("div",Kn,[t[15]||(t[15]=(0,y.Lk)("label",{for:"PaidBy",class:"form-label"},"Pagado por",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled",id:"PaidBy","onUpdate:modelValue":t[5]||(t[5]=e=>s.payrollElement.paidBy=e),disabled:""},null,512),[[o.Jo,s.payrollElement.paidBy]])])):(0,y.Q3)("",!0),"Monto"===s.payrollElement.calculationType||"Porcentaje"===s.payrollElement.calculationType?((0,y.uX)(),(0,y.CE)("div",Qn,[t[16]||(t[16]=(0,y.Lk)("label",{for:"elementType",class:"form-label"},"Tipo de elemento",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled",id:"elementType",disabled:"","onUpdate:modelValue":t[6]||(t[6]=e=>s.payrollElement.elementType=e)},null,512),[[o.Jo,s.payrollElement.elementType]])])):(0,y.Q3)("",!0),(0,y.Lk)("div",On,[(0,y.bF)(i,{text:"Cancelar",onClick:n.goBack},null,8,["onClick"]),(0,y.bF)(i,{text:"Guardar",onClick:n.updatePayrrollElement},null,8,["onClick"])])],544)])])}var zn={components:{LinkButton:ke},data(){return{payrollElement:{elementId:0,elementName:"",calculationType:"",calculationValue:"",paidBy:"",elementType:"",companyId:""},maxNameLength:40}},methods:{initBootstrapValidation(){const e=this.$refs.elementForm;e&&e.addEventListener("submit",t=>{e.checkValidity()?t.preventDefault():(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")})},setPayrollElementData(){const e=(0,s.lq)(),t=e.params.PEId;ye.get(`/api/PayrollElement/${t}`).then(e=>{this.payrollElement=e.data,this.payrollElement.elementType="Empleador"===this.payrollElement.paidBy?"Beneficio":"Deducción",console.log(this.payrollElement)}).catch(e=>{const t=v();t.show("Error al mostrar la información. Detalle: "+e.response?.data?.message||0,"warning"),window.history.back()})},goBack(){window.history.back()},updatePayrrollElement(){ye.post("/api/PayrollElement/updPayrollElement",this.payrollElement).then(e=>{const t=v();t.show(e.data.message,"success")}).catch(e=>{const t=v();t.show("Error al actualizar el elemento. Detalle: "+e.response?.data?.message||0,"warning")})}},mounted(){"Empleador"===this.$session.user?.typeUser&&(this.initBootstrapValidation(),this.setPayrollElementData())}};const jn=(0,I.A)(zn,[["render",Jn],["__scopeId","data-v-e7244cca"]]);var Wn=jn;const Hn={class:"d-flex flex-column"},Gn={class:"container py-4 flex-fill d-flex justify-content-center"},Yn={class:"mb-3"},Zn=["maxlength"],ei={class:"invalid-feedback"},ti={class:"mb-3 col-xl-6 col-sm-12"},ai={key:0,class:"mb-3 col-xl-6 col-sm-12"},oi={key:1,class:"mb-3 col-xl-6 col-sm-12"},li={class:"input-group"},si=["max"],ni={class:"invalid-feedback"},ii={key:2,class:"mb-3 col-xl-6 col-sm-12"},ri={class:"input-group"},ci=["disabled"],di={key:3,class:"mb-3 col-xl-6 col-sm-12"},ui={key:4,class:"mb-3 col-xl-6 col-sm-12"},pi={class:"toast-container position-fixed top-0 end-0 p-3"},mi={class:"d-flex"},yi={class:"toast-body"};function hi(e,t,a,l,s,n){return(0,y.uX)(),(0,y.CE)("div",Hn,[t[29]||(t[29]=(0,y.Lk)("h1",{class:"text-center"},"Crear beneficios y deducciones",-1)),(0,y.Lk)("div",Gn,[(0,y.Lk)("form",{ref:"elementForm",onSubmit:t[10]||(t[10]=(0,o.D$)((...e)=>n.saveElement&&n.saveElement(...e),["prevent"])),class:"row g-3 needs-validation",novalidate:"",style:{width:"800px"}},[(0,y.Lk)("div",Yn,[t[12]||(t[12]=(0,y.Lk)("label",{for:"elementName",class:"form-label required"},"Nombre",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"elementName",required:"",maxlength:s.maxNameLength,"onUpdate:modelValue":t[0]||(t[0]=e=>s.name=e)},null,8,Zn),[[o.Jo,s.name]]),(0,y.Lk)("div",ei," Ingrese el nombre, máximo "+(0,h.v_)(s.maxNameLength)+" caracteres. ",1)]),(0,y.Lk)("div",ti,[t[14]||(t[14]=(0,y.Lk)("label",{for:"calculationType",class:"form-label required"},"Tipo de cálculo",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"calculationType",required:"","onUpdate:modelValue":t[1]||(t[1]=e=>s.calculationType=e),onChange:t[2]||(t[2]=(...e)=>n.cleanValue&&n.cleanValue(...e))},[...t[13]||(t[13]=[(0,y.Lk)("option",{value:"Monto"},"Monto",-1),(0,y.Lk)("option",{value:"Porcentaje"},"Porcentaje",-1),(0,y.Lk)("option",{value:"API"},"API",-1)])],544),[[o.u1,s.calculationType]]),t[15]||(t[15]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione el tipo de cálculo",-1))]),"API"===s.calculationType?((0,y.uX)(),(0,y.CE)("div",ai,[t[17]||(t[17]=(0,y.Lk)("label",{class:"form-label required"},"API",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=e=>s.calculationValue=e),required:""},[...t[16]||(t[16]=[(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un API",-1),(0,y.Lk)("option",{value:"1"},"Asociación Solidarista",-1),(0,y.Lk)("option",{value:"2"},"Seguro Privado",-1),(0,y.Lk)("option",{value:"3"},"Pensiones voluntarias",-1)])],512),[[o.u1,s.calculationValue]]),t[18]||(t[18]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione un API",-1))])):"Porcentaje"===s.calculationType?((0,y.uX)(),(0,y.CE)("div",oi,[t[20]||(t[20]=(0,y.Lk)("label",{class:"form-label required"},"Valor",-1)),(0,y.Lk)("div",li,[(0,y.bo)((0,y.Lk)("input",{type:"number",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=e=>s.calculationValue=e),min:"0",max:s.maxPercentaje,step:"0.01",required:"",onInput:t[5]||(t[5]=(...t)=>e.clampPercent&&e.clampPercent(...t))},null,40,si),[[o.Jo,s.calculationValue]]),t[19]||(t[19]=(0,y.Lk)("span",{class:"input-group-text"},"%",-1)),(0,y.Lk)("div",ni,"Ingrese el porcentaje entre 0 y "+(0,h.v_)(s.maxPercentaje),1)])])):((0,y.uX)(),(0,y.CE)("div",ii,[t[23]||(t[23]=(0,y.Lk)("label",{class:"form-label required"},"Valor",-1)),(0,y.Lk)("div",ri,[t[21]||(t[21]=(0,y.Lk)("span",{class:"input-group-text"},"₡",-1)),(0,y.bo)((0,y.Lk)("input",{type:"number",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=e=>s.calculationValue=e),min:"0",step:"0.01",required:"",disabled:!s.calculationType},null,8,ci),[[o.Jo,s.calculationValue]]),t[22]||(t[22]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el monto con un máximo de 2 decimales",-1))])])),"Monto"===s.calculationType||"Porcentaje"===s.calculationType?((0,y.uX)(),(0,y.CE)("div",di,[t[25]||(t[25]=(0,y.Lk)("label",{for:"PaidBy",class:"form-label required"},"Pagado por",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"PaidBy",required:"","onUpdate:modelValue":t[7]||(t[7]=e=>s.paidBy=e),onChange:t[8]||(t[8]=(...e)=>n.addElementType&&n.addElementType(...e))},[...t[24]||(t[24]=[(0,y.Lk)("option",{value:"Empleado"},"Empleado",-1),(0,y.Lk)("option",{value:"Empleador"},"Empleador",-1)])],544),[[o.u1,s.paidBy]]),t[26]||(t[26]=(0,y.Lk)("div",{class:"invalid-feedback"},"Seleccione el responsable del pago.",-1))])):(0,y.Q3)("",!0),"Monto"===s.calculationType||"Porcentaje"===s.calculationType?((0,y.uX)(),(0,y.CE)("div",ui,[t[27]||(t[27]=(0,y.Lk)("label",{for:"elementType",class:"form-label"},"Tipo de elemento",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"elementType",disabled:"",readonly:"","onUpdate:modelValue":t[9]||(t[9]=e=>s.elementType=e)},null,512),[[o.Jo,s.elementType]])])):(0,y.Q3)("",!0),t[28]||(t[28]=(0,y.Lk)("div",{class:"mb-3"},[(0,y.Lk)("button",{class:"btn btn-custom w-100 mt-2",type:"submit"},"Crear elemento")],-1))],544)]),(0,y.Lk)("div",pi,[s.showToast?((0,y.uX)(),(0,y.CE)("div",{key:0,class:(0,h.C4)(["toast show align-items-center text-white border-0",s.toastType]),role:"alert","aria-live":"assertive","aria-atomic":"true"},[(0,y.Lk)("div",mi,[(0,y.Lk)("div",yi,(0,h.v_)(s.toastMessage),1),(0,y.Lk)("button",{type:"button",class:"btn-close btn-close-white me-2 m-auto",onClick:t[11]||(t[11]=e=>s.showToast=!1)})])],2)):(0,y.Q3)("",!0)])])}var vi={data(){return{name:"",paidBy:"",elementType:"",calculationType:"",calculationValue:"",companyId:"",userId:"",maxNameLength:40,maxPercentaje:100,showToast:!1,toastMessage:"",toastType:"bg-success",toastTimeout:3e3}},methods:{initBootstrapValidation(){const e=this.$refs.elementForm;e&&e.addEventListener("submit",t=>{e.checkValidity()?t.preventDefault():(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")})},addElementType(){this.elementType="Empleado"===this.paidBy?"Deducción":"Beneficio"},cleanValue(){this.calculationValue=""},saveElement(){var e=this,t=this.$refs.elementForm;t.checkValidity()&&ye.post("/api/PayrollElement",{elementName:this.name,paidBy:"API"===this.calculationType?"Empleador":this.paidBy,calculationType:this.calculationType,calculationValue:Number(this.calculationValue||0),companyId:Number(this.$session.user?.companyUniqueId),userId:Number(this.$session.user?.userId),status:"Active"}).then(function(){e.toastMessage="Elemento creado correctamente",e.toastType="bg-success",e.showToast=!0,setTimeout(function(){e.showToast=!1,window.location.href="/app/Home"},e.toastTimeout)}).catch(function(t){var a=t&&t.response&&t.response.data?t.response.data:"Error inesperado al crear el elemento de planilla";e.toastMessage=a,e.toastType="bg-danger",e.showToast=!0,setTimeout(function(){e.showToast=!1},e.toastTimeout)})}},mounted(){"Empleador"===this.$session.user?.typeUser&&this.initBootstrapValidation()}};const bi=(0,I.A)(vi,[["render",hi],["__scopeId","data-v-612a921b"]]);var fi=bi;const ki={key:0,class:"d-flex flex-column text-center"},gi={key:1,class:"d-flex flex-column"},Li={class:"container mt-5"},Ci={class:"mb-4"},Ei=["value"],xi={class:"container mt-5"},Di={key:0,class:"container mt-5"},wi={class:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},Ii=["onClick"],Pi={style:{"text-align":"center",width:"50px",height:"50px",border:"1px solid #000","font-weight":"bold","vertical-align":"middle"},colspan:"6"},Fi={key:2,class:"container mt-5"},Ti={class:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},_i=["onClick"],Si={style:{"text-align":"center",width:"50px",height:"50px",border:"1px solid #000","font-weight":"bold","vertical-align":"middle"},colspan:"7"};function Ui(e,t,a,l,s,n){return(0,y.uX)(),(0,y.CE)(y.FK,null,["Empleado"===e.$session.user?.typeUser||"Administrador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",ki,[...t[2]||(t[2]=[(0,y.Lk)("h3",null,"Acceso restringido",-1),(0,y.Lk)("p",null,"Esta página no está disponible",-1)])])):((0,y.uX)(),(0,y.CE)("div",gi,[(0,y.Lk)("div",Li,[(0,y.Lk)("div",Ci,[t[4]||(t[4]=(0,y.Lk)("label",{for:"employeeSelect"},"Seleccione un empleado:",-1)),(0,y.bo)((0,y.Lk)("select",{id:"employeeSelect","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedEmployee.id=e),onChange:t[1]||(t[1]=(...e)=>n.updateSelectedEmployeeInformation&&n.updateSelectedEmployeeInformation(...e)),class:"form-control"},[t[3]||(t[3]=(0,y.Lk)("option",{disabled:"",value:""},"Seleccione un empleado",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.employees,(e,t)=>((0,y.uX)(),(0,y.CE)("option",{key:t,value:e.idUser},(0,h.v_)("Id Usuario: "+e.idUser+" ")+" "+(0,h.v_)(e.name1)+" "+(0,h.v_)(e.name2)+" "+(0,h.v_)(e.surname1)+" "+(0,h.v_)(e.surname2),9,Ei))),128))],544),[[o.u1,s.selectedEmployee.id]])])]),(0,y.Lk)("div",xi,[s.selectedEmployee.id?((0,y.uX)(),(0,y.CE)("div",Di,[t[6]||(t[6]=(0,y.Lk)("h1",{class:"display-6 text-center"},"Deducciones Disponibles",-1)),t[7]||(t[7]=(0,y.Lk)("div",{class:"row justify-content-end"},[(0,y.Lk)("div",{class:"col-2"})],-1)),(0,y.Lk)("table",wi,[t[5]||(t[5]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Nombre"),(0,y.Lk)("th",null,"Tipo de Cálculo"),(0,y.Lk)("th",null,"Valor"),(0,y.Lk)("th",null,"Acción")])],-1)),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(n.filteredDeductions,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t},[(0,y.Lk)("td",null,(0,h.v_)(e.elementName),1),(0,y.Lk)("td",null,(0,h.v_)(e.calculationType),1),(0,y.Lk)("td",null,(0,h.v_)(e.calculationValue),1),(0,y.Lk)("td",null,[(0,y.Lk)("button",{class:"btn btn-secondary btn-sm",onClick:t=>n.addAppliedElement(e)}," Seleccionar ",8,Ii)])]))),128)),(0,y.Lk)("tr",null,[(0,y.Lk)("td",Pi," Total de Deducciones: "+(0,h.v_)(n.filteredDeductions.length),1)])])])])):(0,y.Q3)("",!0)])])),s.selectedEmployee.id?((0,y.uX)(),(0,y.CE)("div",Fi,[t[9]||(t[9]=(0,y.Lk)("h1",{class:"display-4 text-center"},"Deducciones Aplicadas",-1)),t[10]||(t[10]=(0,y.Lk)("div",{class:"row justify-content-end"},[(0,y.Lk)("div",{class:"col-2"})],-1)),(0,y.Lk)("table",Ti,[t[8]||(t[8]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Nombre"),(0,y.Lk)("th",null,"Fecha Inicio"),(0,y.Lk)("th",null,"Fecha Fin"),(0,y.Lk)("th",null,"Estado"),(0,y.Lk)("th",null,"Tipo Plan"),(0,y.Lk)("th",null,"Total Dependientes"),(0,y.Lk)("th",null,"Acción")])],-1)),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(n.filteredAppliedElements,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t},[(0,y.Lk)("td",null,(0,h.v_)(e.elementName),1),(0,y.Lk)("td",null,(0,h.v_)(n.formatDate(e.startDate)),1),(0,y.Lk)("td",null,(0,h.v_)(n.formatDate(e.endDate)),1),(0,y.Lk)("td",null,(0,h.v_)(e.status),1),(0,y.Lk)("td",null,(0,h.v_)(e.planType),1),(0,y.Lk)("td",null,(0,h.v_)(e.amountDependents),1),(0,y.Lk)("td",null,[(0,y.Lk)("button",{class:"btn btn-danger btn-sm",onClick:t=>n.deactivateAppliedElement(e.appliedElementId,e.status)}," Desactivar ",8,_i)])]))),128)),(0,y.Lk)("tr",null,[(0,y.Lk)("td",Si," Total Deducciones Activas: "+(0,h.v_)(this.getTotalActiveAppliedElements()),1)])])])])):(0,y.Q3)("",!0)],64)}var Ai={name:"DeductionsList",setup(){const e=v();return{alert:e}},data(){return{deductions:[],appliedElements:[],companyId:null,employees:[],user:null,selectedEmployee:{id:null,name:""}}},computed:{filteredDeductions(){return this.deductions.filter(e=>"Empleado"===e.paidBy)},deductionElementIds(){return new Set(this.filteredDeductions.map(e=>e.idElement))},filteredAppliedElements(){return this.appliedElements.filter(e=>this.isActiveOrEndingThisMonth(e))}},methods:{getEmployees(){const e=r();if(!e)return void this.alert.show("El usuario actual no está disponible.","warning");this.user=e;const t=e.companyUniqueId;ye.get(`/api/PersonUser/getEmployeesByCompanyId?companyId=${t}`).then(e=>{this.employees=e.data}).catch(e=>{const t=404===e?.response?.status?"No se encontraron empleados para la empresa.":"Error al obtener los empleados.";this.alert.show(t,"warning")})},async getCompanyIdByUserId(){try{const e=await ye.get(`/api/Company/getCompanyIdByUserId?userId=${this.user.userId}`);this.companyId=e.data,this.getDeductions()}catch(e){const t=404===e?.response?.status?"No se encontró la empresa del usuario.":"Error al obtener la empresa del usuario.";this.alert.show(t,"warning")}},getDeductions(){this.companyId?ye.get("/api/PayrollElement/GetPayRollElements",{params:{idCompany:this.companyId}}).then(e=>{this.deductions=e.data}).catch(()=>{this.alert.show("Error al obtener las deducciones.","warning")}):this.alert.show("Aún no se ha definido la empresa del usuario.","warning")},getAppliedElements(){ye.get(`/api/AppliedElement/getAppliedElements?employeeId=${this.selectedEmployee.id}`).then(e=>{this.appliedElements=e.data}).catch(()=>{this.alert.show("Error al obtener las deducciones aplicadas.","warning")})},formatDate(e){if(null==e)return"-";const t=new Date(e);return t.toLocaleDateString()},getTotalActiveAppliedElements(){return this.filteredAppliedElements.filter(e=>"Activo"===e.status).length},addAppliedElement(e){if(!this.user||!this.user.userId)return void this.alert.show("El usuario actual no está definido.","warning");if(!e.idElement)return void this.alert.show("La deducción no tiene un identificador válido.","warning");if(!this.selectedEmployee||!this.selectedEmployee.id)return void this.alert.show("Por favor, seleccione un empleado antes de seleccionar una deducción.","warning");const t=this.appliedElements.some(t=>t.elementName==e.elementName&&"Activo"==t.status);t?this.alert.show("Esta deducción ya está seleccionada.","warning"):ye.post("/api/AppliedElement/addAppliedElement",{UserId:this.selectedEmployee.id,ElementId:e.idElement,ElementType:"Deduccion",AmountDependents:null,PlanType:null}).then(()=>{this.alert.show("Deducción agregada exitosamente.","warning"),this.getAppliedElements()}).catch(()=>{this.alert.show("Error al agregar la deducción.","warning")})},async deactivateAppliedElement(e,t){if("Inactivo"!=t)try{await ye.post("/api/AppliedElement/deactivateAppliedElement",{appliedElementId:e}),this.alert.show("Deducción desactivada correctamente.","warning"),this.getAppliedElements()}catch{this.alert.show("Error al desactivar la deducción.","warning")}else this.alert.show("El elemento seleccionado ya está inactivo.","warning")},isActiveOrEndingThisMonth(e){if("Deduccion"!==e.elementType)return!1;if("Activo"===e.status)return!0;if("Inactivo"!==e.status)return!1;if(!e.endDate)return!1;const t=new Date(e.endDate);if(Number.isNaN(t.getTime()))return!1;const a=new Date,o=t.getFullYear()===a.getFullYear(),l=t.getMonth()===a.getMonth();return o&&l},updateSelectedEmployeeInformation(){const e=this.employees.find(e=>e.idUser===this.selectedEmployee.id);e&&(this.selectedEmployee.name=e.name1+" "+(e.name2||"")+" "+e.surname1+" "+(e.surname2||""),this.getAppliedElements())}},created(){this.user=r(),this.getCompanyIdByUserId(),this.getEmployees()}};const Ni=(0,I.A)(Ai,[["render",Ui]]);var Xi=Ni;const Vi={key:0,class:"d-flex flex-column text-center"},qi={key:1,class:"d-flex flex-column"},Ri={class:"container mt-5"},Bi={class:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},$i=["onClick"],Mi={style:{"text-align":"center",width:"50px",height:"50px",border:"1px solid #000","font-weight":"bold","vertical-align":"middle"}},Ki={style:{"text-align":"center",width:"50px",height:"50px",border:"1px solid #000","font-weight":"bold","vertical-align":"middle"}},Qi={class:"container mt-5"},Oi={class:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth"},Ji=["onClick"],zi={style:{"text-align":"center",width:"50px",height:"50px",border:"1px solid #000","font-weight":"bold","vertical-align":"middle"}},ji={style:{"text-align":"center",width:"50px",height:"50px",border:"1px solid #000","font-weight":"bold","vertical-align":"middle"}},Wi={key:0,class:"modal fade show d-block",tabindex:"-1",style:{"background-color":"rgba(0, 0, 0, 0.4)"}},Hi={class:"modal-dialog"},Gi={class:"modal-content"},Yi={class:"modal-header"},Zi={class:"modal-body"},er={class:"mb-3"},tr={key:0},ar={key:1},or={class:"modal-footer"},lr={key:2,class:"d-flex flex-column text-center"};function sr(e,t,a,l,s,n){return"Administrador"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",Vi,[...t[5]||(t[5]=[(0,y.Lk)("h3",null,"Acceso restringido",-1),(0,y.Lk)("p",null,"Esta página no está disponible",-1)])])):"Empleado"===e.$session.user?.typeUser?((0,y.uX)(),(0,y.CE)("div",qi,[(0,y.Lk)("div",Ri,[t[7]||(t[7]=(0,y.Lk)("h1",{class:"display-4 text-center"},"Beneficios Disponibles",-1)),t[8]||(t[8]=(0,y.Lk)("div",{class:"row justify-content-end"},[(0,y.Lk)("div",{class:"col-2"})],-1)),(0,y.Lk)("table",Bi,[t[6]||(t[6]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Nombre"),(0,y.Lk)("th",null,"Tipo de Cálculo"),(0,y.Lk)("th",null,"Valor"),(0,y.Lk)("th",null,"Acción")])],-1)),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(n.filteredBenefits,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t},[(0,y.Lk)("td",null,(0,h.v_)(e.elementName),1),(0,y.Lk)("td",null,(0,h.v_)(e.calculationType),1),(0,y.Lk)("td",null,(0,h.v_)(e.calculationValue),1),(0,y.Lk)("td",null,[(0,y.Lk)("button",{class:"btn btn-secondary btn-sm",onClick:t=>n.addAppliedElement(e)}," Seleccionar ",8,$i)])]))),128)),(0,y.Lk)("tr",null,[(0,y.Lk)("td",Mi," Total de Beneficios: "+(0,h.v_)(n.filteredBenefits.length),1),(0,y.Lk)("td",Ki," Máx. beneficios ofrecidos por la empresa: "+(0,h.v_)(this.maxCompanyBenefits),1)])])])]),(0,y.Lk)("div",Qi,[t[10]||(t[10]=(0,y.Lk)("h1",{class:"display-4 text-center"},"Beneficios Aplicados",-1)),t[11]||(t[11]=(0,y.Lk)("div",{class:"row justify-content-end"},[(0,y.Lk)("div",{class:"col-2"})],-1)),(0,y.Lk)("table",Oi,[t[9]||(t[9]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Nombre"),(0,y.Lk)("th",null,"Fecha Inicio"),(0,y.Lk)("th",null,"Fecha Fin"),(0,y.Lk)("th",null,"Estado"),(0,y.Lk)("th",null,"Tipo Plan"),(0,y.Lk)("th",null,"Total Dependientes"),(0,y.Lk)("th",null,"Acción")])],-1)),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(this.filterAppliedElements,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t},[(0,y.Lk)("td",null,(0,h.v_)(e.elementName),1),(0,y.Lk)("td",null,(0,h.v_)(this.formatDate(e.startDate)),1),(0,y.Lk)("td",null,(0,h.v_)(this.formatDate(e.endDate)),1),(0,y.Lk)("td",null,(0,h.v_)(e.status),1),(0,y.Lk)("td",null,(0,h.v_)(e.planType),1),(0,y.Lk)("td",null,(0,h.v_)(e.amountDependents),1),(0,y.Lk)("td",null,[(0,y.Lk)("button",{class:"btn btn-danger btn-sm",onClick:t=>this.deactivateAppliedElement(e.appliedElementId,e.status)}," Desactivar ",8,Ji)])]))),128)),(0,y.Lk)("tr",null,[(0,y.Lk)("td",zi," Beneficios activos: "+(0,h.v_)(this.getTotalActiveAppliedBenefits()),1),(0,y.Lk)("td",ji," Beneficios restantes: "+(0,h.v_)(s.maxCompanyBenefits-this.getTotalActiveAppliedBenefits()),1)])])])]),s.showExtraDataModal?((0,y.uX)(),(0,y.CE)("div",Wi,[(0,y.Lk)("div",Hi,[(0,y.Lk)("div",Gi,[(0,y.Lk)("div",Yi,[t[12]||(t[12]=(0,y.Lk)("h5",{class:"modal-title"},"Datos adicionales del beneficio",-1)),(0,y.Lk)("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...e)=>n.cancelExtraData&&n.cancelExtraData(...e))})]),(0,y.Lk)("div",Zi,[(0,y.Lk)("p",er,(0,h.v_)(s.pendingBenefit?s.pendingBenefit.elementName:""),1),"dependents"===s.extraFieldType?((0,y.uX)(),(0,y.CE)("div",tr,[t[13]||(t[13]=(0,y.Lk)("label",{class:"form-label"},"Cantidad de dependientes",-1)),(0,y.bo)((0,y.Lk)("input",{type:"number",min:"1",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempAmountDependents=e)},null,512),[[o.Jo,s.tempAmountDependents,void 0,{number:!0}]]),t[14]||(t[14]=(0,y.Lk)("small",{class:"text-muted"},"Debe ser un número entero mayor que cero.",-1))])):"plan"===s.extraFieldType?((0,y.uX)(),(0,y.CE)("div",ar,[t[16]||(t[16]=(0,y.Lk)("label",{class:"form-label"},"Tipo de plan",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=e=>s.tempPlanType=e)},[...t[15]||(t[15]=[(0,y.Lk)("option",{value:""},"Seleccione una opción",-1),(0,y.Lk)("option",{value:"A"},"Plan A",-1),(0,y.Lk)("option",{value:"B"},"Plan B",-1),(0,y.Lk)("option",{value:"C"},"Plan C",-1)])],512),[[o.u1,s.tempPlanType]]),t[17]||(t[17]=(0,y.Lk)("small",{class:"text-muted"},"Solo se permiten planes A, B o C.",-1))])):(0,y.Q3)("",!0)]),(0,y.Lk)("div",or,[(0,y.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[3]||(t[3]=(...e)=>n.cancelExtraData&&n.cancelExtraData(...e))}," Cancelar "),(0,y.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[4]||(t[4]=(...e)=>n.confirmExtraData&&n.confirmExtraData(...e))}," Confirmar ")])])])])):(0,y.Q3)("",!0)])):((0,y.uX)(),(0,y.CE)("div",lr,[...t[18]||(t[18]=[(0,y.Lk)("p",null,"Acceso no autorizado",-1)])]))}var nr={name:"BenefitsList",setup(){const e=v();return{alert:e}},data(){return{benefits:[],appliedElements:[],filteredAppliedElements:[],totalCompanyBenefits:0,maxCompanyBenefits:0,companyId:null,user:null,showExtraDataModal:!1,pendingBenefit:null,extraFieldType:null,tempAmountDependents:null,tempPlanType:""}},computed:{filteredBenefits(){return this.benefits.filter(e=>"Empleador"===e.paidBy)},benefitElementIds(){return new Set(this.filteredBenefits.map(e=>e.idElement))},filterAppliedElements(){return this.appliedElements.filter(e=>this.isActiveOrEndingThisMonth(e))}},methods:{async getCompanyIdByUserId(){try{const e=await ye.get(`/api/Company/getCompanyIdByUserId?userId=${this.user.userId}`);this.companyId=e.data,this.getBenefits(),this.getCompanyTotalBenefitsElements()}catch(e){const t=404===e?.response?.status,a=t?"No se encontró la empresa del usuario.":"Error al obtener la empresa del usuario.";this.alert.show(a,"warning")}},getBenefits(){this.companyId?ye.get("/api/PayrollElement/GetPayRollElements",{params:{idCompany:this.companyId}}).then(e=>{this.benefits=e.data}).catch(()=>{this.alert.show("Error al obtener los beneficios.","warning")}):this.alert.show("Aún no se ha definido la empresa del usuario.","warning")},getCompanyTotalBenefitsElements(){ye.get(`/api/Company/getCompanyTotalBenefitsByCompanyId?CompanyId=${this.companyId}`).then(e=>{this.maxCompanyBenefits=e.data}).catch(()=>{this.alert.show("Error al obtener el máximo de beneficios de la empresa.","warning")})},getAppliedElements(){ye.get(`/api/AppliedElement/getAppliedElements?employeeId=${this.user.userId}`).then(e=>{this.appliedElements=e.data}).catch(()=>{this.alert.show("Error al obtener los beneficios aplicados.","warning")})},formatDate(e){if(null==e)return"-";const t=new Date(e);return t.toLocaleDateString()},getTotalActiveAppliedBenefits(){return this.filterAppliedElements.length},getTotalActiveBenefits(){return this.filteredBenefits.filter(e=>"Activo"===e.status).length},addAppliedElement(e){if(this.maxCompanyBenefits-this.getTotalActiveAppliedBenefits()===0)return void this.alert.show("Se llegó al máximo de beneficios activos disponibles.","warning");const t=this.appliedElements.some(t=>t.elementName===e.elementName&&"Activo"===t.status);if(t)this.alert.show("Este beneficio ya está seleccionado.","warning");else if(this.user&&this.user.userId)if(e.idElement){if("API"===e.calculationType){if(2===e.calculationValue)return this.pendingBenefit=e,this.extraFieldType="dependents",this.tempAmountDependents=null,this.tempPlanType="",void(this.showExtraDataModal=!0);if(3===e.calculationValue)return this.pendingBenefit=e,this.extraFieldType="plan",this.tempAmountDependents=null,this.tempPlanType="",void(this.showExtraDataModal=!0)}this.submitAppliedElement(e,null,null)}else this.alert.show("El beneficio no tiene un identificador válido.","warning");else this.alert.show("El usuario actual no está definido.","warning")},confirmExtraData(){if(!this.pendingBenefit)return void this.cancelExtraData();let e=null,t=null;"dependents"===this.extraFieldType&&(e=this.tempAmountDependents,null==e||!Number.isInteger(e)||e<=0)?this.alert.show("La cantidad de dependientes debe ser un número entero mayor que cero.","warning"):"plan"!==this.extraFieldType||(t=(this.tempPlanType||"").toUpperCase(),["A","B","C"].includes(t))?(this.submitAppliedElement(this.pendingBenefit,e,t),this.cancelExtraData()):this.alert.show("El tipo de plan debe ser A, B o C.","warning")},cancelExtraData(){this.showExtraDataModal=!1,this.pendingBenefit=null,this.extraFieldType=null,this.tempAmountDependents=null,this.tempPlanType=""},submitAppliedElement(e,t,a){ye.post("/api/AppliedElement/addAppliedElement",{UserId:this.user.userId,ElementId:e.idElement,ElementType:"Beneficio",AmountDependents:t,PlanType:a}).then(()=>{this.alert.show("Beneficio agregado exitosamente.","warning"),this.getAppliedElements()}).catch(()=>{this.alert.show("Error al agregar el beneficio.","warning")})},async deactivateAppliedElement(e,t){if("Inactivo"!==t)try{await ye.post("/api/AppliedElement/deactivateAppliedElement",{appliedElementId:e}),this.alert.show("Beneficio desactivado correctamente.","warning"),this.getAppliedElements()}catch{this.alert.show("Error al desactivar el beneficio.","warning")}else this.alert.show("El elemento seleccionado ya está inactivo.","warning")},isActiveOrEndingThisMonth(e){if("Beneficio"!==e.elementType)return!1;if("Activo"===e.status)return!0;if("Inactivo"!==e.status)return!1;if(!e.endDate)return!1;const t=new Date(e.endDate);if(isNaN(t.getTime()))return!1;const a=new Date,o=t.getFullYear()===a.getFullYear(),l=t.getMonth()===a.getMonth();return o&&l}},created(){this.user=r(),this.getCompanyIdByUserId(),this.getAppliedElements()}};const ir=(0,I.A)(nr,[["render",sr]]);var rr=ir;const cr={id:"reportFilters"},dr=["value"],ur={id:"buttons"},pr={id:"reportContent"},mr={key:0,class:"text-muted"},yr={key:1,ref:"reportContainer"},hr={id:"reportTable",class:"table-responsive"},vr={class:"table"},br={class:"amount"},fr={key:2,class:"text-muted"};function kr(e,t,a,l,s,n){const i=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)(y.FK,null,[(0,y.Lk)("div",cr,[(0,y.Lk)("div",null,[t[2]||(t[2]=(0,y.Lk)("label",{for:"selectPeriod",class:"form-label fw-bold"},"Periodo",-1)),(0,y.bo)((0,y.Lk)("select",{id:"selectPeriod",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedPayrollId=e)},[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.payrollList,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.payrollId,value:e.payrollId},(0,h.v_)(e.periodLabel),9,dr))),128))],512),[[o.u1,s.selectedPayrollId]])])]),(0,y.Lk)("div",ur,[(0,y.bF)(i,{text:"Descargar PDF",onClick:t[1]||(t[1]=e=>n.downloadPDF())})]),(0,y.Lk)("div",pr,[s.isLoading?((0,y.uX)(),(0,y.CE)("div",mr,"Cargando reporte")):s.reportResult?((0,y.uX)(),(0,y.CE)("div",yr,[t[7]||(t[7]=(0,y.Lk)("h4",null,"Reporte detalle de pago de planilla",-1)),(0,y.Lk)("p",null,[t[3]||(t[3]=(0,y.Lk)("strong",null,"Empresa:",-1)),(0,y.eW)(" "+(0,h.v_)(s.reportResult.reportInfo.CompanyName),1)]),(0,y.Lk)("p",null,[t[4]||(t[4]=(0,y.Lk)("strong",null,"Empleado:",-1)),(0,y.eW)(" "+(0,h.v_)(s.reportResult.reportInfo.EmployeeName),1)]),(0,y.Lk)("p",null,[t[5]||(t[5]=(0,y.Lk)("strong",null,"Tipo de contrato:",-1)),(0,y.eW)(" "+(0,h.v_)(s.reportResult.reportInfo.EmployeeType),1)]),(0,y.Lk)("p",null,[t[6]||(t[6]=(0,y.Lk)("strong",null,"Fecha de pago:",-1)),(0,y.eW)(" "+(0,h.v_)(n.formatDate(s.reportResult.reportInfo.PaymentDate)),1)]),(0,y.Lk)("div",hr,[(0,y.Lk)("table",vr,[(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.reportResult.rows,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t,class:(0,h.C4)(n.lineClasses(e))},[(0,y.Lk)("td",null,(0,h.v_)(e["Descripción"]),1),(0,y.Lk)("td",br,(0,h.v_)(n.fmtCRC(e["Monto"])),1)],2))),128))])])])],512)):((0,y.uX)(),(0,y.CE)("div",fr,"No hay datos para mostrar."))])],64)}var gr=a(597),Lr=a(2125),Cr=a.n(Lr),Er={components:{LinkButton:ke},data(){return{payrollList:[],selectedPayrollId:null,reportResult:null,isLoading:!1}},methods:{getPayrollList(){const e=this.$session.user?.companyUniqueId,t=Number(this.$session.user?.personId);ye.get("/api/Reports/employee/payroll-periods",{params:{companyId:e,employeeId:t}}).then(e=>{this.payrollList=e.data||[],this.payrollList.length>0&&(this.selectedPayrollId=this.payrollList[0].payrollId)}).catch(e=>{const t=e&&e.response&&e.response.data?e.response.data:null,a="string"===typeof t?t:t&&(t.message||t.detail)||"Error cargando las últimas planillas",o=v();o.show(a,"warning")})},loadReport(){if(!this.selectedPayrollId)return;const e=this.$session.user?.companyUniqueId,t=Number(this.$session.user?.personId),a={reportCode:"EmployeeDetailPayroll",companyId:e,employeeId:t,payrollId:this.selectedPayrollId};this.isLoading=!0,ye.post("/api/Reports/data",a).then(e=>{this.reportResult=e.data}).catch(e=>{const t=e&&e.response&&e.response.data?e.response.data:null,a="string"===typeof t?t:t&&(t.message||t.detail)||"Error cargando el detalle de planilla",o=v();o.show(a,"warning"),this.reportResult=null}).finally(()=>{this.isLoading=!1})},fmtCRC(e){return new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",currencyDisplay:"symbol",minimumFractionDigits:2,maximumFractionDigits:2}).format(Number(e??0))},formatDate(e){if(!e)return"";const t=new Date(e);return isNaN(t)?"":new Intl.DateTimeFormat("es-CR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)},lineClasses(e){const t=(e["Descripción"]||"").toString().toLowerCase();return{"line-gross":"salario bruto"===t,"line-total":t.includes("total"),"line-net":"pago neto"===t}},async downloadPDF(){const e=this.$refs.reportContainer;if(!e||!this.reportResult)return;const t=this.reportResult.reportInfo?.PaymentDate;let a="";if(t){const e=new Date(t);if(!isNaN(e)){const t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");a=`${t}${o}${l}`}}const o=a?`Detalle_planilla_${a}.pdf`:"Detalle_planilla.pdf",l=await Cr()(e,{scale:2,useCORS:!0,backgroundColor:"#ffffff"}),s=l.toDataURL("image/png"),n=new gr.Ay("p","mm","a4"),i=n.internal.pageSize.getWidth(),r=n.internal.pageSize.getHeight(),c=10,d=25,u=i-2*c,p=l.height*u/l.width;let m=u,y=p;const h=r-d-c;if(p>h){const e=h/p;m=u*e,y=p*e}const v=(i-m)/2,b=d;n.addImage(s,"PNG",v,b,m,y),n.save(o)}},watch:{selectedPayrollId(){this.loadReport()}},mounted(){this.getPayrollList()}};const xr=(0,I.A)(Er,[["render",kr],["__scopeId","data-v-7ffc5934"]]);var Dr=xr;const wr={id:"reportFilters"},Ir={id:"buttons"},Pr={id:"reportContent"},Fr={id:"reportTable",class:"table-responsive"},Tr={class:"table"},_r={key:0};function Sr(e,t,a,l,s,n){const i=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)(y.FK,null,[(0,y.Lk)("div",wr,[(0,y.Lk)("div",null,[t[3]||(t[3]=(0,y.Lk)("label",{for:"dateFrom",class:"form-label fw-bold"},"Fecha inicial",-1)),(0,y.bo)((0,y.Lk)("input",{id:"dateFrom",type:"date",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>s.dateFrom=e)},null,512),[[o.Jo,s.dateFrom]])]),(0,y.Lk)("div",null,[t[4]||(t[4]=(0,y.Lk)("label",{for:"dateTo",class:"form-label fw-bold"},"Fecha final",-1)),(0,y.bo)((0,y.Lk)("input",{id:"dateTo",type:"date",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>s.dateTo=e)},null,512),[[o.Jo,s.dateTo]])])]),(0,y.Lk)("div",null,[(0,y.Lk)("div",Ir,[(0,y.bF)(i,{text:"Descargar Excel",onClick:t[2]||(t[2]=e=>n.downloadExcel())})])]),(0,y.Lk)("div",Pr,[t[11]||(t[11]=(0,y.Lk)("h4",null,"Reporte histórico pago de planilla",-1)),(0,y.Lk)("p",null,[t[5]||(t[5]=(0,y.Lk)("strong",null,"Empresa:",-1)),(0,y.eW)(" "+(0,h.v_)(s.companyName),1)]),(0,y.Lk)("p",null,[t[6]||(t[6]=(0,y.Lk)("strong",null,"Empleado:",-1)),(0,y.eW)(" "+(0,h.v_)(s.employeeName),1)]),(0,y.Lk)("p",null,[t[7]||(t[7]=(0,y.Lk)("strong",null,"Fecha inicial:",-1)),(0,y.eW)(" "+(0,h.v_)(n.formatFilterDate(s.dateFrom)),1)]),(0,y.Lk)("p",null,[t[8]||(t[8]=(0,y.Lk)("strong",null,"Fecha final:",-1)),(0,y.eW)(" "+(0,h.v_)(n.formatFilterDate(s.dateTo)),1)]),(0,y.Lk)("div",Fr,[(0,y.Lk)("table",Tr,[t[10]||(t[10]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Tipo de contrato"),(0,y.Lk)("th",null,"Posición"),(0,y.Lk)("th",null,"Fecha de pago"),(0,y.Lk)("th",null,"Salario bruto"),(0,y.Lk)("th",null,"Deducciones obligatorias"),(0,y.Lk)("th",null,"Deducciones voluntarias"),(0,y.Lk)("th",null,"Salario neto")])],-1)),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.payrollData,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t,class:(0,h.C4)({"totals-row":"Total"===e.contractType})},[(0,y.Lk)("td",null,(0,h.v_)(e.contractType),1),(0,y.Lk)("td",null,(0,h.v_)(e.position),1),(0,y.Lk)("td",null,(0,h.v_)(n.formatDate(e.paymentDate)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.grossSalary)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.mandatoryDeductions)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.voluntaryDeductions)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.netSalary)),1)],2))),128)),s.payrollData.length?(0,y.Q3)("",!0):((0,y.uX)(),(0,y.CE)("tr",_r,[...t[9]||(t[9]=[(0,y.Lk)("td",{colspan:"7",class:"text-center text-muted"}," No hay datos para mostrar. ",-1)])]))])])])])],64)}a(7588);var Ur=a(3230),Ar=a(788),Nr={components:{LinkButton:ke},data(){const{user:e}=m();return{user:e,companyName:"",employeeName:"",dateFrom:"",dateTo:"",payrollData:[],isLoading:!1}},methods:{async loadReport(){if(!this.dateFrom||!this.dateTo)return;this.companyName=this.user?.companyName||"",this.employeeName=this.user?.fullName||"";const e=this.user?.companyUniqueId,t=Number(this.user?.personId),a={reportCode:"EmployeeHistoryPayroll",companyId:e,employeeId:t,dateFrom:this.dateFrom,dateTo:this.dateTo};this.isLoading=!0,this.payrollData=[];try{const e=await ye.post("/api/Reports/data",a);this.companyName=e.data.reportInfo.CompanyName,this.employeeName=e.data.reportInfo.EmployeeName,this.payrollData=e.data.rows||[]}catch(o){const e=o?.response?.data,t="string"===typeof e?e:e&&(e.message||e.detail)||"Error cargando el detalle de planilla",a="No se encontró información de pago para el empleado en el rango seleccionado";if(t!==a){const e=v();e.show(t,"warning")}this.payrollData=[]}finally{this.isLoading=!1}},downloadExcel(){const e=document.getElementById("reportTable");if(!e)return;const t=e.querySelector("table");if(!t)return;const a=t.cloneNode(!0),o=[3,4,5,6],l=a.querySelectorAll("tbody tr");l.forEach(e=>{const t=e.querySelectorAll("td");o.forEach(e=>{const a=t[e];if(!a)return;const o=a.textContent||"";let l=o.replace(/[^\d.,-]/g,"");const s=l.match(/[.,]/g);if(s&&s.length>1){const e=Math.max(l.lastIndexOf(","),l.lastIndexOf(".")),t=l.slice(0,e).replace(/[.,]/g,""),a=l.slice(e+1).replace(/[.,]/g,"");l=t+"."+a}else l=l.replace(/\./g,"").replace(",",".");a.textContent=l})});const s=Ur.Wp.table_to_book(a,{sheet:"Planilla"}),n=Ur.M9(s,{bookType:"xlsx",type:"array"}),i=new Blob([n],{type:"application/octet-stream"});(0,Ar.saveAs)(i,"Reporte_Planilla.xlsx")},fmtCRC(e){return new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",currencyDisplay:"symbol",minimumFractionDigits:2,maximumFractionDigits:2}).format(Number(e??0))},formatFilterDate(e){if(!e)return"";const[t,a,o]=e.split("-");return`${o}/${a}/${t}`},formatDate(e){if(!e)return"";const t=new Date(e);return isNaN(t)?"":new Intl.DateTimeFormat("es-CR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)}},watch:{dateFrom(){this.loadReport()},dateTo(){this.loadReport()}},async mounted(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0);this.dateFrom=t.toISOString().slice(0,10),this.dateTo=a.toISOString().slice(0,10),this.loadReport()}};const Xr=(0,I.A)(Nr,[["render",Sr],["__scopeId","data-v-4a9821f0"]]);var Vr=Xr;const qr={id:"reportFilters"},Rr=["value"],Br={key:0,class:"text-danger small mt-1"},$r={id:"buttons"},Mr={id:"reportContent"},Kr={key:0,class:"text-muted"},Qr={key:1,id:"reportTable",class:"table-responsive"},Or={class:"table"},Jr={key:0};function zr(e,t,a,l,s,n){const i=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)("div",null,[(0,y.Lk)("div",qr,[(0,y.Lk)("div",null,[t[12]||(t[12]=(0,y.Lk)("label",{for:"Company",class:"form-label fw-bold"},"Empresa",-1)),(0,y.bo)((0,y.Lk)("select",{id:"Company",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedCompanyUniqueId=e),onChange:t[1]||(t[1]=(...e)=>n.onFiltersChanged&&n.onFiltersChanged(...e))},[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.companies,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.companyUniqueId,value:e.companyUniqueId},(0,h.v_)(e.companyName),9,Rr))),128))],544),[[o.u1,s.selectedCompanyUniqueId]])]),(0,y.Lk)("div",null,[t[14]||(t[14]=(0,y.Lk)("label",{for:"EmployeeType",class:"form-label fw-bold"},"Tipo de Empleado",-1)),(0,y.bo)((0,y.Lk)("select",{id:"EmployeeType",class:"form-select","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedEmployeeType=e),onChange:t[3]||(t[3]=(...e)=>n.onFiltersChanged&&n.onFiltersChanged(...e))},[...t[13]||(t[13]=[(0,y.Lk)("option",{value:null},"Seleccione un tipo",-1),(0,y.Lk)("option",{value:"FullTime"},"Tiempo Completo",-1),(0,y.Lk)("option",{value:"PartTime"},"Medio Tiempo",-1),(0,y.Lk)("option",{value:"ProfessionalServices"},"Servicios Profesionales",-1)])],544),[[o.u1,s.selectedEmployeeType]])]),(0,y.Lk)("div",null,[t[15]||(t[15]=(0,y.Lk)("label",{for:"EmployeeNationalId",class:"form-label fw-bold"},"Cédula de Empleado",-1)),(0,y.bo)((0,y.Lk)("input",{id:"EmployeeNationalId",type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=e=>s.selectedEmployeeNationalId=e),onInput:t[5]||(t[5]=(...e)=>n.formatNationalId&&n.formatNationalId(...e)),onChange:t[6]||(t[6]=(...e)=>n.onFiltersChanged&&n.onFiltersChanged(...e)),pattern:"\\\\d{1}-\\\\d{4}-\\\\d{4}",placeholder:"1-2345-6789"},null,544),[[o.Jo,s.selectedEmployeeNationalId]]),e.cedulaError?((0,y.uX)(),(0,y.CE)("p",Br,(0,h.v_)(e.cedulaError),1)):(0,y.Q3)("",!0)]),(0,y.Lk)("div",null,[t[16]||(t[16]=(0,y.Lk)("label",{for:"StartDate",class:"form-label fw-bold"},"Fecha inicial",-1)),(0,y.bo)((0,y.Lk)("input",{id:"StartDate",type:"date",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=e=>s.dateFrom=e),onChange:t[8]||(t[8]=(...e)=>n.onFiltersChanged&&n.onFiltersChanged(...e))},null,544),[[o.Jo,s.dateFrom]])]),(0,y.Lk)("div",null,[t[17]||(t[17]=(0,y.Lk)("label",{for:"EndDate",class:"form-label fw-bold"},"Fecha final",-1)),(0,y.bo)((0,y.Lk)("input",{id:"EndDate",type:"date",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=e=>s.dateTo=e),onChange:t[10]||(t[10]=(...e)=>n.onFiltersChanged&&n.onFiltersChanged(...e))},null,544),[[o.Jo,s.dateTo]])])]),(0,y.Lk)("div",null,[(0,y.Lk)("div",$r,[(0,y.bF)(i,{text:"Descargar Excel",onClick:t[11]||(t[11]=e=>n.downloadExcel())})])]),(0,y.Lk)("div",Mr,[t[22]||(t[22]=(0,y.Lk)("h4",null,"Detalle de Planilla Por Empleado",-1)),(0,y.Lk)("p",null,[t[18]||(t[18]=(0,y.Lk)("strong",null,"Empresa:",-1)),(0,y.eW)(" "+(0,h.v_)(n.companyFilterLabel),1)]),(0,y.Lk)("p",null,[t[19]||(t[19]=(0,y.Lk)("strong",null,"Empleador:",-1)),(0,y.eW)(" "+(0,h.v_)(s.employerName),1)]),s.isLoading?((0,y.uX)(),(0,y.CE)("div",Kr,"Cargando reporte")):((0,y.uX)(),(0,y.CE)("div",Qr,[(0,y.Lk)("table",Or,[t[21]||(t[21]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Nombre Empleado"),(0,y.Lk)("th",null,"Cédula"),(0,y.Lk)("th",null,"Tipo de Empleado"),(0,y.Lk)("th",null,"Periodo de Pago"),(0,y.Lk)("th",null,"Fecha de Pago"),(0,y.Lk)("th",null,"Salario Bruto"),(0,y.Lk)("th",null,"Cargas Sociales Empleador"),(0,y.Lk)("th",null,"Deducciones Voluntarias"),(0,y.Lk)("th",null,"Costo Empleador")])],-1)),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.payrollData,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t,class:(0,h.C4)({"totals-row":"Total"===e.EmployeeName})},[(0,y.Lk)("td",null,(0,h.v_)(e.EmployeeName),1),(0,y.Lk)("td",null,(0,h.v_)(e.NationalId),1),(0,y.Lk)("td",null,(0,h.v_)(e.EmployeeType),1),(0,y.Lk)("td",null,(0,h.v_)(e.PaymentPeriod),1),(0,y.Lk)("td",null,(0,h.v_)(n.formatDate(e.PaymentDate)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.GrossSalary)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.EmployerContributions)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.EmployeeBenefits)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.EmployerCost)),1)],2))),128)),s.payrollData.length||e.reportError?(0,y.Q3)("",!0):((0,y.uX)(),(0,y.CE)("tr",Jr,[...t[20]||(t[20]=[(0,y.Lk)("td",{colspan:"9",class:"text-center text-muted"}," No hay datos para mostrar. ",-1)])]))])])]))])])}var jr={components:{LinkButton:ke},data(){const{user:e}=m();return{user:e,payrollData:[],isLoading:!1,companies:[],selectedCompanyUniqueId:null,dateFrom:"",dateTo:"",employerName:"",selectedEmployeeType:null,selectedEmployeeNationalId:""}},computed:{companyFilterLabel(){if(!this.selectedCompanyUniqueId)return"";const e=this.companies.find(e=>e.companyUniqueId===this.selectedCompanyUniqueId);return e?.companyName||this.user?.companyName||""}},methods:{formatNationalId(e){let t=e.target.value.replace(/\D/g,"");t.length>9&&(t=t.slice(0,9));let a=t;t.length>1&&(a=t[0]+"-"+t.slice(1)),t.length>5&&(a=t[0]+"-"+t.slice(1,5)+"-"+t.slice(5)),this.selectedEmployeeNationalId=a},async loadCompanies(){this.loadingCompanies=!0;try{const e=this.$session.user?.userId;if(this.employerName=this.$session.user?.fullName||"",!e)return void(this.companies=[]);const{data:t}=await ye.get(`/api/Company/by-user/${e}?onlyActive=false`),a=Array.isArray(t)?t.slice():[];this.companies=a}catch(e){const t=v();t.show("Error al cargar empresas para el filtro.","warning")}finally{this.loadingCompanies=!1}},async onFiltersChanged(){if(!this.selectedCompanyUniqueId||!this.dateFrom||!this.dateTo)return;if(this.selectedEmployeeNationalId){const e=/^\d-\d{4}-\d{4}$/;if(!e.test(this.selectedEmployeeNationalId)){const e=v();return void e.show("La cédula debe tener el formato #-####-####.","warning")}}const e={reportCode:"EmployerEmployeePayroll",companyId:this.selectedCompanyUniqueId,employeeNationalId:this.selectedEmployeeNationalId||null,employeeType:this.selectedEmployeeType??null,dateFrom:this.dateFrom,dateTo:this.dateTo};try{const{data:t}=await ye.post("/api/Reports/data",e),a=Array.isArray(t.rows)?t.rows:[];this.payrollData=a}catch(t){const e=t?.response?.data?.message,a=v();a.show(e||"No se pudo cargar el reporte. Intente nuevamente más tarde.","warning")}},downloadExcel(){const e=document.getElementById("reportTable");if(!e)return;const t=e.querySelector("table");if(!t)return;const a=t.cloneNode(!0),o=[5,6,7,8],l=a.querySelectorAll("tbody tr");l.forEach(e=>{const t=e.querySelectorAll("td");o.forEach(e=>{const a=t[e];if(!a)return;const o=a.textContent||"";let l=o.replace(/[^\d.,-]/g,"");const s=l.match(/[.,]/g);if(s&&s.length>1){const e=Math.max(l.lastIndexOf(","),l.lastIndexOf(".")),t=l.slice(0,e).replace(/[.,]/g,""),a=l.slice(e+1).replace(/[.,]/g,"");l=t+"."+a}else l=l.replace(/\./g,"").replace(",",".");a.textContent=l})});const s=Ur.Wp.table_to_book(a,{sheet:"Planilla"}),n=Ur.M9(s,{bookType:"xlsx",type:"array"}),i=new Blob([n],{type:"application/octet-stream"});(0,Ar.saveAs)(i,"Reporte_Planilla.xlsx")},fmtCRC(e){return new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",currencyDisplay:"symbol",minimumFractionDigits:2,maximumFractionDigits:2}).format(Number(e??0))},formatFilterDate(e){if(!e)return"";const[t,a,o]=e.split("-");return`${o}/${a}/${t}`},formatDate(e){if(!e)return"";const t=new Date(e);return isNaN(t)?"":new Intl.DateTimeFormat("es-CR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)}},async mounted(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0);this.dateFrom=t.toISOString().slice(0,10),this.dateTo=a.toISOString().slice(0,10);const o=this.$session.user?.companyUniqueId;o&&(this.selectedCompanyUniqueId=Number(o),this.onFiltersChanged()),this.loadCompanies()}};const Wr=(0,I.A)(jr,[["render",zr],["__scopeId","data-v-5200b7f0"]]);var Hr=Wr;const Gr={id:"reportFilters"},Yr=["value"],Zr=["value"],ec={key:0,id:"buttons"},tc={id:"reportContent"},ac={key:0,class:"text-muted"},oc={key:1,ref:"reportContainer"},lc={id:"reportTable",class:"table-responsive"},sc={class:"table"},nc={class:"amount"},ic={key:2,class:"text-muted"};function rc(e,t,a,l,s,n){const i=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)(y.FK,null,[(0,y.Lk)("div",Gr,[(0,y.Lk)("div",null,[t[3]||(t[3]=(0,y.Lk)("label",{for:"selectCompany",class:"form-label fw-bold"},"Empresa",-1)),(0,y.bo)((0,y.Lk)("select",{id:"selectCompany",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedCompanyId=e)},[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.companies,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.companyUniqueId,value:e.companyUniqueId},(0,h.v_)(e.companyName),9,Yr))),128))],512),[[o.u1,s.selectedCompanyId,void 0,{number:!0}]])]),(0,y.Lk)("div",null,[t[4]||(t[4]=(0,y.Lk)("label",{for:"selectPeriod",class:"form-label fw-bold"},"Periodo",-1)),(0,y.bo)((0,y.Lk)("select",{id:"selectPeriod",class:"form-select","onUpdate:modelValue":t[1]||(t[1]=e=>s.selectedPayrollId=e)},[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.payrollList,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.payrollId,value:e.payrollId},(0,h.v_)(e.periodLabel),9,Zr))),128))],512),[[o.u1,s.selectedPayrollId]])])]),s.reportResult&&!s.isLoading?((0,y.uX)(),(0,y.CE)("div",ec,[(0,y.bF)(i,{text:"Descargar PDF",onClick:t[2]||(t[2]=e=>n.downloadPDF())})])):(0,y.Q3)("",!0),(0,y.Lk)("div",tc,[s.isLoading?((0,y.uX)(),(0,y.CE)("div",ac,"Cargando reporte")):s.reportResult?((0,y.uX)(),(0,y.CE)("div",oc,[t[8]||(t[8]=(0,y.Lk)("h4",null,"Reporte detalle de pago de planilla (empleador)",-1)),(0,y.Lk)("p",null,[t[5]||(t[5]=(0,y.Lk)("strong",null,"Empresa:",-1)),(0,y.eW)(" "+(0,h.v_)(s.reportResult.reportInfo.CompanyName),1)]),(0,y.Lk)("p",null,[t[6]||(t[6]=(0,y.Lk)("strong",null,"Empleador:",-1)),(0,y.eW)(" "+(0,h.v_)(s.reportResult.reportInfo.EmployerName),1)]),(0,y.Lk)("p",null,[t[7]||(t[7]=(0,y.Lk)("strong",null,"Fecha de pago:",-1)),(0,y.eW)(" "+(0,h.v_)(n.formatDate(s.reportResult.reportInfo.PaymentDate)),1)]),(0,y.Lk)("div",lc,[(0,y.Lk)("table",sc,[(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.reportResult.rows,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t,class:(0,h.C4)(n.lineClasses(e))},[(0,y.Lk)("td",null,(0,h.v_)(e["Descripción"]),1),(0,y.Lk)("td",nc,(0,h.v_)(n.fmtCRC(e["Monto"])),1)],2))),128))])])])],512)):((0,y.uX)(),(0,y.CE)("div",ic,"No hay datos para mostrar."))])],64)}var cc={components:{LinkButton:ke},data(){return{companies:[],selectedCompanyId:null,loadingCompanies:!1,payrollList:[],selectedPayrollId:null,reportResult:null,isLoading:!1}},methods:{async fetchCompanies(){this.loadingCompanies=!0;try{const e=this.$session.user?.userId;if(!e)return void(this.companies=[]);const{data:t}=await ye.get(`/api/Company/by-user/${e}?onlyActive=false`),a=Array.isArray(t)?t.slice():[];this.companies=a}catch(e){const t=v();t.show("Error al cargar empresas para el filtro.","warning")}finally{this.loadingCompanies=!1}},getPayrollList(){const e=this.selectedCompanyId||this.$session.user?.companyUniqueId;ye.get("/api/Reports/employer/payroll-periods",{params:{companyId:e}}).then(e=>{this.payrollList=e.data||[],this.payrollList.length>0&&(this.selectedPayrollId=this.payrollList[0].payrollId)}).catch(e=>{const t=e&&e.response&&e.response.data?e.response.data:null,a="string"===typeof t?t:t&&(t.message||t.detail)||"Error cargando las últimas planillas",o=v();o.show(a,"warning")})},loadReport(){if(!this.selectedPayrollId)return;const e=this.selectedCompanyId||this.$session.user?.companyUniqueId,t=Number(this.$session.user?.personId),a={reportCode:"EmployerDetailPayroll",companyId:e,employeeId:t,payrollId:this.selectedPayrollId};this.isLoading=!0,ye.post("/api/Reports/data",a).then(e=>{this.reportResult=e.data}).catch(e=>{const t=e&&e.response&&e.response.data?e.response.data:null,a="string"===typeof t?t:t&&(t.message||t.detail)||"Error cargando el detalle de planilla",o=v();o.show(a,"warning"),this.reportResult=null}).finally(()=>{this.isLoading=!1})},fmtCRC(e){return new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",currencyDisplay:"symbol",minimumFractionDigits:2,maximumFractionDigits:2}).format(Number(e??0))},formatDate(e){if(!e)return"";const t=new Date(e);return isNaN(t)?"":new Intl.DateTimeFormat("es-CR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)},lineClasses(e){const t=(e["Descripción"]||"").toString().toLowerCase();return{"line-total":t.includes("total"),"line-cost":"costo total empleador"===t}},async downloadPDF(){const e=this.$refs.reportContainer;if(!e||!this.reportResult)return;const t=this.reportResult.reportInfo?.PaymentDate;let a="";if(t){const e=new Date(t);if(!isNaN(e)){const t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");a=`${t}${o}${l}`}}const o=a?`Detalle_planilla_${a}.pdf`:"Detalle_planilla.pdf",l=await Cr()(e,{scale:2,useCORS:!0,backgroundColor:"#ffffff"}),s=l.toDataURL("image/png"),n=new gr.Ay("p","mm","a4"),i=n.internal.pageSize.getWidth(),r=n.internal.pageSize.getHeight(),c=10,d=25,u=i-2*c,p=l.height*u/l.width;let m=u,y=p;const h=r-d-c;if(p>h){const e=h/p;m=u*e,y=p*e}const v=(i-m)/2,b=d;n.addImage(s,"PNG",v,b,m,y),n.save(o)}},watch:{selectedCompanyId(){this.getPayrollList()},selectedPayrollId(){this.loadReport()}},mounted(){const e=Number(this.$session.user?.companyUniqueId||0);this.fetchCompanies().then(()=>{e?this.selectedCompanyId=e:this.companies.length>0&&(this.selectedCompanyId=this.companies[0].companyUniqueId)})}};const dc=(0,I.A)(cc,[["render",rc],["__scopeId","data-v-2408102c"]]);var uc=dc;const pc={id:"reportFilters"},mc=["value"],yc={id:"buttons"},hc={id:"reportContent"},vc={key:0,class:"text-muted"},bc={key:1,id:"reportTable",class:"table-responsive"},fc={class:"table"},kc={key:0};function gc(e,t,a,l,s,n){const i=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)(y.FK,null,[(0,y.Lk)("div",pc,[(0,y.Lk)("div",null,[t[5]||(t[5]=(0,y.Lk)("label",{for:"selectCompany",class:"form-label fw-bold"},"Empresa",-1)),(0,y.bo)((0,y.Lk)("select",{id:"selectCompany",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedCompanyId=e)},[t[4]||(t[4]=(0,y.Lk)("option",{value:0},"Todas",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.companies,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.companyUniqueId,value:e.companyUniqueId},(0,h.v_)(e.companyName),9,mc))),128))],512),[[o.u1,s.selectedCompanyId,void 0,{number:!0}]])]),(0,y.Lk)("div",null,[t[6]||(t[6]=(0,y.Lk)("label",{for:"dateFrom",class:"form-label fw-bold"},"Fecha inicial",-1)),(0,y.bo)((0,y.Lk)("input",{id:"dateFrom",type:"date",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>s.dateFrom=e)},null,512),[[o.Jo,s.dateFrom]])]),(0,y.Lk)("div",null,[t[7]||(t[7]=(0,y.Lk)("label",{for:"dateTo",class:"form-label fw-bold"},"Fecha final",-1)),(0,y.bo)((0,y.Lk)("input",{id:"dateTo",type:"date",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>s.dateTo=e)},null,512),[[o.Jo,s.dateTo]])])]),(0,y.Lk)("div",null,[(0,y.Lk)("div",yc,[(0,y.bF)(i,{text:"Descargar Excel",onClick:t[3]||(t[3]=e=>n.downloadExcel())})])]),(0,y.Lk)("div",hc,[t[13]||(t[13]=(0,y.Lk)("h4",null,"Reporte histórico pago de planilla",-1)),(0,y.Lk)("p",null,[t[8]||(t[8]=(0,y.Lk)("strong",null,"Empresa:",-1)),(0,y.eW)(" "+(0,h.v_)(n.companyFilterLabel),1)]),(0,y.Lk)("p",null,[t[9]||(t[9]=(0,y.Lk)("strong",null,"Fecha inicial:",-1)),(0,y.eW)(" "+(0,h.v_)(n.formatFilterDate(s.dateFrom)),1)]),(0,y.Lk)("p",null,[t[10]||(t[10]=(0,y.Lk)("strong",null,"Fecha final:",-1)),(0,y.eW)(" "+(0,h.v_)(n.formatFilterDate(s.dateTo)),1)]),s.isLoading?((0,y.uX)(),(0,y.CE)("div",vc,"Cargando reporte")):((0,y.uX)(),(0,y.CE)("div",bc,[(0,y.Lk)("table",fc,[t[12]||(t[12]=(0,y.Lk)("thead",null,[(0,y.Lk)("tr",null,[(0,y.Lk)("th",null,"Nombre de empresa"),(0,y.Lk)("th",null,"Frecuencia de pago"),(0,y.Lk)("th",null,"Periodo de pago"),(0,y.Lk)("th",null,"Fecha de pago"),(0,y.Lk)("th",null,"Salario bruto"),(0,y.Lk)("th",null,"Cargas sociales empleador"),(0,y.Lk)("th",null,"Deducciones voluntarias"),(0,y.Lk)("th",null,"Costo empleador")])],-1)),(0,y.Lk)("tbody",null,[((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.payrollData,(e,t)=>((0,y.uX)(),(0,y.CE)("tr",{key:t,class:(0,h.C4)({"totals-row":"Total"===e.CompanyName})},[(0,y.Lk)("td",null,(0,h.v_)(e.CompanyName),1),(0,y.Lk)("td",null,(0,h.v_)(e.PaymentFrequency),1),(0,y.Lk)("td",null,(0,h.v_)(e.Period),1),(0,y.Lk)("td",null,(0,h.v_)(n.formatDate(e.PaymentDate)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.GrossSalary)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.EmployerContributions)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.EmployeeBenefits)),1),(0,y.Lk)("td",null,(0,h.v_)(n.fmtCRC(e.EmployerCost)),1)],2))),128)),s.payrollData.length?(0,y.Q3)("",!0):((0,y.uX)(),(0,y.CE)("tr",kc,[...t[11]||(t[11]=[(0,y.Lk)("td",{colspan:"8",class:"text-center text-muted"}," No hay datos para mostrar. ",-1)])]))])])]))])],64)}var Lc={components:{LinkButton:ke},data(){return{companies:[],selectedCompanyId:0,dateFrom:"",dateTo:"",loadingCompanies:!1,isLoading:!1,payrollData:[]}},computed:{companyFilterLabel(){if(!this.selectedCompanyId||0===this.selectedCompanyId)return"Todas";const e=this.companies.find(e=>e.companyUniqueId===this.selectedCompanyId);return e?.companyName||""}},methods:{async fetchCompanies(){this.loadingCompanies=!0;try{const e=this.$session.user?.userId;if(!e)return void(this.companies=[]);const{data:t}=await ye.get(`/api/Company/by-user/${e}?onlyActive=false`),a=Array.isArray(t)?t.slice():[];this.companies=a}catch(e){const t=v();t.show("Error al cargar empresas para el filtro.","warning")}finally{this.loadingCompanies=!1}},async loadReport(){if(!this.dateFrom||!this.dateTo)return;const e=Number(this.$session.user?.personId),t={reportCode:"EmployerHistoryPayroll",companyId:this.selectedCompanyId||0,employeeId:e,dateFrom:this.dateFrom,dateTo:this.dateTo};this.isLoading=!0,this.payrollData=[];try{const{data:e}=await ye.post("/api/Reports/data",t),a=Array.isArray(e.rows)?e.rows:[];this.payrollData=a}catch(a){const e=a&&a.response&&a.response.data?a.response.data:null,t="string"===typeof e?e:e&&(e.message||e.detail)||"Error cargando el reporte histórico de empresas",o="No se encontró información de pago para el empleado en el rango seleccionado";if(t!==o){const e=v();e.show(t,"warning")}this.payrollData=[]}finally{this.isLoading=!1}},downloadExcel(){const e=document.getElementById("reportTable");if(!e)return;const t=e.querySelector("table");if(!t)return;const a=t.cloneNode(!0),o=[4,5,6,7],l=a.querySelectorAll("tbody tr");l.forEach(e=>{const t=e.querySelectorAll("td");o.forEach(e=>{const a=t[e];if(!a)return;const o=a.textContent||"";let l=o.replace(/[^\d.,-]/g,"");const s=l.match(/[.,]/g);if(s&&s.length>1){const e=Math.max(l.lastIndexOf(","),l.lastIndexOf(".")),t=l.slice(0,e).replace(/[.,]/g,""),a=l.slice(e+1).replace(/[.,]/g,"");l=t+"."+a}else l=l.replace(/\./g,"").replace(",",".");a.textContent=l})});const s=Ur.Wp.table_to_book(a,{sheet:"Planilla"}),n=Ur.M9(s,{bookType:"xlsx",type:"array"}),i=new Blob([n],{type:"application/octet-stream"});(0,Ar.saveAs)(i,"Reporte_Planilla.xlsx")},fmtCRC(e){return new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC",currencyDisplay:"symbol",minimumFractionDigits:2,maximumFractionDigits:2}).format(Number(e??0))},formatFilterDate(e){if(!e)return"";const[t,a,o]=e.split("-");return`${o}/${a}/${t}`},formatDate(e){if(!e)return"";const t=new Date(e);return isNaN(t)?"":new Intl.DateTimeFormat("es-CR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)}},watch:{selectedCompanyId(){this.loadReport()},dateFrom(){this.loadReport()},dateTo(){this.loadReport()}},mounted(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0);this.dateFrom=t.toISOString().slice(0,10),this.dateTo=a.toISOString().slice(0,10),this.fetchCompanies().then(()=>{this.loadReport()})}};const Cc=(0,I.A)(Lc,[["render",gc],["__scopeId","data-v-5428b676"]]);var Ec=Cc;function xc(e){const t=[{id:"detail-payroll",description:"Detalle de pago de planilla",component:Dr},{id:"history-payroll",description:"Histórico de pago de planilla",component:Vr}],a=[{id:"detail-payroll",description:"Detalle de pago de planilla",component:uc},{id:"history-payroll",description:"Histórico de pago de planilla",component:Ec},{id:"employee-payroll",description:"Detalle de Planilla Por Empleado",component:Hr}];return"Empleador"===e?a:t}const Dc={class:"container py-5"},wc={class:"display-5 text-center"},Ic={class:"w-50 mb-4"},Pc=["value"],Fc={key:0,class:"text-muted mb-2 text-center"},Tc={key:1,class:"report-host"};var _c={__name:"ViewReports",setup(e){const{user:t}=m(),a=xc(t.typeUser),l=(0,u.KR)(""),s=(0,y.EW)(()=>a.find(e=>e.id===l.value));return(e,t)=>((0,y.uX)(),(0,y.CE)("div",Dc,[(0,y.Lk)("h1",wc,(0,h.v_)(s.value?`Reporte - ${s.value.description}`:"Reporte"),1),(0,y.Lk)("div",Ic,[t[2]||(t[2]=(0,y.Lk)("label",{for:"selectReports",class:"form-label fw-bold"},"Reportes",-1)),(0,y.bo)((0,y.Lk)("select",{id:"selectReports",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e)},[t[1]||(t[1]=(0,y.Lk)("option",{disabled:"",value:""},"Seleccione un tipo de reporte",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)((0,u.R1)(a),e=>((0,y.uX)(),(0,y.CE)("option",{key:e.id,value:e.id},(0,h.v_)(e.description),9,Pc))),128))],512),[[o.u1,l.value]])]),(0,y.Lk)("div",null,[l.value?((0,y.uX)(),(0,y.CE)("div",Tc,[((0,y.uX)(),(0,y.Wv)((0,y.$y)(s.value.component)))])):((0,y.uX)(),(0,y.CE)("div",Fc," No hay un reporte seleccionado "))])]))}};const Sc=(0,I.A)(_c,[["__scopeId","data-v-02ed0f30"]]);var Uc=Sc;const Ac={class:"d-flex justify-content-center align-items-center vh-100"},Nc={class:"card text-center p-5",style:{"min-width":"600px"}},Xc={class:"card-title mb-4"},Vc={class:"card-text mb-4"};var qc={__name:"ActivationAccountpage",setup(e){var t=(0,u.KR)("#"),a=(0,u.KR)("#"),o=(0,u.KR)("Ir a Iniciar Sesión"),l=(0,u.KR)("/auth/Login");const n=(0,s.lq)(),i=(0,s.rd)(),r=n.query.status,c={success:{title:"¡Cuenta activada!",body:"Su cuenta ha sido activada correctamente. Ya puede iniciar sesión.",buttonText:"Ir a Iniciar Sesión",buttonLink:"/auth/Login"},failed:{title:"¡Error! X",body:"No se pudo activar la cuenta. Por favor comuníquese con soporte.",buttonText:"Ir a Soporte",buttonLink:"#"},expired:{title:"Token expirado X",body:"El enlace de activación ha expirado. Solicite uno nuevo.",buttonText:"Solicitar nuevo enlace de activación",buttonLink:"/auth/ResendActivationAccount"},"invalid-token":{title:"Token inválido X",body:"El enlace de activación no es válido.",buttonText:"Solicitar nuevo enlace de activación",buttonLink:"/auth/ResendActivationAccount"},"invalid-user":{title:"¡Error! X",body:"Usuario inválido. Por favor comuníquese con soporte.",buttonText:"Ir a Soporte",buttonLink:"#"},"already-active":{title:"¡Cuenta ya activa!",body:"Su cuenta ya ha sido previamente activada. Ya puede iniciar sesión.",buttonText:"Ir a Iniciar Sesión",buttonLink:"/auth/Login"}};function d(){i.push(l.value)}return(0,y.sV)(()=>{if(r&&c[r]){const e=c[r];a.value=e.title,o.value=e.body,t.value=e.buttonText,l.value=e.buttonLink}}),(e,l)=>((0,y.uX)(),(0,y.CE)("div",Ac,[(0,y.Lk)("div",Nc,[(0,y.Lk)("h2",Xc,(0,h.v_)((0,u.R1)(a)),1),(0,y.Lk)("p",Vc,(0,h.v_)((0,u.R1)(o)),1),(0,y.bF)(ke,{text:(0,u.R1)(t),onClick:d},null,8,["text"])])]))}};const Rc=qc;var Bc=Rc;const $c={class:"d-flex flex-column",id:"container"},Mc={class:"d-flex justify-content-center align-items-center"};var Kc={__name:"ResendActivationAccountPage",setup(e){var t=(0,s.rd)(),a=(0,u.KR)(""),l=(0,u.KR)(!1),n=(0,u.KR)("Enviar correo de activación");async function i(){const e=v();try{const t=await ye.post("/api/Tokens/ResendActivation",`"${a.value}"`);e.show(t.data.message,"success"),l.value=!0,n.value="Ir a iniciar sesión"}catch(t){t.response?e.show(t.response.data.message||"Error del backend","warning"):e.show("Error de red: "+t.message,"error")}}function r(){l.value?t.push("/auth/Login"):i()}return(e,t)=>((0,y.uX)(),(0,y.CE)("div",$c,[(0,y.Lk)("div",Mc,[(0,y.Lk)("form",{class:"form-signig p-5 h-100 d-inline-block",style:{"max-width":"550px",width:"100%"},onSubmit:t[1]||(t[1]=(0,o.D$)((...t)=>e.saveRegisterData&&e.saveRegisterData(...t),["prevent"]))},[t[2]||(t[2]=(0,y.Lk)("h2",{class:"font-weigth-normal text-center mb-4"},"Reenvío de correo de activación",-1)),(0,y.bF)(Ie,{label:"Correo electrónico",id:"email",type:"email",placeHolder:"name@example.com",modelValue:(0,u.R1)(a),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,u.i9)(a)?a.value=e:a=e)},null,8,["modelValue"]),t[3]||(t[3]=(0,y.Lk)("br",null,null,-1)),(0,y.bF)(ke,{text:(0,u.R1)(n),disabled:!(0,u.R1)(a),onClick:r},null,8,["text","disabled"])],32)])]))}};const Qc=Kc;var Oc=Qc;const Jc={class:"d-flex flex-column align-items-center text-center p-4"};function zc(e,t){const a=(0,y.g2)("router-link");return(0,y.uX)(),(0,y.CE)("div",Jc,[t[1]||(t[1]=(0,y.Lk)("i",{class:"bi bi-shield-lock",style:{"font-size":"3rem"}},null,-1)),t[2]||(t[2]=(0,y.Lk)("h3",{class:"mt-3 mb-2"},"Acceso restringido",-1)),t[3]||(t[3]=(0,y.Lk)("p",{class:"text-muted mb-4"},"No tiene permisos para ver esta página.",-1)),(0,y.bF)(a,{class:"btn btn-outline-secondary",to:{name:"Home Page"}},{default:(0,y.k6)(()=>[...t[0]||(t[0]=[(0,y.eW)(" Volver al inicio ",-1)])]),_:1})])}const jc={},Wc=(0,I.A)(jc,[["render",zc]]);var Hc=Wc;const Gc={class:"d-flex justify-content-center align-items-center vh-100"},Yc={class:"card text-center p-5",style:{"min-width":"600px"}},Zc={class:"card-title mb-4"},ed={class:"card-text mb-4"},td={key:0,class:"text-start mx-auto",style:{"max-width":"420px"}},ad={key:0,class:"text-danger"},od={key:1,class:"text-danger"},ld={key:2,class:"text-danger mb-2"},sd={key:3,class:"text-success mb-2"},nd={key:1,class:"text-start mx-auto",style:{"max-width":"420px"}};var id={__name:"EmployeeActivation",setup(e){const t=(0,s.lq)(),a=(0,s.rd)(),l=(0,u.KR)("#"),n=(0,u.KR)("#"),i=(0,u.KR)(""),r=(0,u.KR)("/auth/Login"),c=(0,y.EW)(()=>(t.query.status??"").toString().toLowerCase().trim()),d=(0,y.EW)(()=>(t.query.token??"").toString()),p=(0,y.EW)(()=>d.value.length>0),m=(0,y.EW)(()=>"success"===c.value&&p.value),v=(0,u.KR)(""),b=(0,u.KR)(""),f=(0,u.Kh)({password:"",confPassword:""}),k=(0,u.KR)(""),g=(0,u.KR)(""),L=(0,u.KR)(!1),C={success:{title:"¡Cuenta activada!",body:"Su cuenta ha sido activada correctamente. Defina su contraseña para continuar.",buttonText:"Guardar",buttonLink:"/auth/Login"},failed:{title:"¡Error! X",body:"No se pudo activar la cuenta. Por favor comuníquese con soporte.",buttonText:"Ir a Soporte",buttonLink:"#"},expired:{title:"Token expirado X",body:"El enlace de activación ha expirado. Solicite uno nuevo.",buttonText:"Solicitar nuevo enlace de activación",buttonLink:"/auth/ResendActivationAccount"},"invalid-token":{title:"Token inválido X",body:"El enlace de activación no es válido.",buttonText:"Solicitar nuevo enlace de activación",buttonLink:"/auth/ResendActivationAccount"},"invalid-user":{title:"¡Error! X",body:"Usuario inválido. Por favor comuníquese con soporte.",buttonText:"Ir a Soporte",buttonLink:"#"},"already-active":{title:"¡Cuenta ya activa!",body:"Su cuenta ya ha sido previamente activada. Ya puede iniciar sesión.",buttonText:"Ir a Iniciar Sesión",buttonLink:"/auth/Login"}};function E(){let e=c.value;if("success"!==e||p.value||(e="invalid-token"),e&&Object.prototype.hasOwnProperty.call(C,e)){const t=C[e];n.value=t.title,i.value=t.body,l.value=t.buttonText,r.value=t.buttonLink}else n.value="Activación",i.value="Revise el enlace recibido.",l.value="Ir a Iniciar Sesión",r.value="/auth/Login"}function x(){return f.password="",f.confPassword="",k.value="",v.value?v.value.length<8?f.password="La contraseña debe tener al menos 8 caracteres":(/[A-Z]/.test(v.value)||(f.password="La contraseña debe tener al menos una letra mayúscula"),/[a-z]/.test(v.value)||(f.password="La contraseña debe tener al menos una letra minúscula"),/[0-9]/.test(v.value)||(f.password="La contraseña debe tener al menos un número"),/[!@#$%^&*(),.?":{}|<>]/.test(v.value)||(f.password="La contraseña debe tener al menos un carácter especial")):f.password="La contraseña es obligatoria",b.value!==v.value&&(f.confPassword="Las contraseñas no coinciden"),!f.password&&!f.confPassword}async function D(){if(!x())return;const e=String(t.query.token||"");if(e)try{L.value=!0;const t=await ye.post("/api/Tokens/SetPassword",v.value,{headers:{Authorization:`Bearer ${e}`}});g.value=t?.data?.message||"Contraseña actualizada.",k.value="",a.push(r.value)}catch(o){g.value="";const e=o?.response?.data?.message||o?.response?.data||(401===o?.response?.status?"Token inválido o expirado.":null)||"No se pudo actualizar la contraseña.";k.value=e}finally{L.value=!1}else k.value="Falta el token de seguridad."}function w(){a.push(r.value)}return(0,y.sV)(E),(0,y.wB)(c,E),(e,t)=>((0,y.uX)(),(0,y.CE)("div",Gc,[(0,y.Lk)("div",Yc,[(0,y.Lk)("h2",Zc,(0,h.v_)(n.value),1),(0,y.Lk)("p",ed,(0,h.v_)(i.value),1),m.value?((0,y.uX)(),(0,y.CE)("div",td,[(0,y.Lk)("form",{class:"p-5 h-100 d-inline-block",style:{"max-width":"550px",width:"100%"},onSubmit:(0,o.D$)(D,["prevent"]),novalidate:""},[(0,y.bF)(Ie,{label:"Contraseña",id:"pwd",type:"password","min-length":8,"max-length":16,autocomplete:"new-password",modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value=e)},null,8,["modelValue"]),f.password?((0,y.uX)(),(0,y.CE)("span",ad,(0,h.v_)(f.password),1)):(0,y.Q3)("",!0),(0,y.bF)(Ie,{label:"Confirmar contraseña",id:"confPwd",type:"password","min-length":8,"max-length":16,autocomplete:"new-password",modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e)},null,8,["modelValue"]),f.confPassword?((0,y.uX)(),(0,y.CE)("span",od,(0,h.v_)(f.confPassword),1)):(0,y.Q3)("",!0),k.value?((0,y.uX)(),(0,y.CE)("div",ld,(0,h.v_)(k.value),1)):(0,y.Q3)("",!0),g.value?((0,y.uX)(),(0,y.CE)("div",sd,(0,h.v_)(g.value),1)):(0,y.Q3)("",!0),(0,y.bF)(ke,{text:l.value,onClick:D},null,8,["text"])],32),t[2]||(t[2]=(0,y.Lk)("hr",{class:"my-4"},null,-1))])):((0,y.uX)(),(0,y.CE)("div",nd,[(0,y.bF)(ke,{text:l.value,onClick:w},null,8,["text"])]))])]))}};const rd=id;var cd=rd;const dd={class:"d-flex flex-column"},ud={class:"container py-4 flex-fill d-flex justify-content-center"},pd={class:"mb-3 col-xl-6 col-sm-12"},md={class:"mb-3 col-xl-6 col-sm-12"},yd={class:"mb-3 col-xl-6 col-sm-12"},hd={class:"mb-3 col-xl-6 col-sm-12"},vd={class:"mb-3 col-xl-4 col-sm-12"},bd={class:"mb-3 col-xl-4 col-sm-12"},fd={class:"mb-3 col-xl-4 col-sm-12"},kd={class:"mb-3 col-xl-6 col-sm-12"},gd=["value"],Ld={class:"mb-3 col-xl-6 col-sm-12"},Cd=["disabled"],Ed=["value"],xd={class:"mb-3 col-xl-6 col-sm-12"},Dd=["disabled"],wd=["value"],Id={class:"mb-3 col-xl-6 col-sm-12"},Pd={class:"mb-3"},Fd={class:"mb-3 col-xl-12 col-sm-12"},Td=["pattern"],_d={class:"mb-3 pair-btn"};function Sd(e,t,a,l,s,n){const i=(0,y.g2)("LinkButton");return(0,y.uX)(),(0,y.CE)("div",dd,[t[41]||(t[41]=(0,y.Lk)("h1",{class:"text-center mb-3"},"Mi perfil",-1)),(0,y.Lk)("div",ud,[(0,y.Lk)("form",{ref:"profileForm",onSubmit:t[16]||(t[16]=(0,o.D$)((...e)=>n.onSubmit&&n.onSubmit(...e),["prevent"])),class:"row g-3 needs-validation",novalidate:"",style:{width:"800px"}},[t[38]||(t[38]=(0,y.Lk)("h5",{class:"mt-2"},"Datos personales",-1)),(0,y.Lk)("div",pd,[t[17]||(t[17]=(0,y.Lk)("label",{for:"firstName",class:"form-label required"},"Primer nombre",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"firstName",required:"",maxlength:"60","onUpdate:modelValue":t[0]||(t[0]=e=>s.model.personData.name1=e)},null,512),[[o.Jo,s.model.personData.name1]]),t[18]||(t[18]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el primer nombre",-1))]),(0,y.Lk)("div",md,[t[19]||(t[19]=(0,y.Lk)("label",{for:"secondName",class:"form-label"},"Segundo nombre",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"secondName",maxlength:"60","onUpdate:modelValue":t[1]||(t[1]=e=>s.model.personData.name2=e)},null,512),[[o.Jo,s.model.personData.name2]])]),(0,y.Lk)("div",yd,[t[20]||(t[20]=(0,y.Lk)("label",{for:"surname1",class:"form-label required"},"Primer apellido",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"surname1",required:"",maxlength:"60","onUpdate:modelValue":t[2]||(t[2]=e=>s.model.personData.surname1=e)},null,512),[[o.Jo,s.model.personData.surname1]]),t[21]||(t[21]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el primer apellido",-1))]),(0,y.Lk)("div",hd,[t[22]||(t[22]=(0,y.Lk)("label",{for:"surname2",class:"form-label required"},"Segundo apellido",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"surname2",required:"",maxlength:"60","onUpdate:modelValue":t[3]||(t[3]=e=>s.model.personData.surname2=e)},null,512),[[o.Jo,s.model.personData.surname2]]),t[23]||(t[23]=(0,y.Lk)("div",{class:"invalid-feedback"},"Ingrese el segundo apellido",-1))]),(0,y.Lk)("div",vd,[t[24]||(t[24]=(0,y.Lk)("label",{for:"idCard",class:"form-label"},"Cédula",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control disabled",id:"idCard","onUpdate:modelValue":t[4]||(t[4]=e=>s.model.personData.cedula=e),disabled:""},null,512),[[o.Jo,s.model.personData.cedula]])]),(0,y.Lk)("div",bd,[t[25]||(t[25]=(0,y.Lk)("label",{for:"phone",class:"form-label"},"Teléfono",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"phone",placeholder:"0000-0000",pattern:"[0-9]{4}-[0-9]{4}","onUpdate:modelValue":t[5]||(t[5]=e=>s.model.personData.phone=e)},null,512),[[o.Jo,s.model.personData.phone]]),t[26]||(t[26]=(0,y.Lk)("div",{class:"invalid-feedback"},"Use el formato ####-####",-1))]),(0,y.Lk)("div",fd,[t[27]||(t[27]=(0,y.Lk)("label",{for:"birth",class:"form-label"},"Fecha de nacimiento",-1)),(0,y.bo)((0,y.Lk)("input",{type:"date",class:"form-control disabled",id:"birth","onUpdate:modelValue":t[6]||(t[6]=e=>n.birthStr=e),disabled:""},null,512),[[o.Jo,n.birthStr]])]),t[39]||(t[39]=(0,y.Lk)("h5",{class:"mt-2"},"Dirección",-1)),(0,y.Lk)("div",kd,[t[29]||(t[29]=(0,y.Lk)("label",{for:"province",class:"form-label"},"Provincia",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"province","onUpdate:modelValue":t[7]||(t[7]=e=>s.Direccion.selectedProvince=e),onChange:t[8]||(t[8]=(...e)=>n.getCounties&&n.getCounties(...e))},[t[28]||(t[28]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione una Provincia",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.provinces,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,gd))),128))],544),[[o.u1,s.Direccion.selectedProvince]])]),(0,y.Lk)("div",Ld,[t[31]||(t[31]=(0,y.Lk)("label",{for:"county",class:"form-label"},"Cantón",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"county","onUpdate:modelValue":t[9]||(t[9]=e=>s.Direccion.selectedCanton=e),onChange:t[10]||(t[10]=(...e)=>n.getDistricts&&n.getDistricts(...e)),disabled:!s.Direccion.selectedProvince||0===s.counties.length},[t[30]||(t[30]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un cantón",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.counties,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,Ed))),128))],40,Cd),[[o.u1,s.Direccion.selectedCanton]])]),(0,y.Lk)("div",xd,[t[33]||(t[33]=(0,y.Lk)("label",{for:"district",class:"form-label"},"Distrito",-1)),(0,y.bo)((0,y.Lk)("select",{class:"form-select",id:"district","onUpdate:modelValue":t[11]||(t[11]=e=>s.Direccion.selectedDistrit=e),onChange:t[12]||(t[12]=(...e)=>n.getZipCode&&n.getZipCode(...e)),disabled:!s.Direccion.selectedCanton||0===s.districts.length},[t[32]||(t[32]=(0,y.Lk)("option",{selected:"",disabled:"",value:""},"Seleccione un distrito",-1)),((0,y.uX)(!0),(0,y.CE)(y.FK,null,(0,y.pI)(s.districts,e=>((0,y.uX)(),(0,y.CE)("option",{key:e.value,value:e.value},(0,h.v_)(e.value),9,wd))),128))],40,Dd),[[o.u1,s.Direccion.selectedDistrit]])]),(0,y.Lk)("div",Id,[t[34]||(t[34]=(0,y.Lk)("label",{for:"zipCode",class:"form-label"},"Código Postal",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"zipCode",disabled:"",readonly:"","onUpdate:modelValue":t[13]||(t[13]=e=>n.zipCodeValue=e)},null,512),[[o.Jo,n.zipCodeValue]])]),(0,y.Lk)("div",Pd,[t[35]||(t[35]=(0,y.Lk)("label",{for:"otherSigns",class:"form-label"},"Otras señas",-1)),(0,y.bo)((0,y.Lk)("textarea",{class:"form-control",id:"otherSigns",rows:"3",maxlength:"250","onUpdate:modelValue":t[14]||(t[14]=e=>s.Direccion.otherSigns=e)},null,512),[[o.Jo,s.Direccion.otherSigns]])]),t[40]||(t[40]=(0,y.Lk)("h5",{class:"mt-2"},"Pago",-1)),(0,y.Lk)("div",Fd,[t[36]||(t[36]=(0,y.Lk)("label",{for:"iban",class:"form-label"},"Cuenta bancaria (IBAN CR)",-1)),(0,y.bo)((0,y.Lk)("input",{type:"text",class:"form-control",id:"iban",placeholder:"CRXXXXXXXXXXXXXXXXXXXX",pattern:e.ibanPattern,"onUpdate:modelValue":t[15]||(t[15]=e=>s.model.contractData.bankAccount=e)},null,8,Td),[[o.Jo,s.model.contractData.bankAccount,void 0,{trim:!0}]]),t[37]||(t[37]=(0,y.Lk)("div",{class:"invalid-feedback"},"Formato IBAN inválido (CR + 20 dígitos)",-1))]),(0,y.Lk)("div",_d,[(0,y.bF)(i,{onClick:n.goBack,text:"Cancelar"},null,8,["onClick"]),(0,y.bF)(i,{text:"Guardar",type:"submit"})])],544)])])}var Ud={name:"ModifyProfile",components:{LinkButton:ke},data(){return{personId:null,provinces:[],counties:[],districts:[],Direccion:{selectedProvince:"",selectedCanton:"",selectedDistrit:"",otherSigns:""},model:{personData:{personID:0,cedula:"",name1:"",name2:null,surname1:"",surname2:"",phone:"",birthDate:"",personType:"Empleado",company:null},userData:null,contractData:{idContract:0,position:"",department:"",salary:0,employeeType:null,startDate:null,endDate:null,bankAccount:"",personID:0},companyUniqueId:null,direction:{idDirection:0,idDivision:0,province:"",canton:"",district:"",zipCode:"",otherSigns:null,idCompany:null,intPerson:null}}}},computed:{birthStr:{get(){const e=this.model?.personData?.birthDate;if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toISOString().slice(0,10)}},zipCodeValue(){return this.model?.direction?.zipCode||this.zipCode?.value||this.zipCode||""}},methods:{initBootstrapValidation(){const e=this.$refs.profileForm;e&&e.addEventListener("submit",t=>{e.checkValidity()?t.preventDefault():(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")})},parseSession(){const e=m();if(!e)throw new Error("Sesión inválida: personId no disponible");this.personId=e.user.personId},async GetProvince(){const{data:e}=await ye.get("/api/CountryDivision/Provinces");this.provinces=e},async getCounties(){this.counties=[],this.districts=[],this.model.direction.zipCode="";const{data:e}=await ye.get("/api/CountryDivision/Counties",{params:{province:this.Direccion.selectedProvince}});this.counties=e},async getDistricts(){this.districts=[],this.model.direction.zipCode="";const{data:e}=await ye.get("/api/CountryDivision/Districts",{params:{province:this.Direccion.selectedProvince,county:this.Direccion.selectedCanton}});this.districts=e},async getZipCode(){const{data:e}=await ye.get("/api/CountryDivision/ZipCode",{params:{province:this.Direccion.selectedProvince,county:this.Direccion.selectedCanton,district:this.Direccion.selectedDistrit}});this.model.direction.zipCode=e?.value??e},async load(){try{const{data:e}=await ye.get(`/api/Employee/${this.personId}`);this.model.personData={...this.model.personData,...e?.personData??{}},this.model.contractData={...this.model.contractData,...e?.contractData??{}},this.model.direction={...this.model.direction,...e?.direction??{}},this.model.companyUniqueId=e?.companyUniqueId??this.model.companyUniqueId,this.Direccion.selectedProvince=this.model.direction.province||"",await this.getCounties(),this.Direccion.selectedCanton=this.model.direction.canton||"",await this.getDistricts(),this.Direccion.selectedDistrit=this.model.direction.district||"",this.Direccion.otherSigns=this.model.direction.otherSigns||""}catch(e){console.error(e),v().show("No se pudo cargar su información.","danger")}},buildPayload(){const e=this.Direccion.selectedProvince||this.Direccion.selectedCanton||this.Direccion.selectedDistrit||this.Direccion.otherSigns;let t=this.model.direction;return e&&(t={...this.model.direction,province:this.Direccion.selectedProvince||null,canton:this.Direccion.selectedCanton||null,district:this.Direccion.selectedDistrit||null,otherSigns:this.Direccion.otherSigns||null}),{personData:{...this.model.personData},userData:null,contractData:{...this.model.contractData},companyUniqueId:this.model.companyUniqueId,direction:t}},async onSubmit(){const e=this.$refs.profileForm;if(!e.checkValidity())return void e.classList.add("was-validated");const t=this.buildPayload();try{await ye.put(`/api/Employee/me/${this.personId}`,t),v().show("Datos actualizados.","success")}catch(a){console.error(a),v().show("No se pudo actualizar.","danger")}},goBack(){window.history.back()}},async mounted(){this.parseSession(),this.initBootstrapValidation(),await this.GetProvince(),await this.load()}};const Ad=(0,I.A)(Ud,[["render",Sd],["__scopeId","data-v-947759d6"]]);var Nd=Ad;const Xd={requiresAuth:!0,roles:["Empleador"]},Vd={requiresAuth:!0,roles:["Empleado"]},qd={requiresAuth:!0,roles:["Empleador","Administrador"]},Rd={requiresAuth:!0,roles:["Empleador","Aprobador"]},Bd={requiresAuth:!0,roles:["Empleador","Aprobador","Empleado"]},$d=(0,s.aE)({history:(0,s.LA)(),routes:[{path:"/auth",component:q,children:[{path:"Login",name:"Login",component:Oe},{path:"Register",name:"RegisterAccount",component:Te},{path:"ActivateAccount",name:"ActivateAccount",component:Bc},{path:"ResendActivationAccount",name:"ResendActivation",component:Oc},{path:"EmployeeActivation",name:"EmployeeActivation",component:cd}]},{path:"/app",component:Wt,meta:{requiresAuth:!0},children:[{path:"Home",name:"Home Page",component:Ja},{path:"Empresas/VerEmpresas",name:"Ver Empresas",component:ho,meta:qd},{path:"Empresas/CrearEmpresa",name:"Crear Empresa",component:jo,meta:Xd},{path:"Empresas/ModificarEmpresa",name:"Modificar Empresa",component:gl,meta:Xd},{path:"Empleados/VerEmpleados",name:"Ver Empleados",component:Pl,meta:Rd},{path:"Empleados/CrearEmpleado",name:"Crear Empleado",component:as,meta:Xd},{path:"Empleados/ModificarEmpleado",name:"ModifyEmployees",component:Ps,meta:Bd},{path:"Empleados/ModificarPerfil",name:"Modificar Datos",component:Nd,meta:Bd},{path:"Timesheets/CrearTimesheets",name:"Crear Timesheets",component:Ks,meta:Vd},{path:"Planilla/CrearPlanilla",name:"Crear Planilla",component:un,meta:qd},{path:"Planilla/VerBeneficiosDeducciones",name:"Ver Beneficios y Deducciones",component:Tn},{path:"Planilla/CrearBeneficiosDeducciones",name:"Crear Beneficios y Deducciones",component:fi,meta:Xd},{path:"Planilla/EditarBeneficioDeduccion/:PEId",name:"EditarBeneficioODeduccion",component:Wn,meta:Xd},{path:"Planilla/AsignarDeducciones",name:"Asignar Deducciones",component:Xi,meta:Rd},{path:"Planilla/SeleccionarBeneficios",name:"Seleccionar Beneficios",component:rr,meta:Bd},{path:"Reportes/VerReportes",name:"Ver Reportes",component:Uc,meta:Bd},{path:"AccesoRestringido",name:"AccesoRestringido",component:Hc}]},{path:"/",redirect:"/auth/Login"},{path:"/:pathMatch(.*)*",redirect:"/auth/Login"}]});$d.beforeEach((e,t,a)=>{const o=d(),l=e.matched.some(e=>e.meta?.requiresAuth),s=e.matched.flatMap(e=>e.meta?.roles??[]);if(l&&!o)return a({name:"Login"});if("Login"===e.name&&o)return a({name:"Home Page"});if(s.length>0){const e=r(),t=Array.isArray(e?.typeUser)?e.typeUser:[e?.typeUser].filter(Boolean),o=new Set(s.map(e=>String(e).toLowerCase())),l=t.some(e=>o.has(String(e).toLowerCase()));if(!l)return a({name:"AccesoRestringido"})}a()});const Md=(0,o.Ef)(k),Kd=m();Md.config.globalProperties.$session=Kd,Md.use($d),Md.use((0,l.Ey)()),Md.use(g.A),Md.component("ApexChartComponent",g.A),Md.mount("#app")}},t={};function a(o){var l=t[o];if(void 0!==l)return l.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,o,l,s){if(!o){var n=1/0;for(d=0;d<e.length;d++){o=e[d][0],l=e[d][1],s=e[d][2];for(var i=!0,r=0;r<o.length;r++)(!1&s||n>=s)&&Object.keys(a.O).every(function(e){return a.O[e](o[r])})?o.splice(r--,1):(i=!1,s<n&&(n=s));if(i){e.splice(d--,1);var c=l();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[o,l,s]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};a.t=function(o,l){if(1&l&&(o=this(o)),8&l)return o;if("object"===typeof o&&o){if(4&l&&o.__esModule)return o;if(16&l&&"function"===typeof o.then)return o}var s=Object.create(null);a.r(s);var n={};e=e||[null,t({}),t([]),t(t)];for(var i=2&l&&o;("object"==typeof i||"function"==typeof i)&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach(function(e){n[e]=function(){return o[e]}});return n["default"]=function(){return o},a.d(s,n),s}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce(function(t,o){return a.f[o](e,t),t},[]))}}(),function(){a.u=function(e){return"js/"+e+"."+{234:"86c0152c",353:"762e7e4b"}[e]+".js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="planilla_frontend:";a.l=function(o,l,s,n){if(e[o])e[o].push(l);else{var i,r;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==t+s){i=u;break}}i||(r=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+s),i.src=o),e[o]=[l];var p=function(t,a){i.onerror=i.onload=null,clearTimeout(m);var l=e[o];if(delete e[o],i.parentNode&&i.parentNode.removeChild(i),l&&l.forEach(function(e){return e(a)}),t)return t(a)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),r&&document.head.appendChild(i)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={524:0};a.f.j=function(t,o){var l=a.o(e,t)?e[t]:void 0;if(0!==l)if(l)o.push(l[2]);else{var s=new Promise(function(a,o){l=e[t]=[a,o]});o.push(l[2]=s);var n=a.p+a.u(t),i=new Error,r=function(o){if(a.o(e,t)&&(l=e[t],0!==l&&(e[t]=void 0),l)){var s=o&&("load"===o.type?"missing":o.type),n=o&&o.target&&o.target.src;i.message="Loading chunk "+t+" failed.\n("+s+": "+n+")",i.name="ChunkLoadError",i.type=s,i.request=n,l[1](i)}};a.l(n,r,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,o){var l,s,n=o[0],i=o[1],r=o[2],c=0;if(n.some(function(t){return 0!==e[t]})){for(l in i)a.o(i,l)&&(a.m[l]=i[l]);if(r)var d=r(a)}for(t&&t(o);c<n.length;c++)s=n[c],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},o=self["webpackChunkplanilla_frontend"]=self["webpackChunkplanilla_frontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[504],function(){return a(2357)});o=a.O(o)})();
//# sourceMappingURL=app.f9c6d74b.js.map